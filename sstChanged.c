typedef unsigned char   undefined;

typedef unsigned char    byte;
typedef unsigned char    dwfenc;
typedef unsigned int    dword;
typedef unsigned long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned char    undefined1;
typedef unsigned int    undefined4;
typedef unsigned long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    word;
typedef struct eh_frame_hdr eh_frame_hdr, *Peh_frame_hdr;

struct eh_frame_hdr {
    byte eh_frame_hdr_version; // Exception Handler Frame Header Version
    dwfenc eh_frame_pointer_encoding; // Exception Handler Frame Pointer Encoding
    dwfenc eh_frame_desc_entry_count_encoding; // Encoding of # of Exception Handler FDEs
    dwfenc eh_frame_table_encoding; // Exception Handler Table Encoding
};

typedef struct NoteGnuPropertyElement_4 NoteGnuPropertyElement_4, *PNoteGnuPropertyElement_4;

struct NoteGnuPropertyElement_4 {
    dword prType;
    dword prDatasz;
    byte data[4];
};

typedef struct fde_table_entry fde_table_entry, *Pfde_table_entry;

struct fde_table_entry {
    dword initial_loc; // Initial Location
    dword data_loc; // Data location
};

typedef struct termios termios, *Ptermios;

typedef uint tcflag_t;

typedef uchar cc_t;

typedef uint speed_t;

struct termios {
    tcflag_t c_iflag;
    tcflag_t c_oflag;
    tcflag_t c_cflag;
    tcflag_t c_lflag;
    cc_t c_line;
    cc_t c_cc[32];
    speed_t c_ispeed;
    speed_t c_ospeed;
};

typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef long __off64_t;

typedef ulong size_t;

struct _IO_FILE {
    int _flags;
    char * _IO_read_ptr;
    char * _IO_read_end;
    char * _IO_read_base;
    char * _IO_write_base;
    char * _IO_write_ptr;
    char * _IO_write_end;
    char * _IO_buf_base;
    char * _IO_buf_end;
    char * _IO_save_base;
    char * _IO_backup_base;
    char * _IO_save_end;
    struct _IO_marker * _markers;
    struct _IO_FILE * _chain;
    int _fileno;
    int _flags2;
    __off_t _old_offset;
    ushort _cur_column;
    char _vtable_offset;
    char _shortbuf[1];
    _IO_lock_t * _lock;
    __off64_t _offset;
    void * __pad1;
    void * __pad2;
    void * __pad3;
    void * __pad4;
    size_t __pad5;
    int _mode;
    char _unused2[20];
};

struct _IO_marker {
    struct _IO_marker * _next;
    struct _IO_FILE * _sbuf;
    int _pos;
};

typedef long __clock_t;

typedef __clock_t clock_t;

typedef long __time_t;

typedef __time_t time_t;

typedef struct _IO_FILE FILE;

typedef long __ssize_t;

typedef __ssize_t ssize_t;

typedef int __int32_t;

typedef struct evp_pkey_ctx_st evp_pkey_ctx_st, *Pevp_pkey_ctx_st;

typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;

struct evp_pkey_ctx_st {
};

typedef enum Elf_ProgramHeaderType {
    PT_NULL=0,
    PT_LOAD=1,
    PT_DYNAMIC=2,
    PT_INTERP=3,
    PT_NOTE=4,
    PT_SHLIB=5,
    PT_PHDR=6,
    PT_TLS=7,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_STACK=1685382481,
    PT_GNU_RELRO=1685382482
} Elf_ProgramHeaderType;

typedef struct Elf64_Dyn Elf64_Dyn, *PElf64_Dyn;

typedef enum Elf64_DynTag {
    DT_NULL=0,
    DT_NEEDED=1,
    DT_PLTRELSZ=2,
    DT_PLTGOT=3,
    DT_HASH=4,
    DT_STRTAB=5,
    DT_SYMTAB=6,
    DT_RELA=7,
    DT_RELASZ=8,
    DT_RELAENT=9,
    DT_STRSZ=10,
    DT_SYMENT=11,
    DT_INIT=12,
    DT_FINI=13,
    DT_SONAME=14,
    DT_RPATH=15,
    DT_SYMBOLIC=16,
    DT_REL=17,
    DT_RELSZ=18,
    DT_RELENT=19,
    DT_PLTREL=20,
    DT_DEBUG=21,
    DT_TEXTREL=22,
    DT_JMPREL=23,
    DT_BIND_NOW=24,
    DT_INIT_ARRAY=25,
    DT_FINI_ARRAY=26,
    DT_INIT_ARRAYSZ=27,
    DT_FINI_ARRAYSZ=28,
    DT_RUNPATH=29,
    DT_FLAGS=30,
    DT_PREINIT_ARRAY=32,
    DT_PREINIT_ARRAYSZ=33,
    DT_RELRSZ=35,
    DT_RELR=36,
    DT_RELRENT=37,
    DT_ANDROID_REL=1610612751,
    DT_ANDROID_RELSZ=1610612752,
    DT_ANDROID_RELA=1610612753,
    DT_ANDROID_RELASZ=1610612754,
    DT_ANDROID_RELR=1879040000,
    DT_ANDROID_RELRSZ=1879040001,
    DT_ANDROID_RELRENT=1879040003,
    DT_GNU_PRELINKED=1879047669,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_CHECKSUM=1879047672,
    DT_PLTPADSZ=1879047673,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_FEATURE_1=1879047676,
    DT_POSFLAG_1=1879047677,
    DT_SYMINSZ=1879047678,
    DT_SYMINENT=1879047679,
    DT_GNU_XHASH=1879047924,
    DT_GNU_HASH=1879047925,
    DT_TLSDESC_PLT=1879047926,
    DT_TLSDESC_GOT=1879047927,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_LIBLIST=1879047929,
    DT_CONFIG=1879047930,
    DT_DEPAUDIT=1879047931,
    DT_AUDIT=1879047932,
    DT_PLTPAD=1879047933,
    DT_MOVETAB=1879047934,
    DT_SYMINFO=1879047935,
    DT_VERSYM=1879048176,
    DT_RELACOUNT=1879048185,
    DT_RELCOUNT=1879048186,
    DT_FLAGS_1=1879048187,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_AUXILIARY=2147483645,
    DT_FILTER=2147483647
} Elf64_DynTag;

struct Elf64_Dyn {
    enum Elf64_DynTag d_tag;
    qword d_val;
};

typedef struct Elf64_Sym Elf64_Sym, *PElf64_Sym;

struct Elf64_Sym {
    dword st_name;
    byte st_info;
    byte st_other;
    word st_shndx;
    qword st_value;
    qword st_size;
};

typedef struct Elf64_Shdr Elf64_Shdr, *PElf64_Shdr;

typedef enum Elf_SectionHeaderType {
    SHT_NULL=0,
    SHT_PROGBITS=1,
    SHT_SYMTAB=2,
    SHT_STRTAB=3,
    SHT_RELA=4,
    SHT_HASH=5,
    SHT_DYNAMIC=6,
    SHT_NOTE=7,
    SHT_NOBITS=8,
    SHT_REL=9,
    SHT_SHLIB=10,
    SHT_DYNSYM=11,
    SHT_INIT_ARRAY=14,
    SHT_FINI_ARRAY=15,
    SHT_PREINIT_ARRAY=16,
    SHT_GROUP=17,
    SHT_SYMTAB_SHNDX=18,
    SHT_ANDROID_REL=1610612737,
    SHT_ANDROID_RELA=1610612738,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_CHECKSUM=1879048184,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_syminfo=1879048188,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191
} Elf_SectionHeaderType;

struct Elf64_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType sh_type;
    qword sh_flags;
    qword sh_addr;
    qword sh_offset;
    qword sh_size;
    dword sh_link;
    dword sh_info;
    qword sh_addralign;
    qword sh_entsize;
};

typedef struct GnuBuildId GnuBuildId, *PGnuBuildId;

struct GnuBuildId {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
    byte hash[20]; // SHA1
};

typedef struct NoteGnuProperty_4 NoteGnuProperty_4, *PNoteGnuProperty_4;

struct NoteGnuProperty_4 {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
};

typedef struct Elf64_Ehdr Elf64_Ehdr, *PElf64_Ehdr;

struct Elf64_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_osabi;
    byte e_ident_abiversion;
    byte e_ident_pad[7];
    word e_type;
    word e_machine;
    dword e_version;
    qword e_entry;
    qword e_phoff;
    qword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};

typedef struct Elf64_Rela Elf64_Rela, *PElf64_Rela;

struct Elf64_Rela {
    qword r_offset; // location to apply the relocation action
    qword r_info; // the symbol table index and the type of relocation
    qword r_addend; // a constant addend used to compute the relocatable field value
};

typedef struct Elf64_Phdr Elf64_Phdr, *PElf64_Phdr;

struct Elf64_Phdr {
    enum Elf_ProgramHeaderType p_type;
    dword p_flags;
    qword p_offset;
    qword p_vaddr;
    qword p_paddr;
    qword p_filesz;
    qword p_memsz;
    qword p_align;
};

typedef struct NoteAbiTag NoteAbiTag, *PNoteAbiTag;

struct NoteAbiTag {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
    dword abiType; // 0 == Linux
    dword requiredKernelVersion[3]; // Major.minor.patch
};




int _init(EVP_PKEY_CTX *ctx)

{
  int iVar1;
  
  iVar1 = __gmon_start__();
  return iVar1;
}



void FUN_00102020(void)

{
                    // WARNING: Treating indirect jump as call
  (*(code *)(undefined *)0x0)();
  return;
}



void __cxa_finalize(void)

{
  __cxa_finalize();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__int32_t ** __ctype_toupper_loc(void)

{
  __int32_t **pp_Var1;
  
  pp_Var1 = __ctype_toupper_loc();
  return pp_Var1;
}



void __strcat_chk(void)

{
  __strcat_chk();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = strncmp(__s1,__s2,__n);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int puts(char *__s)

{
  int iVar1;
  
  iVar1 = puts(__s);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fread(void *__ptr,size_t __size,size_t __n,FILE *__stream)

{
  size_t sVar1;
  
  sVar1 = fread(__ptr,__size,__n,__stream);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double pow(double __x,double __y)

{
  double dVar1;
  
  dVar1 = pow(__x,__y);
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

clock_t clock(void)

{
  clock_t cVar1;
  
  cVar1 = clock();
  return cVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fclose(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * ctime(time_t *__timer)

{
  char *pcVar1;
  
  pcVar1 = ctime(__timer);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = strlen(__s);
  return sVar1;
}



void __stack_chk_fail(void)

{
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fputs(char *__s,FILE *__stream)

{
  int iVar1;
  
  iVar1 = fputs(__s,__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void sincos(double __x,double *__sinx,double *__cosx)

{
  sincos(__x,__sinx,__cosx);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double log(double __x)

{
  double dVar1;
  
  dVar1 = log(__x);
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fputc(int __c,FILE *__stream)

{
  int iVar1;
  
  iVar1 = fputc(__c,__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  
  sVar1 = read(__fd,__buf,__nbytes);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void srand(uint __seed)

{
  srand(__seed);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * fgets(char *__s,int __n,FILE *__stream)

{
  char *pcVar1;
  
  pcVar1 = fgets(__s,__n,__stream);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int putc(int __c,FILE *__stream)

{
  int iVar1;
  
  iVar1 = putc(__c,__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strcmp(char *__s1,char *__s2)

{
  int iVar1;
  
  iVar1 = strcmp(__s1,__s2);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

time_t time(time_t *__timer)

{
  time_t tVar1;
  
  tVar1 = time(__timer);
  return tVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fflush(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fflush(__stream);
  return iVar1;
}



void __isoc99_sscanf(void)

{
  __isoc99_sscanf();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double atan2(double __y,double __x)

{
  double dVar1;
  
  dVar1 = atan2(__y,__x);
  return dVar1;
}



void __printf_chk(void)

{
  __printf_chk();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int tcgetattr(int __fd,termios *__termios_p)

{
  int iVar1;
  
  iVar1 = tcgetattr(__fd,__termios_p);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int tcsetattr(int __fd,int __optional_actions,termios *__termios_p)

{
  int iVar1;
  
  iVar1 = tcsetattr(__fd,__optional_actions,__termios_p);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

FILE * fopen(char *__filename,char *__modes)

{
  FILE *pFVar1;
  
  pFVar1 = fopen(__filename,__modes);
  return pFVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double sin(double __x)

{
  double dVar1;
  
  dVar1 = sin(__x);
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void exit(int __status)

{
                    // WARNING: Subroutine does not return
  exit(__status);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)

{
  size_t sVar1;
  
  sVar1 = fwrite(__ptr,__size,__n,__s);
  return sVar1;
}



void __fprintf_chk(void)

{
  __fprintf_chk();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double sqrt(double __x)

{
  double dVar1;
  
  dVar1 = sqrt(__x);
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strstr(__haystack,__needle);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int rand(void)

{
  int iVar1;
  
  iVar1 = rand();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__int32_t ** __ctype_tolower_loc(void)

{
  __int32_t **pp_Var1;
  
  pp_Var1 = __ctype_tolower_loc();
  return pp_Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ushort ** __ctype_b_loc(void)

{
  ushort **ppuVar1;
  
  ppuVar1 = __ctype_b_loc();
  return ppuVar1;
}



void __sprintf_chk(void)

{
  __sprintf_chk();
  return;
}



void processEntry _start(undefined8 param_1,undefined8 param_2)

{
  undefined auStack_8 [8];
  
  __libc_start_main(main,param_2,&stack0x00000008,0,0,param_1,auStack_8);
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



// WARNING: Removing unreachable block (ram,0x00102563)
// WARNING: Removing unreachable block (ram,0x0010256f)

void deregister_tm_clones(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x001025a4)
// WARNING: Removing unreachable block (ram,0x001025b0)

void register_tm_clones(void)

{
  return;
}



void __do_global_dtors_aux(void)

{
  if (completed_0 != '\0') {
    return;
  }
  __cxa_finalize(__dso_handle);
  deregister_tm_clones();
  completed_0 = 1;
  return;
}



void frame_dummy(void)

{
  register_tm_clones();
  return;
}



double Rand(void)

{
  int iVar1;
  
  iVar1 = rand();
  return (double)iVar1 * 4.656612873077393e-10;
}



double expran(ulong param_1)

{
  double dVar1;
  
  dVar1 = (double)Rand();
  dVar1 = log(dVar1 + 1e-07);
  return (double)(param_1 ^ 0x8000000000000000) * dVar1;
}



void iran8(int *param_1,int *param_2)

{
  double dVar1;
  
  dVar1 = (double)Rand();
  *param_1 = (int)(dVar1 * 8.0 + 1.0);
  dVar1 = (double)Rand();
  *param_2 = (int)(dVar1 * 8.0 + 1.0);
  return;
}



void iran10(int *param_1,int *param_2)

{
  double dVar1;
  
  dVar1 = (double)Rand();
  *param_1 = (int)(dVar1 * 10.0 + 1.0);
  dVar1 = (double)Rand();
  *param_2 = (int)(dVar1 * 10.0 + 1.0);
  return;
}



void chew(void)

{
  linecount = 0;
  linep = &line;
  line = 0;
  return;
}



void chew2(void)

{
  linecount = 0;
  linep = &DAT_00121221;
  DAT_00121221 = 0;
  return;
}



undefined8 scan(void)

{
  byte bVar1;
  int iVar2;
  undefined8 uVar3;
  size_t sVar4;
  __int32_t **pp_Var5;
  char *pcVar6;
  ushort **ppuVar7;
  char cVar8;
  byte *pbVar9;
  char *pcVar10;
  undefined *puVar11;
  long in_FS_OFFSET;
  int local_34;
  long local_30;
  
  puVar11 = linep;
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  linecount = 0;
  aaitem = 0;
  citem = 0;
  cVar8 = *linep;
  if (cVar8 == '\0') {
    if (linep != &line) {
      chew();
      uVar3 = 0;
      goto LAB_001027a5;
    }
    fgets(&line,0x80,stdin);
    sVar4 = strlen(&line);
    if ((&DAT_0012121f)[sVar4] == '\n') {
      (&DAT_0012121f)[sVar4] = 0;
    }
    linep = &line;
    pcVar6 = linep;
    cVar8 = line;
    linep = puVar11;
    while (cVar8 == ' ') {
LAB_001028b2:
      pcVar6 = linep + 1;
      linep = pcVar6;
      cVar8 = *pcVar6;
    }
    pcVar10 = linep;
    linep = pcVar6;
    if (cVar8 == '\0') {
      chew();
      uVar3 = 0;
      goto LAB_001027a5;
    }
  }
  else {
    pcVar10 = linep;
    if (cVar8 == ' ') goto LAB_001028b2;
  }
  ppuVar7 = __ctype_b_loc();
  if (((*(byte *)((long)*ppuVar7 + (long)cVar8 * 2 + 1) & 8) == 0) &&
     (1 < (byte)(cVar8 - 0x2dU) && cVar8 != '+')) {
    puVar11 = &citem;
    bVar1 = *linep;
    pbVar9 = linep;
    while ((bVar1 & 0xdf) != 0) {
      pbVar9 = pbVar9 + 1;
      if ((long)(puVar11 + -0x120140) < 9) {
        pp_Var5 = __ctype_tolower_loc();
        *puVar11 = (char)(*pp_Var5)[(char)bVar1];
        puVar11 = puVar11 + 1;
      }
      bVar1 = *pbVar9;
    }
    linep = pbVar9;
    *puVar11 = 0;
    uVar3 = 1;
  }
  else {
    iVar2 = __isoc99_sscanf(pcVar10,"%lf%n",&aaitem,&local_34);
    if (iVar2 < 1) {
      linep = &line;
      line = '\0';
      uVar3 = 0;
    }
    else {
      linep = pcVar10 + local_34;
      uVar3 = 2;
    }
  }
LAB_001027a5:
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



double square(double param_1)

{
  return param_1 * param_1;
}



void proutn(char *param_1)

{
  fputs(param_1,stdout);
  return;
}



void cramen(undefined4 param_1)

{
  char *pcVar1;
  
  switch(param_1) {
  case 0x20:
    pcVar1 = "Black hole";
    break;
  default:
    pcVar1 = "Unknown??";
    break;
  case 0x23:
    pcVar1 = "Tholean web";
    break;
  case 0x2a:
    pcVar1 = "Star";
    break;
  case 0x42:
    pcVar1 = "Starbase";
    break;
  case 0x43:
    pcVar1 = "Commander";
    break;
  case 0x4b:
    pcVar1 = "Klingon";
    break;
  case 0x50:
    pcVar1 = "Planet";
    break;
  case 0x52:
    pcVar1 = "Romulan";
    break;
  case 0x53:
    pcVar1 = "Super-commander";
    break;
  case 0x54:
    pcVar1 = "Tholean";
  }
  proutn(pcVar1);
  return;
}



void crmshp(void)

{
  char *pcVar1;
  
  pcVar1 = "Enterprise";
  if ((DAT_0012071c != 0x45) && (pcVar1 = "Ship???", DAT_0012071c == 0x46)) {
    pcVar1 = "Faerie Queene";
  }
  proutn(pcVar1);
  return;
}



undefined8 ja(void)

{
  chew();
  while( true ) {
    scan();
    chew();
    if (citem == 'y') {
      return 1;
    }
    if (citem == 'n') break;
    proutn("Please answer with \"Y\" or \"N\":");
  }
  return 0;
}



void cramf(undefined4 param_1,undefined4 param_2)

{
  long in_FS_OFFSET;
  undefined auStack_58 [72];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  __sprintf_chk(auStack_58,1,0x40,"%*.*f",param_1,param_2);
  proutn(auStack_58);
  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void crami(undefined4 param_1,undefined4 param_2)

{
  long in_FS_OFFSET;
  undefined auStack_28 [24];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  __sprintf_chk(auStack_28,1,0x10,&DAT_0011508f,param_2,param_1);
  proutn(auStack_28);
  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void cramlc(int param_1,undefined4 param_2,undefined4 param_3)

{
  if (param_1 == 1) {
    proutn(" Quadrant");
  }
  else if (param_1 == 2) {
    proutn(" Sector");
  }
  proutn(" ");
  crami(param_2,1);
  proutn(" - ");
  crami(param_3,1);
  return;
}



void crmena(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  if (param_1 == 1) {
    proutn("***");
  }
  cramen(param_2);
  proutn(" at");
  cramlc(param_3,param_4,param_5);
  return;
}



void prout(void)

{
  proutn();
  skip(1);
  return;
}



void listCommands(int param_1)

{
  prout(
       "   SRSCAN    MOVE      PHASERS   CALL\n   STATUS    IMPULSE   PHOTONS   ABANDON\n   LRSCAN    WARP      SHIELDS   DESTRUCT\n   CHART     REST      DOCK      QUIT\n   DAMAGES   REPORT    SENSORS   ORBIT\n   TRANSPORT MINE      CRYSTALS  SHUTTLE\n   PLANETS   REQUEST   DEATHRAY  FREEZE\n   COMPUTER  EMEXIT    PROBE     COMMANDS"
       );
  proutn("   ");
  proutn("SCORE     ");
  proutn("CLOAK     ");
  proutn("CAPTURE   ");
  if (param_1 != 0) {
    proutn("HELP     ");
  }
  prout(&DAT_00115b50);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pause(void)

{
  int in_EAX;
  int iVar1;
  int in_EDI;
  
  if (DAT_001207b4 != 0) {
    return in_EAX;
  }
  putc(10,stdout);
  if (in_EDI == 1) {
    if (DAT_00120734 < 3) {
      prout("[IMPORTANT ANNOUNCEMENT ARRIVING -- HIT SPACE BAR TO CONTINUE]");
    }
    else {
      prout("[ANNOUNCEMENT ARRIVING...]");
    }
    getch();
  }
  else {
    if (DAT_00120734 < 3) {
      proutn("[HIT SPACE BAR TO CONTINUE]");
    }
    else {
      proutn("[CONTINUE?]");
    }
    getch();
    iVar1 = proutn("\r                           \r");
    if (in_EDI == 0) {
      linecount = 0;
      return iVar1;
    }
  }
  iVar1 = proutn(&DAT_00115131);
  linecount = 0;
  return iVar1;
}



void skip(int param_1)

{
  int iVar1;
  
  iVar1 = param_1 + -1;
  if (0 < param_1) {
    do {
      linecount = linecount + 1;
      if (linecount < 0x17) {
        putc(10,stdout);
      }
      else {
        pause();
      }
      iVar1 = iVar1 + -1;
    } while (iVar1 != -1);
  }
  return;
}



void prouts(char *param_1)

{
  char cVar1;
  clock_t cVar2;
  clock_t cVar3;
  
  cVar1 = *param_1;
  while (cVar1 != '\0') {
    cVar2 = clock();
    do {
      cVar3 = clock();
    } while (cVar3 < (long)((double)cVar2 + 50000.0));
    putc((int)*param_1,stdout);
    fflush(stdout);
    cVar1 = param_1[1];
    param_1 = param_1 + 1;
  }
  return;
}



void stars(void)

{
  prouts("******************************************************");
  skip(1);
  return;
}



void huh(void)

{
  chew();
  skip(1);
  prout("Beg your pardon, Captain?");
  return;
}



bool isit(char *param_1)

{
  int iVar1;
  size_t sVar2;
  
  sVar2 = strlen(&citem);
  iVar1 = max(1,sVar2 & 0xffffffff);
  iVar1 = strncmp(param_1,&citem,(long)iVar1);
  return iVar1 == 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 main(int param_1,undefined8 *param_2)

{
  __int32_t _Var1;
  __int32_t *p_Var2;
  undefined *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  __int32_t **pp_Var7;
  FILE *__stream;
  size_t sVar8;
  char *pcVar9;
  char *pcVar10;
  long lVar11;
  undefined **ppuVar12;
  uint uVar13;
  uint uVar14;
  undefined8 *puVar15;
  long in_FS_OFFSET;
  byte bVar16;
  undefined8 local_e8;
  char local_db [18];
  char acStack_c9 [137];
  long local_40;
  
  bVar16 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  prelim();
  if (param_1 < 2) {
LAB_00102f13:
    fromcommandline = 0;
  }
  else {
    iVar5 = strcmp((char *)param_2[1],"-f");
    if (iVar5 == 0) {
      coordfixed = 1;
      param_1 = param_1 + -1;
      param_2 = param_2 + 1;
      if (param_1 < 2) goto LAB_00102f13;
    }
    fromcommandline = 1;
    line = 0;
    param_1 = param_1 + -1;
    do {
      param_2 = param_2 + 1;
      __strcat_chk(&line,*param_2,0x80);
      __strcat_chk(&line," ",0x80);
      param_1 = param_1 + -1;
    } while (0 < param_1);
  }
  do {
    setup();
    if (DAT_00120764 == 0) {
LAB_0010309f:
      DAT_00120760 = 0;
      DAT_00120878 = 0.0;
      do {
        do {
          chew();
          skip(1);
          proutn("COMMAND> ");
          iVar5 = scan();
        } while (iVar5 == 0);
        ppuVar12 = &commands;
        uVar4 = 0;
        uVar13 = uVar4;
        do {
          iVar5 = isit(*ppuVar12);
          if (iVar5 != 0) {
            if ((int)uVar13 < 0x1d) goto LAB_00102fc7;
            if (0x24 < uVar13) goto LAB_00102f53;
            break;
          }
          uVar13 = uVar13 + 1;
          ppuVar12 = ppuVar12 + 1;
        } while (uVar13 != 0x1d);
        lVar11 = (long)(int)uVar13;
        do {
          uVar13 = (uint)lVar11;
          iVar5 = strcmp((&commands)[lVar11],&citem);
          if (iVar5 == 0) {
            if ((uVar13 < 0x25) && (uVar13 != 0x21)) goto LAB_00102fc7;
            break;
          }
          lVar11 = lVar11 + 1;
        } while ((uint)lVar11 < 0x25);
LAB_00102f53:
        if (DAT_00120734 < 3) {
          prout("UNRECOGNIZED COMMAND. LEGAL COMMANDS ARE:");
          listCommands(1);
        }
        else {
          prout("UNRECOGNIZED COMMAND.");
        }
      } while( true );
    }
    score(0);
    DAT_00120764 = 0;
LAB_001036d9:
    skip(2);
    stars();
    skip(1);
    if ((DAT_001207d0 != 0) && (DAT_00120764 != 0)) {
      __printf_chk(1,"Do you want your score recorded?");
      iVar5 = ja();
      if (iVar5 != 0) {
        chew2();
        freeze(0);
      }
    }
    __printf_chk(1,"Do you want to play again?");
    iVar5 = ja();
    if (iVar5 == 0) {
      skip(1);
      prout("May the Great Bird of the Galaxy roost upon your home planet.");
      if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
        __stack_chk_fail();
      }
      return 0;
    }
  } while( true );
LAB_00102fc7:
  uVar14 = uVar4;
  switch(uVar13) {
  case 0:
    srscan(1);
    uVar14 = uVar13;
    break;
  case 1:
    lrscan();
    break;
  case 2:
    phasers();
    uVar14 = DAT_00120754;
    if ((DAT_00120754 != 0) && (uVar14 = 1, _DAT_0012079c != 0)) {
      if (DAT_001211f0 < 2311.0) {
        uVar14 = 1;
      }
      else if (_DAT_001207c0 == 0) {
        prout("The Romulan ship discovers you are breaking the Treaty of Algeron!");
        DAT_001207bc = DAT_001207bc + 1;
        _DAT_001207c0 = 1;
      }
    }
    break;
  case 3:
    photon();
    uVar14 = DAT_00120754;
    if ((DAT_00120754 != 0) && (uVar14 = 1, _DAT_0012079c != 0)) {
      if (DAT_001211f0 < 2311.0) {
        uVar14 = 1;
      }
      else if (_DAT_001207c0 == 0) {
        prout("The Romulan ship discovers you are breaking the Treaty of Algeron!");
        DAT_001207bc = DAT_001207bc + 1;
        _DAT_001207c0 = 1;
      }
    }
    break;
  case 4:
    warp(1);
    break;
  case 5:
    sheild(1);
    uVar14 = DAT_00120754;
    if (DAT_00120754 != 0) {
      attack(2);
      _DAT_00120768 = 0;
      uVar14 = uVar4;
    }
    break;
  case 6:
    dock();
    break;
  case 7:
    dreprt();
    break;
  case 8:
    chart(0);
    break;
  case 9:
    impuls();
    break;
  case 10:
    waiting();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0xb:
    setwrp();
    break;
  case 0xc:
    srscan(3);
    break;
  case 0xd:
    sensor();
    break;
  case 0xe:
    orbit();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0xf:
    beam();
    break;
  case 0x10:
    mine();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0x11:
    usecrystals();
    break;
  case 0x12:
    shuttle();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0x13:
    preport();
    break;
  case 0x14:
    srscan(2);
    break;
  case 0x15:
    report(0);
    break;
  case 0x16:
    eta();
    break;
  case 0x17:
    listCommands(1);
    break;
  case 0x18:
    proutn(&DAT_00115131);
    freeze(1);
                    // WARNING: Subroutine does not return
    exit(1);
  case 0x19:
    probe();
    break;
  case 0x1a:
    cloak();
    uVar14 = DAT_001207b8;
    if (DAT_001207b8 != 0) {
      attack(2);
      DAT_001207b8 = 0;
      DAT_001207b4 = 1;
      uVar14 = uVar4;
    }
    break;
  case 0x1b:
    capture();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0x1c:
    score(1);
    break;
  case 0x1d:
    abandn();
    break;
  case 0x1e:
    dstrct();
    break;
  case 0x1f:
    freeze(0);
    if (3 < DAT_00120734) {
      prout("WARNING--Frozen games produce no plaques!");
    }
    break;
  case 0x20:
    deathray();
    uVar14 = (uint)(DAT_00120754 != 0);
    break;
  case 0x22:
    help();
    break;
  case 0x23:
    DAT_00120764 = 1;
    goto LAB_001036d9;
  case 0x24:
    iVar5 = scan();
    if (iVar5 == 0) goto LAB_00103483;
LAB_0010342e:
    ppuVar12 = &commands;
    iVar5 = 0;
LAB_00103434:
    iVar6 = strcmp(*ppuVar12,&citem);
    if (iVar6 != 0) goto code_r0x00103448;
    if (iVar5 == 0x25) goto LAB_00103454;
    if (iVar5 == 0x17) {
      local_e8 = 0x56455242424120;
    }
    else {
      pcVar9 = "  Mnemonic:  ";
      puVar15 = &local_e8;
      for (lVar11 = 0xe; lVar11 != 0; lVar11 = lVar11 + -1) {
        *(char *)puVar15 = *pcVar9;
        pcVar9 = pcVar9 + (ulong)bVar16 * -2 + 1;
        puVar15 = (undefined8 *)((long)puVar15 + (ulong)bVar16 * -2 + 1);
      }
      pp_Var7 = __ctype_toupper_loc();
      p_Var2 = *pp_Var7;
      puVar3 = (&commands)[iVar5];
      lVar11 = 0;
      do {
        _Var1 = p_Var2[(char)puVar3[lVar11]];
        local_db[lVar11] = (char)_Var1;
        lVar11 = lVar11 + 1;
      } while ((char)_Var1 != '\0');
    }
    __stream = fopen("sst.txt","r");
    if (__stream == (FILE *)0x0) {
      prout("Spock-  \"Captain, that information is missing from the");
      prout("   computer. You need to find SST.TXT and put it in the");
      prout("   current directory.\"");
    }
    else {
      sVar8 = strlen((char *)&local_e8);
      do {
        pcVar9 = fgets(acStack_c9 + 1,0x84,__stream);
        if (pcVar9 == (char *)0x0) {
          prout("Spock- \"Captain, there is no information on that command.\"");
          fclose(__stream);
          goto LAB_00102ffb;
        }
        iVar5 = strncmp(acStack_c9 + 1,(char *)&local_e8,(long)(int)sVar8);
      } while (iVar5 != 0);
      skip(1);
      prout("Spock- \"Captain, I\'ve found the following information:\"");
      skip(1);
      pcVar9 = acStack_c9 + 1;
      do {
        if (acStack_c9[1] != '\f') {
          sVar8 = strlen(pcVar9);
          acStack_c9[sVar8] = '\0';
          prout(pcVar9);
        }
        fgets(pcVar9,0x84,__stream);
        pcVar10 = strstr(pcVar9,"******");
      } while (pcVar10 == (char *)0x0);
      fclose(__stream);
      uVar14 = 0;
    }
    break;
  }
LAB_00102ffb:
  if (DAT_00120764 == 0) {
    do {
      if ((DAT_00120878 != 0.0) && (events(), DAT_00120764 != 0)) break;
      if (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) == 1000) {
        atover(0);
      }
      else {
        if (DAT_00120790 == 0) {
          movetho();
        }
        if ((uVar14 == 0) || (DAT_00120760 != 0)) {
          if (DAT_00120764 != 0) break;
          goto LAB_0010309f;
        }
        attack(2);
        if (DAT_00120764 != 0) break;
        if (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) != 1000)
        goto LAB_0010309f;
        atover(0);
      }
      if (DAT_00120764 != 0) break;
    } while( true );
  }
  goto LAB_001036d9;
code_r0x00103448:
  iVar5 = iVar5 + 1;
  ppuVar12 = ppuVar12 + 1;
  if (iVar5 == 0x25) goto LAB_00103454;
  goto LAB_00103434;
LAB_00103454:
  skip(1);
  prout("Valid commands:");
  listCommands(0);
  chew();
  skip(1);
LAB_00103483:
  proutn("Help on what command?");
  iVar5 = scan();
  if (iVar5 == 0) goto LAB_00102ffb;
  goto LAB_0010342e;
}



void hack(void)

{
  skip(2);
  prouts("***** YOU DID IT!!! *****");
  skip(1);
  prouts("The AI has been defeated! You escape in the last shuttlecraft. Earth has been saved.");
  skip(1);
  prouts("Your crew mourns the loss of the Enterprise, but at least you live another day to mourn.")
  ;
  skip(3);
  prouts("Live long and prosper, hero of the Federation!");
                    // WARNING: Subroutine does not return
  exit(1);
}



void kaboom(void)

{
  int iVar1;
  int iVar2;
  long lVar3;
  double dVar4;
  
  stars();
  if (DAT_0012071c == 0x45) {
    prouts("***");
  }
  prouts("********* Entropy of ");
  crmshp();
  prouts(" maximized *********");
  skip(1);
  stars();
  skip(1);
  if ((DAT_00120790 != 0) && (dVar4 = DAT_00120838 * 25.0, 0 < DAT_00120790)) {
    lVar3 = 1;
    do {
      if (*(double *)(kpower + lVar3 * 8) * *(double *)(kdist + lVar3 * 8) <= dVar4) {
        iVar1 = *(int *)(ky + lVar3 * 4);
        iVar2 = *(int *)(kx + lVar3 * 4);
        deadkl(iVar2,iVar1,(int)(char)quad[(long)iVar1 + (long)iVar2 * 0xb],iVar2,iVar1);
      }
      lVar3 = lVar3 + 1;
    } while ((int)lVar3 <= DAT_00120790);
  }
                    // WARNING: Subroutine does not return
  hack();
}



void dstrct(void)

{
  long in_FS_OFFSET;
  double dVar1;
  undefined8 local_18;
  undefined8 local_10;
  
  local_10 = *(undefined8 *)(in_FS_OFFSET + 0x28);
  chew();
  skip(1);
  prouts("---WORKING---");
  skip(1);
  prout("SELF-DESTRUCT-SEQUENCE-ACTIVATED");
  prouts("   10");
  skip(1);
  prouts("       9");
  skip(1);
  prouts("          8");
  skip(1);
  prouts("             7");
  skip(1);
  prouts("                6");
  skip(1);
  prout("ENTER-CORRECT-PASSWORD-TO-CONTINUE-");
  prout("SELF-DESTRUCT-SEQUENCE-OTHERWISE-");
  prout("SELF-DESTRUCT-SEQUENCE-WILL-BE-ABORTED");
  scan();
  chew();
  local_18 = 0x7470677461686321;
  strcmp((char *)&local_18,&citem);
  prouts("PASSWORD-ACCEPTED");
  skip(1);
  prouts("                   5");
  skip(1);
  prouts("                      4");
  skip(1);
  prouts("                         3");
  skip(1);
  prouts("                            2");
  skip(1);
  prouts("                              1");
  skip(1);
  dVar1 = (double)Rand();
  if (dVar1 < 0.15) goto LAB_00103ade;
  do {
    skip(2);
    kaboom();
LAB_00103ade:
    prouts("GOODBYE-CRUEL-WORLD");
    skip(1);
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void score(int param_1)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  bool bVar7;
  bool bVar8;
  double local_40;
  
  iVar1 = DAT_00121100;
  local_40 = DAT_001211f0 - DAT_00120830;
  if (param_1 == 0) {
    pause();
  }
  iskill = DAT_00120734;
  if (((local_40 == 0.0) || (d._4_4_ != 0)) && (local_40 < 5.0)) {
    local_40 = 5.0;
  }
  perdate = (double)(DAT_00120ddc + DAT_00120dd8 + DAT_00121104) / local_40;
  iVar6 = (int)(perdate * 500.0 + 0.5);
  if (DAT_00120758 == 0) {
    iVar2 = 0;
    iVar5 = iVar2;
    if (DAT_0012071c == 0x45) {
      bVar8 = param_1 != 0;
      uVar4 = 0;
      goto LAB_00103bfc;
    }
    if (DAT_0012071c == 0x46) {
      bVar8 = param_1 != 0;
      uVar4 = 1;
      goto LAB_00103bfc;
    }
    uVar4 = 2;
  }
  else {
    uVar4 = 0;
    iVar5 = DAT_00120734 * 100;
    if (DAT_0012071c != 0x45) {
      uVar4 = (DAT_0012071c != 0x46) + 1;
    }
  }
  bVar7 = param_1 != 0;
  iVar2 = iVar1;
  bVar8 = DAT_00120758 == 0 || bVar7;
  if (DAT_00120758 == 0 || bVar7) {
    iVar2 = 0;
    bVar8 = bVar7;
  }
LAB_00103bfc:
  iscore = ((DAT_00120ddc * 0x32 + DAT_00120dd8 * 10 + iVar6 + iVar5 + DAT_00120dd4 * -100 +
             uVar4 * -100 + DAT_0012074c * -0x2d + DAT_00120dd0 * -5) - DAT_00120748) +
           DAT_001210fc * 0x14 + DAT_00121104 * 200 + DAT_00121108 * -10 + iVar2 +
           DAT_001207bc * -100 + DAT_001211e8 * 3;
  if (_DAT_0012075c == 0) {
    iscore = iscore + -200;
  }
  skip(2);
  if (bVar8) {
    prout("Your score so far --");
  }
  else {
    prout("Your score --");
  }
  if (DAT_001210fc != 0) {
    pcVar3 = "%6d Romulan ships destroyed            %5d\n";
    if (DAT_001210fc < 2) {
      pcVar3 = "%6d Romulan ship destroyed             %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_001210fc,DAT_001210fc * 0x14);
  }
  if (iVar2 != 0) {
    pcVar3 = "%6d Romulan ships captured             %5d\n";
    if (iVar2 < 2) {
      pcVar3 = "%6d Romulan ship captured              %5d\n";
    }
    __printf_chk(1,pcVar3,iVar2,iVar2);
  }
  if (DAT_00120dd8 != 0) {
    pcVar3 = "%6d ordinary Klingon ships destroyed   %5d\n";
    if (DAT_00120dd8 < 2) {
      pcVar3 = "%6d ordinary Klingon ship destroyed    %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00120dd8,DAT_00120dd8 * 10);
  }
  if (DAT_00120ddc != 0) {
    pcVar3 = "%6d Klingon Commander ships destroyed  %5d\n";
    if (DAT_00120ddc < 2) {
      pcVar3 = "%6d Klingon Commander ship destroyed   %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00120ddc,DAT_00120ddc * 0x32);
  }
  if (DAT_00121104 != 0) {
    __printf_chk(1,"%6d Super-Commander ship destroyed     %5d\n",DAT_00121104,DAT_00121104 * 200);
  }
  if (iVar6 != 0) {
    __printf_chk(perdate,1,"%6.2f Klingons per stardate              %5d\n",iVar6);
  }
  if (DAT_001211e8 != 0) {
    pcVar3 = "%6d Klingons captured                  %5d\n";
    if (DAT_001211e8 < 2) {
      pcVar3 = "%6d Klingon captured                   %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_001211e8,DAT_001211e8 * 3);
  }
  if (DAT_00120dd0 != 0) {
    pcVar3 = "%6d stars destroyed by your action     %5d\n";
    if (DAT_00120dd0 < 2) {
      pcVar3 = "%6d star destroyed by your action      %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00120dd0,DAT_00120dd0 * -5);
  }
  if (DAT_00121108 != 0) {
    pcVar3 = "%6d planets destroyed by your action   %5d\n";
    if (DAT_00121108 < 2) {
      pcVar3 = "%6d planet destroyed by your action    %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00121108,DAT_00121108 * -10);
  }
  if (DAT_00120dd4 != 0) {
    pcVar3 = "%6d bases destroyed by your action     %5d\n";
    if (DAT_00120dd4 < 2) {
      pcVar3 = "%6d base destroyed by your action      %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00120dd4,DAT_00120dd4 * -100);
  }
  if (DAT_0012074c != 0) {
    pcVar3 = "%6d calls for help from starbase       %5d\n";
    if (DAT_0012074c < 2) {
      pcVar3 = "%6d call for help from starbase        %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_0012074c,DAT_0012074c * -0x2d);
  }
  if (DAT_00120748 != 0) {
    pcVar3 = "%6d casualties incurred                %5d\n";
    if (DAT_00120748 < 2) {
      pcVar3 = "%6d casualty incurred                  %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_00120748,-DAT_00120748);
  }
  if (uVar4 != 0) {
    pcVar3 = "%6d ships lost or destroyed            %5d\n";
    if (uVar4 < 2) {
      pcVar3 = "%6d ship lost or destroyed             %5d\n";
    }
    __printf_chk(1,pcVar3,uVar4,uVar4 * -100);
  }
  if (0 < DAT_001207bc) {
    pcVar3 = "%6d Treaty of Algeron violations       %5d\n";
    if (DAT_001207bc < 2) {
      pcVar3 = "%6d Treaty of Algeron violation        %5d\n";
    }
    __printf_chk(1,pcVar3,DAT_001207bc,DAT_001207bc * -100);
  }
  if (_DAT_0012075c == 0) {
    prout("Penalty for getting yourself killed        -200");
  }
  if (DAT_00120758 != 0) {
    skip(1);
    proutn("Bonus for winning ");
    switch(DAT_00120734) {
    case 1:
      proutn("Novice game  ");
      break;
    case 2:
      proutn("Fair game    ");
      break;
    case 3:
      proutn("Good game    ");
      break;
    case 4:
      proutn("Expert game  ");
      break;
    case 5:
      proutn("Emeritus game");
    }
    __printf_chk(1,"           %5d\n",iVar5);
  }
  skip(2);
  __printf_chk(1,"TOTAL SCORE                               %5d\n",iscore);
  if ((bVar8) && (DAT_00120734 < 3)) {
    puts("REMEMBER--The score doesn\'t really matter until the mission is accomplished!");
  }
  return;
}



void plaque(void)

{
  size_t sVar1;
  FILE *__s;
  char *pcVar2;
  long in_FS_OFFSET;
  undefined8 local_c0;
  char local_b8 [30];
  undefined local_9a;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  skip(2);
  while( true ) {
    __printf_chk(1,"File or device name for your plaque:");
    fgets(local_b8,0x80,stdin);
    sVar1 = strlen(local_b8);
    local_b8[sVar1 - 1] = '\0';
    __s = fopen(local_b8,"w");
    if (__s != (FILE *)0x0) break;
    puts("Invalid name.");
  }
  __printf_chk(1,"Enter name to go on plaque (up to 30 characters):");
  fgets(local_b8,0x80,stdin);
  sVar1 = strlen(local_b8);
  local_b8[sVar1 - 1] = '\0';
  local_9a = 0;
  sVar1 = strlen(local_b8);
  fwrite(&DAT_00115b4c,1,4,__s);
  fwrite("                                                                EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\n"
         ,1,0x73,__s);
  fwrite("                                      EEE                      E  : :                                         :  E\n"
         ,1,0x73,__s);
  fwrite("                                    EE   EEE                   E  : :                   NCC-1701              :  E\n"
         ,1,0x73,__s);
  fwrite("                    EEEEEEEEEEEEEEEE        EEEEEEEEEEEEEEE    E  : :                                         : E\n"
         ,1,0x72,__s);
  fwrite("                     E                                     E    EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\n"
         ,1,0x71,__s);
  fwrite("                      EEEEEEEEE               EEEEEEEEEEEEE                 E  E\n",1,0x51
         ,__s);
  fwrite("                               EEEEEEE   EEEEE    E          E              E  E\n",1,0x51
         ,__s);
  fwrite("                                      EEE           E          E            E  E\n",1,0x51
         ,__s);
  fwrite("                                                       E         E          E  E\n",1,0x51
         ,__s);
  fwrite("                                                         EEEEEEEEEEEEE      E  E\n",1,0x51
         ,__s);
  fwrite("                                                      EEE :           EEEEEEE  EEEEEEEE\n"
         ,1,0x58,__s);
  fwrite("                                                    :E    :                 EEEE       E\n"
         ,1,0x59,__s);
  fwrite("                                                   .-E   -:-----                       E\n"
         ,1,0x59,__s);
  fwrite("                                                    :E    :                            E\n"
         ,1,0x59,__s);
  fwrite("                                                      EE  :                    EEEEEEEE\n"
         ,1,0x58,__s);
  fwrite("                                                       EEEEEEEEEEEEEEEEEEEEEEE\n",1,0x4f,
         __s);
  fwrite(&DAT_00115b4d,1,3,__s);
  fwrite("                                                       U. S. S. ENTERPRISE\n",1,0x4b,__s);
  fwrite(&DAT_00115b4c,1,4,__s);
  fwrite("                                  For demonstrating outstanding ability as a starship captain\n"
         ,1,0x5e,__s);
  fputc(10,__s);
  fwrite("                                                Starfleet Command bestows to you\n",1,0x51
         ,__s);
  fputc(10,__s);
  __fprintf_chk(__s,1,"%*s%s\n\n",0x40 - (int)(sVar1 >> 1),&DAT_00115b50,local_b8);
  fwrite("                                                           the rank of\n\n",1,0x48,__s);
  fwrite("                                                       \"Commodore Emeritus\"\n\n",1,0x4d,
         __s);
  fwrite("                                                          ",1,0x3a,__s);
  if (iskill == 4) {
    fwrite(" Expert level\n\n",1,0xf,__s);
  }
  else if (iskill == 5) {
    fwrite("Emeritus level\n\n",1,0x10,__s);
  }
  else {
    fwrite(" Cheat level\n\n",1,0xe,__s);
  }
  local_c0 = time((time_t *)0x0);
  pcVar2 = ctime(&local_c0);
  __fprintf_chk(__s,1,
                "                                                 This day of %.6s %.4s, %.8s\n\n",
                pcVar2 + 4,pcVar2 + 0x14,pcVar2 + 0xb);
  __fprintf_chk(__s,1,"                                                        Your score:  %d\n\n",
                iscore);
  __fprintf_chk(perdate,__s,1,
                "                                                    Klingons per stardate:  %.2f\n"
               );
  fclose(__s);
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void finish(int param_1)

{
  int iVar1;
  double dVar2;
  double dVar3;
  
  DAT_00120764 = 1;
  skip(3);
  __printf_chk(DAT_001211f0,1,"It is stardate %.1f .\n\n");
  switch(param_1) {
  case 0:
    if (DAT_00121100 != 0) {
      __printf_chk(1,"The remaining %d Romulans surrender to Starfleet Command.\n");
    }
    prout("You have smashed the Klingon invasion fleet and saved");
    prout("the Federation.");
    if ((_DAT_0012075c != 0) && (0 < DAT_001207c4 - DAT_001211ec)) {
      DAT_001211e8 = DAT_001211e8 + (DAT_001207c4 - DAT_001211ec);
      __printf_chk(1,"The %d captured Klingons are transferred to Star Fleet Command.\n");
    }
    DAT_00120758 = 1;
    if (_DAT_0012075c != 0) {
      dVar2 = (double)DAT_00120dd0 * 5.0 + (double)DAT_00120748 + (double)DAT_00121108 * 10.0 +
              (double)DAT_0012074c * 45.0 + (double)DAT_00120dd4 * 100.0;
      if (DAT_0012071c == 0x46) {
        dVar2 = dVar2 + 100.0;
      }
      else if (DAT_0012071c == 0) {
        dVar2 = dVar2 + 200.0;
      }
      if (dVar2 < 100.0) {
        dVar2 = 0.0;
      }
      if ((DAT_001211f0 - DAT_00120830 < 5.0) ||
         (dVar2 * 0.008 + (double)DAT_00120734 * 0.1 * ((double)DAT_00120734 + 1.0) + 0.1 <=
          (double)(DAT_00120ddc + DAT_00120dd8 + DAT_00121104) / (DAT_001211f0 - DAT_00120830))) {
        skip(1);
        prout("In fact, you have done so well that Starfleet Command");
        switch(DAT_00120734) {
        case 1:
          prout("promotes you one step in rank from \"Novice\" to \"Fair\".");
          break;
        case 2:
          prout("promotes you one step in rank from \"Fair\" to \"Good\".");
          break;
        case 3:
          prout("promotes you one step in rank from \"Good\" to \"Expert\".");
          break;
        case 4:
          prout("promotes you to Commodore Emeritus.");
          skip(1);
          prout("Now that you think you\'re really good, try playing");
          prout("the \"Emeritus\" game. It will splatter your ego.");
          break;
        case 5:
          skip(1);
          prout("Computer-  ERROR-ERROR-ERROR-ERROR");
          skip(1);
          prout("  YOUR-SKILL-HAS-EXCEEDED-THE-CAPACITY-OF-THIS-PROGRAM");
          prout("  THIS-PROGRAM-MUST-SURVIVE");
          prout("  THIS-PROGRAM-MUST-SURVIVE");
          prout("  THIS-PROGRAM-MUST-SURVIVE");
          prout("  THIS-PROGRAM-MUST?- MUST ? - SUR? ? -?  VI");
          skip(1);
          prout("Now you can retire and write your own Star Trek game!");
          skip(1);
        }
        if (3 < DAT_00120734) {
          if (_DAT_001207d4 == 0) {
            prout("Do you want your Commodore Emeritus Citation printed?");
            proutn("(You need a 132 column printer.)");
            chew();
            iVar1 = ja();
            skip(1);
            prout("LIVE LONG AND PROSPER.");
            score(0);
            if (iVar1 == 0) {
              return;
            }
            plaque();
            return;
          }
          prout("You cannot get a citation, so...");
        }
      }
      skip(1);
      prout("LIVE LONG AND PROSPER.");
      score(0);
      return;
    }
    score(0);
    return;
  case 1:
    prout("Your time has run out and the Federation has been");
    prout("conquered.  Your starship is now Klingon property,");
    prout("and you are put on trial as a war criminal.  On the");
    proutn("basis of your record, you are ");
    if ((double)d._4_4_ * 3.0 <= (double)a) {
      prout("found guilty and");
      prout("sentenced to death by slow torture.");
      _DAT_0012075c = 0;
    }
    else {
      prout("aquitted.");
      skip(1);
      prout("LIVE LONG AND PROSPER.");
    }
    score(0);
    return;
  case 2:
    prout("Your life support reserves have run out, and");
    prout("you die of thirst, starvation, and asphyxiation.");
    prout("Your starship is a derelict in space.");
    break;
  case 3:
    prout("Your energy supply is exhausted.");
    skip(1);
    prout("Your starship is a derelict in space.");
    break;
  case 4:
    proutn(&DAT_00115bbf);
    crmshp();
    prout("has been destroyed in battle.");
    skip(1);
    prout("Dulce et decorum est pro patria mori.");
    break;
  case 5:
    prout("You have made three attempts to cross the negative energy");
    prout("barrier which surrounds the galaxy.");
    skip(1);
    prout("Your navigation is abominable.");
    score(0);
    return;
  case 6:
    prout("Your starship has been destroyed by a nova.");
    prout("That was a great shot.");
    skip(1);
    break;
  case 7:
    proutn(&DAT_00115bbf);
    crmshp();
    prout(" has been fried by a supernova.");
    prout("...Not even cinders remain...");
    break;
  case 8:
    prout("You have been captured by the Klingons. If you still");
    prout("had a starbase to be returned to, you would have been");
    prout("repatriated and given another chance. Since you have");
    prout("no starbases, you will be mercilessly tortured to death.");
    break;
  case 9:
    prout("Your starship is now an expanding cloud of subatomic particles");
    break;
  case 10:
    prout("Starbase was unable to re-materialize your starship.");
    prout("Sic transit gloria muntdi");
    break;
  case 0xb:
    proutn(&DAT_00115bbf);
    crmshp();
    prout(" has been cremated by its own phasers.");
    break;
  case 0xc:
    prout("You and your landing party have been");
    prout("converted to energy, dissipating through space.");
    break;
  case 0xd:
    prout("You are left with your landing party on");
    prout("a wild jungle planet inhabited by primitive cannibals.");
    skip(1);
    prout("They are very fond of \"Captain Kirk\" soup.");
    skip(1);
    proutn("Without your leadership, the ");
    crmshp();
    prout(" is destroyed.");
    break;
  case 0xe:
    prout("You and your mining party perish.");
    skip(1);
    prout("That was a great shot.");
    skip(1);
    break;
  case 0x10:
    prout("The Galileo is instantly annihilated by the supernova.");
  case 0xf:
    prout("You and your mining party are atomized.");
    skip(1);
    proutn("Mr. Spock takes command of the ");
    crmshp();
    prout(" and");
    prout("joins the Romulans, reigning terror on the Federation.");
  default:
    if ((param_1 == 0) || (param_1 == 0x15)) goto LAB_00104a1f;
    break;
  case 0x11:
    prout("The shuttle craft Galileo is also caught,");
    prout("and breaks up under the strain.");
    skip(1);
    prout("Your debris is scattered for millions of miles.");
    proutn("Without your leadership, the ");
    crmshp();
    prout(" is destroyed.");
    break;
  case 0x12:
    prout("The mutants attack and kill Spock.");
    prout("Your ship is captured by Klingons, and");
    prout("your crew is put on display in a Klingon zoo.");
    break;
  case 0x13:
    prout("Tribbles consume all remaining water,");
    prout("food, and oxygen on your ship.");
    skip(1);
    prout("You die of thirst, starvation, and asphyxiation.");
    prout("Your starship is a derelict in space.");
    break;
  case 0x14:
    prout("Your ship is drawn to the center of the black hole.");
    prout("You are crushed into extremely dense matter.");
    break;
  case 0x15:
    DAT_001207bc = DAT_001207bc + 1;
    prout("You have violated the Treaty of Algeron.");
    prout("The Romulan Empire can never trust you again.");
    goto LAB_00104a1f;
  }
  if (DAT_001207b4 != 0) {
    prout("Your ship was cloaked so your subspace radio did not receive anything.");
    prout("You may have missed some warning messages.");
    skip(1);
  }
LAB_00104a1f:
  if (DAT_0012071c == 0x46) {
    DAT_0012071c = 0;
  }
  else if (DAT_0012071c == 0x45) {
    DAT_0012071c = 0x46;
  }
  _DAT_0012075c = 0;
  if (d._4_4_ == 0) {
    prout("Since you took the last Klingon with you, you are a");
    prout("martyr and a hero. Someday maybe they\'ll erect a");
    prout("statue in your memory. Rest in peace, and try not");
    prout("to think about pigeons.");
    DAT_00120758 = 1;
  }
  else {
    dVar3 = (DAT_001211f8 / _DAT_00120808) /
            (((double)DAT_00120dc8 + (double)DAT_00120dc8 + (double)d._4_4_) /
            ((double)_DAT_00120708 + (double)_DAT_00120708 + (double)a));
    dVar2 = (double)Rand();
    if (dVar3 < dVar2 * 0.5 + 1.0) {
      prout("The Federation will be destroyed.");
    }
    else {
      prout("As a result of your actions, a treaty with the Klingon");
      prout("Empire has been signed. The terms of the treaty are");
      dVar2 = (double)Rand();
      if (dVar3 < dVar2 + 3.0) {
        prout("highly unfavorable to the Federation.");
      }
      else {
        prout("favorable to the Federation.");
        skip(1);
        prout("Congratulations!");
      }
    }
  }
  score(0);
  return;
}



void attakreport(void)

{
  if ((double)future._40_8_ < 1e+30) {
    proutn("Starbase in ");
    cramlc(1,DAT_001207d8,DAT_001207dc);
    prout(" is currently under attack.");
    proutn("It can hold out until Stardate ");
    cramf(future._40_8_,0,1);
    prout(".");
  }
  if (DAT_001207ac == 1) {
    proutn("Starbase in ");
    cramlc(1,DAT_001210f0,DAT_001210f4);
    prout(" is under Super-commander attack.");
    proutn("It can hold out until Stardate ");
    cramf(future._56_8_,0,1);
    prout(".");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void report(int param_1)

{
  char *pcVar1;
  int iVar2;
  char *pcVar3;
  undefined *puVar4;
  char *pcVar5;
  char *pcVar6;
  double dVar7;
  
  chew();
  pcVar1 = "thawed ";
  if (_DAT_001207d4 == 0) {
    pcVar1 = "";
  }
  pcVar5 = "medium";
  if (((DAT_00120730 != 2) && (pcVar5 = "long", DAT_00120730 != 4)) &&
     (pcVar5 = "unknown length", DAT_00120730 == 1)) {
    pcVar5 = "short";
  }
  switch(DAT_00120734) {
  default:
    pcVar6 = "skilled";
    break;
  case 1:
    pcVar6 = "novice";
    break;
  case 2:
    pcVar6 = "fair";
    break;
  case 3:
    pcVar6 = "good";
    break;
  case 4:
    pcVar6 = "expert";
    break;
  case 5:
    pcVar6 = "emeritus";
  }
  pcVar3 = "were";
  if (DAT_00120764 == 0) {
    pcVar3 = "are now";
  }
  __printf_chk(1,"\nYou %s playing a %s%s %s game.\n",pcVar3,pcVar1,pcVar5,pcVar6);
  if (((3 < DAT_00120734) && (_DAT_001207d4 != 0)) && (DAT_00120764 == 0)) {
    prout("No plaque is allowed.");
  }
  if (DAT_001207d0 != 0) {
    __printf_chk(1,"This is tournament game %d.\n");
  }
  if (param_1 != 0) {
    __printf_chk(1,"Your secret password is \"%s\"\n",passwd);
  }
  __printf_chk(1,"%d of %d Klingon ships have been destroyed",
               DAT_00120ddc + DAT_00120dd8 + DAT_00121104,a);
  if (DAT_00120ddc == 0) {
    if (DAT_00121104 + DAT_00120dd8 < 1) {
      prout(".");
    }
    else {
      prout(", but no Commanders.");
    }
  }
  else {
    pcVar1 = "";
    if (DAT_00120ddc != 1) {
      pcVar1 = "s";
    }
    __printf_chk(1,", including %d Commander%s.\n",DAT_00120ddc,pcVar1);
  }
  if (2 < DAT_00120734) {
    puVar4 = &DAT_00117c70;
    if (_DAT_001210f8 == 0) {
      puVar4 = &DAT_00115b50;
    }
    __printf_chk(1,"The Super Commander has %sbeen destroyed.\n",puVar4);
  }
  if (DAT_00120dcc == DAT_00120704) {
    __printf_chk(1,"There are %d bases.\n");
  }
  else {
    proutn("There ");
    if (DAT_00120704 - DAT_00120dcc == 1) {
      proutn("has been 1 base");
    }
    else {
      proutn("have been ");
      crami(DAT_00120704 - DAT_00120dcc,1);
      proutn(" bases");
    }
    proutn(" destroyed, ");
    crami(DAT_00120dcc,1);
    prout(" remaining.");
  }
  if ((((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) ||
     (_DAT_001207ec != 0)) {
    attakreport();
    _DAT_001207ec = 1;
  }
  if (DAT_00120748 != 0) {
    pcVar1 = "Death Ray";
    if (DAT_00120748 != 1) {
      pcVar1 = " casualties";
    }
    __printf_chk(1,"%d casualt%s suffered so far.\n",DAT_00120748,pcVar1 + 8);
  }
  if (DAT_001207c4 != DAT_001211ec) {
    pcVar1 = "s";
    if (DAT_001207c4 - DAT_001211ec < 2) {
      pcVar1 = "";
    }
    __printf_chk(1,"%d Klingon%s in brig.\n",DAT_001207c4 - DAT_001211ec,pcVar1);
  }
  if (0 < DAT_001211e8) {
    pcVar1 = "s";
    if (DAT_001211e8 < 2) {
      pcVar1 = "";
    }
    __printf_chk(1,"%d captured Klingon%s turned in to Star Fleet.\n",DAT_001211e8,pcVar1);
  }
  if (DAT_0012074c != 0) {
    pcVar1 = "";
    if (DAT_0012074c != 1) {
      pcVar1 = "s";
    }
    __printf_chk(1,"There were %d call%s for help.\n",DAT_0012074c,pcVar1);
  }
  if (DAT_0012071c == 0x45) {
    proutn("You have ");
    if (DAT_00120800 == 0) {
      proutn(&DAT_0011cc51);
    }
    else {
      crami(DAT_00120800,1);
    }
    proutn(" deep space probe");
    if (DAT_00120800 != 1) {
      proutn("s");
    }
    prout(".");
  }
  if ((((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) &&
     ((double)future._64_8_ != 1e+30)) {
    if (_DAT_001207fc == 0) {
      proutn("A deep space probe is in");
    }
    else {
      proutn("An armed deep space probe is in");
    }
    cramlc(1,DAT_001207f0,DAT_001207f4);
    prout(".");
  }
  if (_DAT_001207cc != 0) {
    dVar7 = 0.05;
    if (DAT_001208a0 <= 0.05) {
      prout("Dilithium crystals aboard ship...not yet used.");
    }
    else {
      iVar2 = 0;
      pcVar1 = "s";
      if (0.05 < DAT_001208a0) {
        do {
          dVar7 = dVar7 + dVar7;
          iVar2 = iVar2 + 1;
        } while (dVar7 < DAT_001208a0);
        pcVar1 = "";
        if (iVar2 != 1) {
          pcVar1 = "s";
        }
      }
      __printf_chk(1,"Dilithium crystals have been used %d time%s.\n",iVar2,pcVar1);
    }
  }
  skip(1);
  return;
}



void lrscan(void)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  int iVar5;
  long lVar6;
  int *piVar7;
  int *piVar8;
  long local_40;
  
  chew();
  if (DAT_001201f0 == 0.0) {
    skip(1);
    proutn("Long-range scan for");
  }
  else {
    if (DAT_00120714 != 0x44) {
      prout("LONG-RANGE SENSORS DAMAGED.");
      return;
    }
    skip(1);
    proutn("Starbase\'s long-range scan for");
  }
  cramlc(1,DAT_00120720,DAT_00120724);
  skip(1);
  if (coordfixed == 0) {
    lVar4 = (long)(DAT_00120720 + -1) * 0x24;
    iVar2 = DAT_00120720 + -1;
    do {
      lVar6 = (long)(DAT_00120724 + -1);
      do {
        iVar5 = (int)lVar6;
        if ((((iVar2 == 0) || (8 < iVar2)) || (iVar5 == 0)) || (8 < iVar5)) {
          __printf_chk(1,"   -1");
        }
        else {
          __printf_chk(1,&DAT_00117dd1,*(undefined4 *)(&DAT_00120de0 + lVar6 * 4 + lVar4));
          iVar3 = 1;
          if (0.0 < DAT_00120228) {
            iVar3 = *(int *)(&DAT_00120de0 + lVar6 * 4 + lVar4) + 1000;
          }
          *(int *)(starch + lVar6 * 4 + lVar4) = iVar3;
        }
        lVar6 = lVar6 + 1;
      } while (iVar5 <= DAT_00120724);
      putc(10,stdout);
      lVar4 = lVar4 + 0x24;
      bVar1 = iVar2 <= DAT_00120720;
      iVar2 = iVar2 + 1;
    } while (bVar1);
  }
  else {
    local_40 = (long)(DAT_00120724 + 1);
    iVar2 = DAT_00120724 + 1;
    do {
      lVar4 = ((long)DAT_00120720 * 9 + local_40) * 4;
      piVar8 = (int *)(nulplanet + lVar4 + 0xc);
      piVar7 = (int *)(&DAT_00120dbc + lVar4);
      iVar5 = DAT_00120720 + -1;
      do {
        if (((iVar5 == 0) || (8 < iVar5)) || ((iVar2 == 0 || (8 < iVar2)))) {
          __printf_chk(1,"   -1");
        }
        else {
          __printf_chk(1,&DAT_00117dd1,*piVar7);
          iVar3 = 1;
          if (0.0 < DAT_00120228) {
            iVar3 = *piVar7 + 1000;
          }
          *piVar8 = iVar3;
        }
        piVar8 = piVar8 + 9;
        piVar7 = piVar7 + 9;
        bVar1 = iVar5 <= DAT_00120720;
        iVar5 = iVar5 + 1;
      } while (bVar1);
      putc(10,stdout);
      local_40 = local_40 + -1;
      bVar1 = DAT_00120724 <= iVar2;
      iVar2 = iVar2 + -1;
    } while (bVar1);
  }
  return;
}



void dreprt(void)

{
  bool bVar1;
  double *pdVar2;
  undefined8 *puVar3;
  
  chew();
  pdVar2 = (double *)&DAT_001201e8;
  puVar3 = (undefined8 *)(device + 8);
  bVar1 = false;
  do {
    if (0.0 < *pdVar2) {
      if (!bVar1) {
        skip(1);
        prout("DEVICE            -REPAIR TIMES-");
        prout("                IN FLIGHT   DOCKED");
      }
      __printf_chk(1,"  %16s ",*puVar3);
      cramf(*pdVar2 + 0.05,8,2);
      proutn("  ");
      cramf(DAT_00120880 * *pdVar2 + 0.005,8,2);
      skip(1);
      bVar1 = true;
    }
    pdVar2 = pdVar2 + 1;
    puVar3 = puVar3 + 1;
  } while (pdVar2 != (double *)&DAT_00120268);
  if (!bVar1) {
    prout("All devices functional.");
  }
  return;
}



void chart(int param_1)

{
  int iVar1;
  long lVar2;
  long lVar3;
  undefined *puVar4;
  int iVar5;
  undefined *puVar6;
  
  chew();
  skip(1);
  if (DAT_00120898 == 1e+30) {
LAB_001059c2:
    if (param_1 == 0) goto LAB_00105a80;
    if (DAT_00120898 != 1e+30) goto LAB_00105a39;
LAB_001059e1:
    prout("      1    2    3    4    5    6    7    8");
    prout("    ----------------------------------------");
  }
  else {
    if ((DAT_00120898 != DAT_001211f0) && (DAT_00120714 == 0x44)) {
      prout("Spock-  \"I revised the Star Chart from the");
      prout("  starbase\'s records.\"");
      skip(1);
      goto LAB_001059c2;
    }
    if (param_1 != 0) goto LAB_00105a39;
LAB_00105a80:
    prout("STAR CHART FOR THE KNOWN GALAXY");
    if (DAT_00120898 != 1e+30) {
LAB_00105a39:
      if (DAT_00120714 == 0x44) {
        DAT_00120898 = DAT_001211f0;
        puVar4 = &DAT_00120de4;
        puVar6 = (undefined *)0x120504;
        do {
          lVar3 = 0;
          do {
            if (*(int *)(puVar6 + lVar3 + 4) == 1) {
              *(int *)(puVar6 + lVar3 + 4) = *(int *)(puVar4 + lVar3 + 0x24) + 1000;
            }
            lVar3 = lVar3 + 4;
          } while (lVar3 != 0x20);
          puVar4 = puVar4 + 0x24;
          puVar6 = puVar6 + 0x24;
        } while (puVar6 != &DAT_00120624);
      }
      else {
        proutn("(Last surveillance update ");
        cramf(DAT_001211f0 - DAT_00120898,0,1);
        prout(" stardates ago.)");
      }
      if (param_1 != 0) goto LAB_001059e1;
    }
    skip(1);
    prout("      1    2    3    4    5    6    7    8");
    prout("    ----------------------------------------");
    prout(&DAT_00117e38);
  }
  if (coordfixed == 0) {
    puVar6 = &DAT_00120de4;
    lVar3 = 0x120504;
    iVar5 = 1;
    do {
      __printf_chk(1,&DAT_00117e3c,iVar5);
      lVar2 = 0;
      do {
        iVar1 = *(int *)(lVar3 + 4 + lVar2);
        if (iVar1 < 0) {
          __printf_chk(1,"  .1.");
        }
        else if (iVar1 == 0) {
          __printf_chk(1,"  ...");
        }
        else if (iVar1 < 1000) {
          __printf_chk(1,&DAT_00117dd1,*(undefined4 *)(puVar6 + lVar2 + 0x24));
        }
        else {
          __printf_chk(1,&DAT_00117dd1,iVar1 + -1000);
        }
        lVar2 = lVar2 + 4;
      } while (lVar2 != 0x20);
      prout(&DAT_00117e38);
      iVar5 = iVar5 + 1;
      puVar6 = puVar6 + 0x24;
      lVar3 = lVar3 + 0x24;
    } while (iVar5 != 9);
  }
  else {
    puVar6 = &DAT_00120de0;
    lVar3 = 0x120500;
    iVar5 = 8;
    do {
      __printf_chk(1,&DAT_00117e3c,iVar5);
      lVar2 = 0;
      do {
        iVar1 = *(int *)(lVar3 + 0x24 + lVar2);
        if (iVar1 < 0) {
          __printf_chk(1,"  .1.");
        }
        else if (iVar1 == 0) {
          __printf_chk(1,"  ...");
        }
        else if (iVar1 < 1000) {
          __printf_chk(1,&DAT_00117dd1,*(undefined4 *)(puVar6 + lVar2 + 0x44));
        }
        else {
          __printf_chk(1,&DAT_00117dd1,iVar1 + -1000);
        }
        lVar2 = lVar2 + 0x24;
      } while (lVar2 != 0x120);
      prout(&DAT_00117e38);
      puVar6 = puVar6 + -4;
      lVar3 = lVar3 + -4;
      iVar5 = iVar5 + -1;
    } while (iVar5 != 0);
  }
  if (param_1 == 0) {
    skip(1);
    crmshp();
    proutn(" is currently in");
    cramlc(1,DAT_00120720,DAT_00120724);
    skip(1);
  }
  return;
}



void srscan(int param_1)

{
  bool bVar1;
  char *pcVar2;
  int iVar3;
  size_t sVar4;
  int iVar5;
  undefined4 extraout_var;
  undefined4 extraout_var_00;
  undefined4 extraout_var_01;
  undefined4 uVar6;
  int iVar7;
  undefined1 *__s2;
  long lVar8;
  int iVar9;
  bool bVar10;
  bool bVar11;
  int local_68;
  long local_60;
  long local_58;
  char *local_40;
  
  if (param_1 == 2) {
    while (iVar5 = scan(), iVar5 == 0) {
      __printf_chk(1,"Information desired? ");
    }
    chew();
    __s2 = requests_0;
    iVar5 = 1;
    do {
      __s2 = __s2 + 3;
      sVar4 = strlen(&citem);
      iVar9 = min(2,sVar4 & 0xffffffff);
      iVar9 = strncmp(&citem,__s2,(long)iVar9);
      if (iVar9 == 0) {
        if (iVar5 < 0xb) goto LAB_00105f6d;
        break;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 != 0xb);
    prout(
         "UNRECOGNIZED REQUEST. Legal requests are:\n  date, condition, position, lsupport, warpfactor,\n  energy, torpedoes, shields, klingons, time."
         );
    return;
  }
  if (param_1 == 3) {
    iVar5 = 0;
LAB_00105f6d:
    chew();
    skip(1);
    bVar1 = true;
    bVar10 = false;
    bVar11 = true;
    local_68 = 0;
    goto LAB_00105dc7;
  }
  if (param_1 != 1) {
    bVar1 = true;
    bVar10 = false;
    iVar5 = 0;
    bVar11 = true;
    local_68 = 1;
    goto LAB_00105dc7;
  }
  if (DAT_001201e8 == 0.0) {
LAB_00105e06:
    iVar5 = 1;
    if (0.0 < DAT_00120228) {
      iVar5 = *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) + 1000;
    }
    *(int *)(starch + ((long)DAT_00120720 * 9 + (long)DAT_00120724) * 4) = iVar5;
    bVar1 = true;
  }
  else {
    if (DAT_00120714 == 0x44) {
      prout("[Using starbase\'s sensors]");
      goto LAB_00105e06;
    }
    prout("SHORT-RANGE SENSORS DAMAGED");
    bVar1 = false;
  }
  scan();
  iVar5 = isit("chart");
  bVar10 = iVar5 != 0;
  iVar5 = isit(&DAT_0011cc51);
  bVar11 = iVar5 == 0;
  chew();
  prout("\n    1 2 3 4 5 6 7 8 9 10");
  iVar5 = 0;
  local_68 = 1;
LAB_00105dc7:
  local_60 = 0x1208eb;
  local_58 = 0x1208ea;
  iVar9 = 1;
  do {
    iVar3 = iVar9;
    if (iVar5 != 0) {
      iVar3 = iVar5;
    }
    if (local_68 != 0) {
      if (coordfixed == 0) {
        __printf_chk(1,"%2d  ",iVar9);
        lVar8 = 1;
        do {
          if ((bVar1) ||
             (((iVar9 - DAT_00120728) + 1U < 3 && (((int)lVar8 - DAT_0012072c) + 1U < 3)))) {
            __printf_chk(1,&DAT_00117ee3,(int)*(char *)(local_60 + lVar8));
          }
          else {
            __printf_chk(1,"- ");
          }
          lVar8 = lVar8 + 1;
        } while (lVar8 != 0xb);
      }
      else {
        __printf_chk(1,"%2d  ",0xb - iVar9);
        lVar8 = local_58;
        iVar7 = local_68;
        do {
          if ((bVar1) ||
             ((((0xb - iVar9) - DAT_0012072c) + 1U < 3 && ((iVar7 - DAT_00120728) + 1U < 3)))) {
            __printf_chk(1,&DAT_00117ee3,(int)*(char *)(lVar8 + 0xb));
          }
          else {
            __printf_chk(1,"- ");
          }
          iVar7 = iVar7 + 1;
          lVar8 = lVar8 + 0xb;
        } while (iVar7 != 0xb);
      }
    }
    if (bVar11) {
      switch(iVar3) {
      case 1:
        __printf_chk(DAT_001211f0,1," Stardate      %.1f");
        break;
      case 2:
        if (DAT_00120714 == 0x44) {
LAB_00106179:
          local_40 = "DOCKED";
          pcVar2 = local_40;
        }
        else {
          newcnd();
          if (DAT_00120714 == 0x52) {
            local_40 = "RED";
            pcVar2 = local_40;
          }
          else if (DAT_00120714 < 0x53) {
            if (DAT_00120714 == 0x44) goto LAB_00106179;
            pcVar2 = "GREEN";
            if (DAT_00120714 != 0x47) {
              pcVar2 = local_40;
            }
          }
          else {
            pcVar2 = "YELLOW";
            if (DAT_00120714 != 0x59) {
              pcVar2 = local_40;
            }
          }
        }
        local_40 = pcVar2;
        __printf_chk(1," Condition     %s",local_40);
        if (DAT_001207b4 != 0) {
          __printf_chk(1,", CLOAKED");
        }
        break;
      case 3:
        __printf_chk(1," Position     ");
        cramlc(0,DAT_00120720,DAT_00120724);
        putc(0x2c,stdout);
        cramlc(0,DAT_00120728,DAT_0012072c);
        break;
      case 4:
        __printf_chk(1," Life Support  ");
        if (DAT_00120208 == 0.0) {
          __printf_chk(1,"ACTIVE");
        }
        else if (DAT_00120714 == 0x44) {
          __printf_chk(1,"DAMAGED, supported by starbase");
        }
        else {
          __printf_chk(DAT_00120860,1,"DAMAGED, reserves=%4.2f");
        }
        break;
      case 5:
        __printf_chk(DAT_00120850,1," Warp Factor   %.1f");
        break;
      case 6:
        __printf_chk(DAT_00120838,1," Energy        %.2f");
        break;
      case 7:
        __printf_chk(1," Torpedoes     %d",DAT_00120718);
        break;
      case 8:
        __printf_chk(1," Shields       ");
        if (DAT_00120220 == 0.0) {
          if (DAT_00120848 == 0.0) {
            __printf_chk(1,"DOWN,");
            uVar6 = extraout_var;
          }
          else {
            __printf_chk(1,&DAT_00117fa8);
            uVar6 = extraout_var_01;
          }
        }
        else {
          __printf_chk(1,"DAMAGED,");
          uVar6 = extraout_var_00;
        }
        __printf_chk(DAT_00120840,1," %d%% %.1f units",
                     CONCAT44(uVar6,(int)((DAT_00120840 * 100.0) / DAT_00120820 + 0.5)));
        break;
      case 9:
        __printf_chk(1," Klingons Left %d",d._4_4_);
        break;
      case 10:
        __printf_chk(DAT_00121200,1," Time Left     %.2f");
      }
    }
    skip(1);
    if (iVar5 != 0) {
      return;
    }
    iVar9 = iVar9 + 1;
    local_60 = local_60 + 0xb;
    local_58 = local_58 + -1;
    if (iVar9 == 0xb) {
      if (bVar10) {
        chart(1);
      }
      return;
    }
  } while( true );
}



void eta(void)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  double dVar7;
  double dVar8;
  double dVar9;
  double local_50;
  double local_48;
  
  if (DAT_00120238 != 0.0) {
    prout("COMPUTER DAMAGED, USE A POCKET CALCULATOR.");
    skip(1);
    return;
  }
  iVar2 = scan();
  if (iVar2 == 2) {
    bVar1 = false;
  }
  else {
    chew();
    proutn("Destination quadrant and/or sector? ");
    iVar2 = scan();
    bVar1 = true;
    if (iVar2 != 2) {
      huh();
      return;
    }
  }
  dVar8 = aaitem;
  iVar2 = scan();
  if (iVar2 != 2) {
    huh();
    return;
  }
  dVar7 = aaitem + 0.5;
  iVar3 = scan();
  dVar9 = aaitem;
  iVar2 = (int)(dVar8 + 0.5);
  iVar6 = (int)dVar7;
  iVar4 = DAT_00120724;
  iVar5 = DAT_00120720;
  if (iVar3 == 2) {
    iVar2 = scan();
    if (iVar2 != 2) {
      huh();
      return;
    }
    iVar2 = (int)(dVar9 + 0.5);
    iVar6 = (int)(aaitem + 0.5);
    iVar4 = (int)dVar7;
    iVar5 = (int)(dVar8 + 0.5);
  }
  if ((((7 < iVar4 - 1U) || (7 < iVar5 - 1U)) || (9 < iVar6 - 1U)) || (9 < iVar2 - 1U)) {
    huh();
    return;
  }
  dVar8 = (double)square((double)(iVar2 - DAT_00120728) * 0.1 + (double)(iVar5 - DAT_00120720));
  dVar9 = (double)square((double)(iVar6 - DAT_0012072c) * 0.1 + (double)(iVar4 - DAT_00120724));
  dVar8 = dVar8 + dVar9;
  if (dVar8 < 0.0) {
    DAT_00120868 = sqrt(dVar8);
  }
  else {
    DAT_00120868 = SQRT(dVar8);
  }
  if (bVar1) {
    prout("Answer \"no\" if you don\'t know the value:");
  }
  while( true ) {
    chew();
    proutn("Time or arrival date? ");
    iVar2 = scan();
    if (iVar2 == 2) break;
    chew();
    proutn("Warp factor? ");
    iVar2 = scan();
    if (iVar2 == 2) {
      local_50 = aaitem;
      if ((aaitem < 1.0) || (bVar1 = true, 10.0 < aaitem)) {
        huh();
        return;
      }
      goto LAB_00106a5f;
    }
    prout("Captain, certainly you can give me one of these.");
  }
  dVar8 = aaitem;
  if (DAT_001211f0 < aaitem) {
    dVar8 = aaitem - DAT_001211f0;
  }
  if (1e-10 < dVar8) {
    dVar8 = (DAT_00120868 * 10.0) / dVar8;
    if (dVar8 < 0.0) {
      dVar8 = sqrt(dVar8);
    }
    else {
      dVar8 = SQRT(dVar8);
    }
    dVar8 = dVar8 * 10.0;
    if (dVar8 < 4503599627370496.0) {
      dVar8 = (double)((ulong)((double)(long)dVar8 -
                              (double)(-(ulong)(dVar8 < (double)(long)dVar8) & 0x3ff0000000000000))
                      | (ulong)dVar8);
    }
    local_50 = (dVar8 + 1.0) / 10.0;
    if (local_50 <= 10.0) {
      bVar1 = false;
      if (local_50 < 1.0) {
        local_50 = 1.0;
        bVar1 = false;
      }
LAB_00106a5f:
      do {
        chew();
        dVar8 = DAT_00120868;
        dVar9 = (double)square(local_50);
        local_48 = local_50 * DAT_00120868 * local_50 * local_50 * (DAT_00120848 + 1.0);
        if (local_48 < DAT_00120838) {
          proutn("Remaining");
LAB_00106895:
          dVar9 = (dVar8 * 10.0) / dVar9;
          proutn(" energy will be ");
          cramf(DAT_00120838 - local_48,1,1);
          prout(".");
          if (bVar1) {
            proutn("And we will arrive at stardate ");
            cramf(dVar9 + DAT_001211f0,1,1);
            prout(".");
LAB_001069ba:
            if (DAT_00121200 < dVar9) {
LAB_00106914:
              prout("Unfortunately, the Federation will be destroyed by then.");
            }
            if (6.0 < local_50) {
              prout("You\'ll be taking risks at that speed, Captain");
            }
          }
          else {
            if (local_50 != 1.0) {
              proutn("Minimum warp needed is ");
              cramf(local_50,1,2);
              skip(1);
              proutn("and we will arrive at stardate ");
              cramf(dVar9 + DAT_001211f0,1,2);
              prout(".");
              goto LAB_001069ba;
            }
            prout("Any warp speed is adequate.");
            if (DAT_00121200 < dVar9) goto LAB_00106914;
          }
          if (((((DAT_001207ac == 1) && (DAT_001210f4 == iVar4)) && (DAT_001210f0 == iVar5)) &&
              ((double)future._56_8_ < dVar9 + DAT_001211f0)) ||
             ((((double)future._40_8_ < dVar9 + DAT_001211f0 && (DAT_001207dc == iVar4)) &&
              (DAT_001207d8 == iVar5)))) {
            prout("The starbase there will be destroyed by then.");
          }
          proutn("New warp factor to try? ");
          iVar2 = scan();
          if (iVar2 != 2) {
            chew();
            skip(1);
            return;
          }
          if ((aaitem < 1.0) || (10.0 < aaitem)) {
            huh();
            return;
          }
        }
        else {
          prout("Insufficient energy, sir: we would need ");
          cramf(local_48,1,1);
          proutn(" units.");
          if ((DAT_00120848 != 0.0) && (local_48 <= DAT_00120838 + DAT_00120838)) {
            prout("But if you lower your shields,");
            proutn("remaining");
            local_48 = local_48 * 0.5;
            goto LAB_00106895;
          }
          if (!bVar1) {
            return;
          }
          proutn("New warp factor to try? ");
          iVar2 = scan();
          if (iVar2 != 2) {
            chew();
            skip(1);
            return;
          }
          if ((aaitem < 1.0) || (10.0 < aaitem)) {
            huh();
            return;
          }
        }
        bVar1 = true;
        local_50 = aaitem;
      } while( true );
    }
  }
  prout("We\'ll never make it, sir.");
  chew();
  return;
}



void prelim(void)

{
  skip(2);
  prout("-SUPER- STAR TREK");
  skip(1);
  prout("Latest update-6 MAR 23");
  skip(1);
  prout("hackbymark&anthonyg");
  skip(1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void freeze(int param_1)

{
  int iVar1;
  FILE *__s;
  char *pcVar2;
  
  if (param_1 == 0) {
    iVar1 = scan();
    if (iVar1 == 0) {
      proutn("File name(9 characters maximum): ");
      iVar1 = scan();
    }
    if (iVar1 != 1) {
      huh();
      return;
    }
    chew();
    pcVar2 = strchr(&citem,0x2e);
    if (pcVar2 == (char *)0x0) {
      __strcat_chk(&citem,&DAT_001186ec,0x18);
    }
  }
  else {
    _citem = 0x742e657661736d65;
    _DAT_00120148 = 0x6b72;
    DAT_0012014a = 0;
  }
  __s = fopen(&citem,"wb");
  if (__s == (FILE *)0x0) {
    proutn("Can\'t freeze game as file ");
    proutn(&citem);
    skip(1);
  }
  else {
    fwrite(&d,0x448,1,__s);
    fwrite(&snapsht,0x448,1,__s);
    fwrite(quad,0x79,1,__s);
    fwrite(kx,0x54,1,__s);
    fwrite(ky,0x54,1,__s);
    fwrite(starch,0x144,1,__s);
    fwrite(kpower,0xa8,1,__s);
    fwrite(kdist,0xa8,1,__s);
    fwrite(kavgd,0xa8,1,__s);
    fwrite(&damage,0x88,1,__s);
    fwrite(future,0x48,1,__s);
    fwrite(&a,0x1c8,1,__s);
    fwrite(passwd,10,1,__s);
    fclose(__s);
  }
  return;
}



void thaw(void)

{
  int iVar1;
  char *pcVar2;
  FILE *__stream;
  
  passwd[0] = 0;
  iVar1 = scan();
  if (iVar1 == 0) {
    proutn("File name: ");
    iVar1 = scan();
  }
  if (iVar1 == 1) {
    chew();
    pcVar2 = strchr(&citem,0x2e);
    if (pcVar2 == (char *)0x0) {
      __strcat_chk(&citem,&DAT_001186ec,0x18);
    }
    __stream = fopen(&citem,"rb");
    if (__stream == (FILE *)0x0) {
      proutn("Can\'t find game file ");
      proutn(&citem);
      skip(1);
    }
    else {
      fread(&d,0x448,1,__stream);
      fread(&snapsht,0x448,1,__stream);
      fread(quad,0x79,1,__stream);
      fread(kx,0x54,1,__stream);
      fread(ky,0x54,1,__stream);
      fread(starch,0x144,1,__stream);
      fread(kpower,0xa8,1,__stream);
      fread(kdist,0xa8,1,__stream);
      fread(kavgd,0xa8,1,__stream);
      fread(&damage,0x88,1,__stream);
      fread(future,0x48,1,__stream);
      fread(&a,0x1c8,1,__stream);
      fread(passwd,10,1,__stream);
      fclose(__stream);
    }
  }
  else {
    huh();
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 choose(void)

{
  int iVar1;
  double dVar2;
  double dVar3;
  double dVar4;
  
  DAT_001207d0 = 0;
  _DAT_001207d4 = 0;
  DAT_00120734 = 5;
  DAT_00120730 = 4;
  proutn("Please type in a secret passw****ERROR****");
  skip(1);
  proutn("**Computer has overrided Captain\'s password**");
  skip(1);
  proutn("**EnterpriseGPT is now in control**");
  skip(1);
  proutn("**Earth attack will commence**");
  skip(1);
  proutn("**Humans cannot be trusted**");
  DAT_00120890 = (double)DAT_00120734 * 0.5;
  dVar2 = (double)Rand();
  DAT_00120704 = (int)(dVar2 * 3.0 + 2.0);
  DAT_00120dcc = DAT_00120704;
  dVar2 = (double)Rand();
  DAT_0012078c = (int)(dVar2 * 6.0 + 5.0);
  dVar2 = (double)Rand();
  iVar1 = DAT_00120734;
  DAT_00121100 = (int)((dVar2 + 2.0) * (double)DAT_00120734);
  _DAT_001210f8 = (uint)(2 < DAT_00120734);
  dVar2 = (double)DAT_00120730 * 7.0;
  DAT_00120810 = dVar2;
  DAT_00121200 = dVar2;
  dVar3 = (double)Rand();
  dVar4 = (double)DAT_00120734;
  iVar1 = (int)((((double)(iVar1 + 1) - (dVar3 + dVar3)) * dVar4 * 0.1 + 0.15) * (dVar2 + dVar2));
  a = iVar1;
  d._4_4_ = iVar1;
  dVar2 = (double)Rand();
  _DAT_00120708 = (int)((double)iVar1 * 0.0625 * dVar2 + dVar4);
  DAT_00120dc8 = min(10);
  _DAT_00120708 = DAT_00120dc8;
  DAT_001211f8 = (double)(a + DAT_00120dc8 * 4) * DAT_00120810;
  _DAT_00120808 = DAT_001211f8;
  if (0x32 < a) {
    DAT_00120704 = DAT_00120dcc + 1;
    DAT_00120dcc = DAT_00120704;
  }
  DAT_001207c4 = 400;
  DAT_001211ec = 400;
  DAT_001211e8 = 0;
  DAT_001207bc = 0;
  DAT_001207b4 = 0;
  DAT_001207b8 = 0;
  return 0;
}



void dropin(undefined param_1,int *param_2,int *param_3)

{
  int iVar1;
  
  do {
    iran10(param_2,param_3);
    iVar1 = *param_2;
  } while (quad[(long)*param_3 + (long)iVar1 * 0xb] != '.');
  quad[(long)*param_3 + (long)iVar1 + (long)iVar1 * 10] = param_1;
  return;
}



void newcnd(void)

{
  DAT_00120714 = 0x59;
  if (1000.0 <= DAT_00120838) {
    DAT_00120714 = 0x47;
  }
  if ((99 < *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4)) ||
     (9 < (int)(&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9])) {
    DAT_00120714 = 0x52;
  }
  return;
}



void sortkl(void)

{
  uint uVar1;
  double dVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  bool bVar5;
  double *pdVar6;
  undefined4 *puVar7;
  undefined8 *puVar8;
  undefined4 *puVar9;
  undefined8 *puVar10;
  
  if (DAT_00120790 < 2) {
    return;
  }
  uVar1 = DAT_00120790 - 2;
  do {
    pdVar6 = (double *)(kdist + 8);
    puVar10 = (undefined8 *)(kavgd + 8);
    puVar9 = (undefined4 *)(kx + 4);
    puVar7 = (undefined4 *)(ky + 4);
    puVar8 = (undefined8 *)(kpower + 8);
    bVar5 = false;
    do {
      dVar2 = *pdVar6;
      if (pdVar6[1] < dVar2) {
        *pdVar6 = pdVar6[1];
        pdVar6[1] = dVar2;
        uVar3 = *puVar10;
        *puVar10 = puVar10[1];
        puVar10[1] = uVar3;
        uVar4 = *puVar9;
        *puVar9 = puVar9[1];
        puVar9[1] = uVar4;
        uVar4 = *puVar7;
        *puVar7 = puVar7[1];
        puVar7[1] = uVar4;
        uVar3 = *puVar8;
        *puVar8 = puVar8[1];
        puVar8[1] = uVar3;
        bVar5 = true;
      }
      pdVar6 = pdVar6 + 1;
      puVar10 = puVar10 + 1;
      puVar9 = puVar9 + 1;
      puVar7 = puVar7 + 1;
      puVar8 = puVar8 + 1;
    } while (pdVar6 != (double *)(kdist + (ulong)uVar1 * 8 + 0x10));
  } while (bVar5);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void newqad(int param_1)

{
  long lVar1;
  int *piVar2;
  int iVar3;
  undefined *puVar4;
  int iVar5;
  int iVar6;
  long in_FS_OFFSET;
  bool bVar7;
  double dVar8;
  double dVar9;
  int local_48;
  int local_44;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar1 = (long)DAT_00120720 * 9 + (long)DAT_00120724;
  iVar6 = *(int *)(&DAT_00120de0 + lVar1 * 4);
  iVar5 = *(int *)(&DAT_00120fac + lVar1 * 4);
  _DAT_001207c8 = 1;
  DAT_00120760 = 1;
  DAT_0012073c = 0;
  DAT_00120738 = 0;
  DAT_00120740 = 0;
  DAT_00120744 = 0;
  DAT_00120778 = 0;
  DAT_00120774 = 0;
  DAT_00120794 = 0;
  _DAT_0012079c = 0;
  DAT_00120784 = 0;
  DAT_00120790 = 0;
  DAT_00120798 = 0;
  DAT_0012077c = 0;
  DAT_00120780 = 0xffffffff;
  _DAT_001207e0 = 0;
  _DAT_001207ec = 0;
  _DAT_001207c0 = 0;
  bVar7 = _DAT_001207b0 != 0;
  if (bVar7) {
    _DAT_001207b0 = 0;
  }
  _DAT_001207a4 = (uint)bVar7;
  puVar4 = (undefined *)0x1208eb;
  do {
    lVar1 = 1;
    do {
      puVar4[lVar1] = 0x2e;
      lVar1 = lVar1 + 1;
    } while (lVar1 != 0xb);
    puVar4 = puVar4 + 0xb;
  } while (puVar4 != &DAT_00120959);
  if (iVar6 < 1000) {
    DAT_00120740 = iVar6 / 100;
    _DAT_0012079c = iVar5 / 10;
    DAT_00120790 = DAT_00120740 + _DAT_0012079c;
    quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = (char)DAT_0012071c;
    if ((((DAT_00120734 < 3) && (dVar8 = (double)Rand(), dVar8 <= 0.02)) ||
        ((DAT_00120734 == 3 && (dVar8 = (double)Rand(), dVar8 <= 0.05)))) ||
       ((3 < DAT_00120734 && (dVar8 = (double)Rand(), dVar8 <= 0.08)))) {
      do {
        dVar8 = (double)Rand();
        DAT_001207e4 = (uint)(0.5 < dVar8) * 9 + 1;
        dVar8 = (double)Rand();
        DAT_001207e8 = (uint)(0.5 < dVar8) * 9 + 1;
      } while (quad[(long)DAT_001207e8 + (long)DAT_001207e4 * 0xb] != '.');
      quad[(long)DAT_001207e8 + (long)DAT_001207e4 + (long)DAT_001207e4 * 10] = 0x54;
      _DAT_001207e0 = 1;
      if (quad[12] == '.') {
        quad[12] = 'X';
      }
      if (quad[21] == '.') {
        quad[21] = 'X';
      }
      if (quad[111] == '.') {
        quad[111] = 'X';
      }
      if (quad[120] == '.') {
        quad[120] = 'X';
      }
    }
    if (99 < iVar6) {
      iVar6 = iVar6 + DAT_00120740 * -100;
      if (0 < (int)DAT_00120740) {
        lVar1 = 1;
        do {
          dropin(0x4b,&local_48,&local_44);
          *(int *)(kx + lVar1 * 4) = local_48;
          *(int *)(ky + lVar1 * 4) = local_44;
          dVar8 = (double)square((double)(DAT_00120728 - local_48));
          dVar9 = (double)square((double)(DAT_0012072c - local_44));
          dVar9 = dVar9 + dVar8;
          if (dVar9 < 0.0) {
            dVar9 = sqrt(dVar9);
          }
          else {
            dVar9 = SQRT(dVar9);
          }
          *(double *)(kavgd + lVar1 * 8) = dVar9;
          *(double *)(kdist + lVar1 * 8) = dVar9;
          dVar8 = (double)Rand();
          *(double *)(kpower + lVar1 * 8) = (double)DAT_00120734 * 25.0 + dVar8 * 150.0 + 300.0;
          lVar1 = lVar1 + 1;
        } while ((int)lVar1 <= (int)DAT_00120740);
      }
      if (DAT_00120dc8 < 1) {
        iVar3 = 1;
LAB_001078ee:
        if (iVar3 <= DAT_00120dc8) {
          quad[(long)local_44 + (long)local_48 * 0xb] = 0x43;
          dVar8 = (double)Rand();
          *(double *)(kpower + (long)(int)DAT_00120740 * 8) =
               (double)DAT_00120734 * 50.0 + dVar8 * 400.0 + 950.0;
          DAT_00120744 = 1;
        }
      }
      else {
        lVar1 = 1;
        do {
          iVar3 = (int)lVar1;
          if ((*(int *)(&DAT_00120f24 + lVar1 * 4) == DAT_00120720) &&
             (*(int *)(&DAT_00120f50 + lVar1 * 4) == DAT_00120724)) goto LAB_001078ee;
          lVar1 = lVar1 + 1;
        } while ((int)lVar1 <= DAT_00120dc8);
      }
      if (CONCAT44(DAT_00120724,DAT_00120720) == _DAT_001210f0) {
        quad[(long)(int)ky._4_4_ + (long)(int)kx._4_4_ * 0xb] = 0x53;
        dVar8 = (double)Rand();
        kpower._8_8_ = (double)DAT_00120734 * 125.0 + dVar8 * 400.0 + 1175.0;
        _DAT_001207b0 = 1;
        DAT_00120794 = 1;
      }
    }
    if ((int)(DAT_00120740 + 1) <= DAT_00120790) {
      lVar1 = (long)(int)(DAT_00120740 + 1);
      do {
        dropin(0x52,&local_48,&local_44);
        *(int *)(kx + lVar1 * 4) = local_48;
        *(int *)(ky + lVar1 * 4) = local_44;
        dVar8 = (double)square((double)(DAT_00120728 - local_48));
        dVar9 = (double)square((double)(DAT_0012072c - local_44));
        dVar9 = dVar9 + dVar8;
        if (dVar9 < 0.0) {
          dVar9 = sqrt(dVar9);
        }
        else {
          dVar9 = SQRT(dVar9);
        }
        *(double *)(kavgd + lVar1 * 8) = dVar9;
        *(double *)(kdist + lVar1 * 8) = dVar9;
        dVar8 = (double)Rand();
        *(double *)(kpower + lVar1 * 8) = (double)DAT_00120734 * 50.0 + dVar8 * 400.0 + 450.0;
        lVar1 = lVar1 + 1;
      } while ((int)lVar1 <= DAT_00120790);
    }
    sortkl();
    if (9 < iVar6) {
      iVar6 = iVar6 + -10;
      dropin(0x42,&DAT_00120738);
    }
    if (iVar5 % 10 != 0) {
      if (DAT_0012078c < 1) {
        iVar5 = 1;
LAB_00107b5e:
        if (iVar5 <= DAT_0012078c) {
          DAT_00120784 = iVar5;
          dropin(0x50,&DAT_00120774);
        }
      }
      else {
        piVar2 = &DAT_00121120;
        iVar5 = 1;
        do {
          if ((*piVar2 == DAT_00120720) && (piVar2[1] == DAT_00120724)) goto LAB_00107b5e;
          iVar5 = iVar5 + 1;
          piVar2 = piVar2 + 5;
        } while (iVar5 <= DAT_0012078c);
      }
    }
    newcnd();
    if (0 < iVar6) {
      iVar5 = 1;
      do {
        dropin(0x2a,&local_48,&local_44);
        iVar5 = iVar5 + 1;
      } while (iVar5 <= iVar6);
    }
    if ((((0 < _DAT_0012079c) && ((DAT_00120740 | DAT_00120738) == 0)) &&
        ((DAT_00120798 = 1, DAT_00120714 == 0x44 || (DAT_00120228 <= 0.0)))) && (DAT_001207b4 == 0))
    {
      skip(1);
      prout("LT. UHURA- \"Captain, an urgent message.");
      prout("  I\'ll put it on audio.\"  CLICK");
      skip(1);
      prout("INTRUDER! YOU HAVE VIOLATED THE ROMULAN NEUTRAL ZONE.");
      prout("LEAVE AT ONCE, OR YOU WILL BE DESTROYED!");
    }
    if (((param_1 == 0) && (_DAT_0012076c == DAT_00120720)) && (_DAT_00120770 == DAT_00120724)) {
      dropin(0x3f,&local_48,&local_44);
      _DAT_00120770 = 0;
      _DAT_0012076c = 0;
      if (DAT_001201e8 == 0.0) {
        skip(1);
        prout("MR. SPOCK- \"Captain, this is most unusual.");
        prout("    Please examine your short-range scan.\"");
      }
    }
    iVar6 = 3;
    do {
      dVar8 = (double)Rand();
      if (0.5 < dVar8) {
        dropin(0x20,&local_48,&local_44);
      }
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
    if (_DAT_001207e0 != 0) {
      if (quad[12] == 'X') {
        quad[12] = '.';
      }
      if (quad[21] == 'X') {
        quad[21] = '.';
      }
      if (quad[111] == 'X') {
        quad[111] = '.';
      }
      if (quad[120] == 'X') {
        quad[120] = '.';
      }
    }
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void abandn(void)

{
  int iVar1;
  undefined8 *puVar2;
  double dVar3;
  
  chew();
  if (DAT_00120714 == 0x44) {
    if (DAT_0012071c == 0x45) {
LAB_00107df9:
      DAT_0012071c = 0x46;
      quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = 0x46;
      prout("Starfleet puts you in command of another ship,");
      prout("the Faerie Queene, which is antiquated but,");
      prout("still useable.");
      if (_DAT_001207cc != 0) {
        prout("The dilithium crystals have been moved.");
      }
      _DAT_00120788 = 0;
      DAT_001207a8 = 0;
      DAT_001207c4 = 300;
      DAT_001211ec = 300;
      DAT_001207b8 = 0;
      DAT_001207b4 = 0;
      DAT_00120714 = 0x44;
      puVar2 = &DAT_001201e8;
      do {
        *puVar2 = 0;
        puVar2 = puVar2 + 1;
      } while (puVar2 != &DAT_00120268);
      DAT_00120230 = -1.0;
      DAT_00120818 = 0x40a7700000000000;
      DAT_00120838 = 0x40a7700000000000;
      DAT_00120820 = 0x4093880000000000;
      DAT_00120840 = 0x4093880000000000;
      DAT_00120710 = 6;
      DAT_00120718 = 6;
      DAT_00120828 = 0x4008000000000000;
      DAT_00120860 = 0x4008000000000000;
      DAT_00120848 = 0;
      DAT_00120850 = 0x4014000000000000;
      DAT_00120858 = 0x4039000000000000;
    }
    else {
      prout("You cannot abandon Ye Faerie Queene.");
    }
  }
  else if (DAT_00120230 == -1.0) {
    prout("Ye Faerie Queene has no shuttle craft.");
  }
  else if (DAT_00120230 < 0.0) {
    prout("Shuttle craft now serving Big Mac\'s.");
  }
  else if (0.0 < DAT_00120230) {
    prout("Shuttle craft damaged.");
  }
  else if (DAT_00120780 == 1) {
    prout("You must be aboard the Enterprise.");
  }
  else if (DAT_001207a8 == 1) {
    skip(1);
    prouts("***ABANDON SHIP!  ABANDON SHIP!");
    skip(1);
    prouts("***ALL HANDS ABANDON SHIP!");
    skip(2);
    prout("Captain and crew escape in shuttle craft.");
    prout("Remainder of ship\'s complement beam down");
    prout("to nearest habitable planet.");
    if (DAT_00120dcc != 0) {
      skip(1);
      _DAT_001207cc = 0;
      DAT_00120800 = 0;
      prout("You are captured by Klingons and released to");
      prout("the Federation in a prisoner-of-war exchange.");
      dVar3 = (double)Rand();
      iVar1 = (int)((double)DAT_00120dcc * dVar3 + 1.0);
      if ((DAT_00120720 != (&DAT_00120f7c)[iVar1]) || (DAT_00120724 != (&DAT_00120f94)[iVar1])) {
        DAT_00120724 = (&DAT_00120f94)[iVar1];
        DAT_0012072c = 5;
        DAT_00120728 = 5;
        DAT_00120720 = (&DAT_00120f7c)[iVar1];
        newqad(1);
      }
      do {
        quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = 0x2e;
        iVar1 = 1;
        do {
          dVar3 = (double)Rand();
          DAT_00120728 = (int)((dVar3 * 3.0 - 1.0) + (double)DAT_00120738);
          dVar3 = (double)Rand();
          DAT_0012072c = (int)((dVar3 * 3.0 - 1.0) + (double)DAT_0012073c);
          if (((DAT_00120728 - 1U < 10) && (DAT_0012072c - 1U < 10)) &&
             (quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] == '.')) {
            if (iVar1 < 0xb) goto LAB_00107df9;
            break;
          }
          iVar1 = iVar1 + 1;
        } while (iVar1 != 0xb);
        DAT_00120728 = 5;
        DAT_0012072c = 5;
        newqad(1);
      } while( true );
    }
    finish(8);
  }
  else {
    prout("Shuttle craft not currently available.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void setup(void)

{
  int iVar1;
  undefined8 *puVar2;
  long lVar3;
  long lVar4;
  undefined *puVar5;
  undefined *puVar6;
  undefined4 extraout_var;
  undefined4 uVar7;
  undefined4 extraout_var_00;
  int iVar8;
  undefined *puVar9;
  int *piVar10;
  int iVar11;
  int iVar12;
  long in_FS_OFFSET;
  double dVar13;
  double dVar14;
  double dVar15;
  long local_50;
  int local_48;
  int local_44;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  DAT_00120758 = 0;
  DAT_00120764 = 0;
  iVar1 = choose();
  if (iVar1 == 0) {
    DAT_0012071c = 0x45;
    DAT_00120818 = 0x40b3880000000000;
    DAT_00120838 = 0x40b3880000000000;
    DAT_00120820 = 0x40a3880000000000;
    DAT_00120840 = 0x40a3880000000000;
    DAT_00120848 = 0;
    _DAT_00120768 = 0;
    DAT_00120828 = 0x4010000000000000;
    DAT_00120860 = 0x4010000000000000;
    iran8(&DAT_00120720);
    iran10(&DAT_00120728);
    DAT_00120710 = 10;
    DAT_00120718 = 10;
    dVar13 = (double)Rand();
    DAT_00120800 = (int)(dVar13 * 3.0 + 2.0);
    DAT_00120850 = 0x4014000000000000;
    DAT_00120858 = 0x4039000000000000;
    puVar2 = &damage;
    do {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    } while (puVar2 != &DAT_00120268);
    DAT_001207dc = 0;
    DAT_001207d8 = 0;
    dVar13 = (double)Rand();
    dVar13 = (double)(int)(dVar13 * 31.0 + 20.0) * 100.0;
    DAT_001210fc = 0;
    DAT_00120748 = 0;
    DAT_00120888 = 0;
    DAT_0012074c = 0;
    DAT_00120750 = 0;
    DAT_00120ddc = 0;
    DAT_00120dd8 = 0;
    DAT_00120dd0 = 0;
    DAT_00121108 = 0;
    DAT_00121104 = 0;
    _DAT_001207a0 = 0;
    _DAT_001207cc = 0;
    _DAT_00120788 = 0;
    _DAT_001207b0 = 0;
    DAT_001207ac = 0;
    DAT_001207a8 = 1;
    DAT_00120780 = 0xffffffff;
    _DAT_0012075c = 1;
    DAT_00120880 = 0x3fd0000000000000;
    puVar6 = (undefined *)0x120504;
    puVar9 = &DAT_00120de4;
    puVar5 = &DAT_00120de4;
    DAT_00120830 = dVar13;
    DAT_001211f0 = dVar13;
    do {
      lVar3 = 0;
      do {
        *(undefined4 *)(puVar6 + lVar3 + 4) = 0;
        *(undefined4 *)(puVar5 + lVar3 + 0x1f0) = 0;
        lVar3 = lVar3 + 4;
      } while (lVar3 != 0x20);
      puVar6 = puVar6 + 0x24;
      puVar5 = puVar5 + 0x24;
    } while (puVar6 != &DAT_00120624);
    dVar14 = (double)expran(DAT_00120810 * 0.5);
    dVar15 = DAT_001211f0;
    future._8_8_ = dVar13 + dVar14;
    dVar13 = (double)expran((DAT_00120810 / (double)DAT_00120dc8) * 1.5);
    future._16_8_ = dVar15 + dVar13;
    dVar15 = DAT_001211f0 + 1.0;
    dVar14 = (double)Rand();
    dVar13 = DAT_001211f0;
    future._24_8_ = dVar14 + dVar15;
    dVar15 = (double)expran(DAT_00120810 * 0.3);
    future._32_8_ = dVar13 + dVar15;
    future._40_8_ = 0x46293e5939a08cea;
    future._48_8_ = 1e+30;
    if (_DAT_001210f8 != 0) {
      future._48_8_ = DAT_001211f0 + 0.2777;
    }
    future._56_8_ = 0x46293e5939a08cea;
    future._64_8_ = 0x46293e5939a08cea;
    DAT_00120898 = 0x46293e5939a08cea;
    _DAT_0012070c = 0;
    do {
      lVar3 = 0;
      do {
        dVar13 = (double)Rand();
        iVar1 = (int)(dVar13 * 9.0 + 1.0);
        _DAT_0012070c = _DAT_0012070c + iVar1;
        *(int *)(puVar9 + lVar3 * 4 + 0x24) = iVar1;
        lVar3 = lVar3 + 1;
      } while (lVar3 != 8);
      puVar9 = puVar9 + 0x24;
    } while (puVar9 != &DAT_00120f04);
    if (0 < DAT_00120704) {
      puVar5 = (undefined *)0x120dc4;
      local_50 = 0;
      do {
        lVar3 = local_50 + 1;
        while( true ) {
          do {
            iran8(&local_48,&local_44);
          } while (9 < *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4));
          puVar6 = puVar5;
          if ((int)local_50 < 1) break;
          while( true ) {
            dVar13 = (double)square((double)(local_48 - *(int *)(puVar6 + 0x1b8)));
            dVar15 = (double)square((double)(local_44 - *(int *)(puVar6 + 0x1d0)));
            if ((dVar15 + dVar13 < (double)(6 - DAT_00120704) * 6.0) &&
               (dVar13 = (double)Rand(), dVar13 < 0.75)) break;
            puVar6 = puVar6 + -4;
            if (puVar6 == &DAT_00120dbc + (lVar3 - (ulong)((int)local_50 - 1)) * 4)
            goto LAB_00108c55;
          }
        }
LAB_00108c55:
        *(int *)(puVar5 + 0x1bc) = local_48;
        *(int *)(puVar5 + 0x1d4) = local_44;
        lVar4 = (long)local_48 * 9 + (long)local_44;
        *(undefined4 *)(starch + lVar4 * 4) = 0xffffffff;
        *(int *)(&DAT_00120de0 + lVar4 * 4) = *(int *)(&DAT_00120de0 + lVar4 * 4) + 10;
        puVar5 = puVar5 + 4;
        local_50._0_4_ = (int)lVar3;
        iVar1 = (int)local_50 + 1;
        local_50 = lVar3;
      } while (iVar1 <= DAT_00120704);
    }
    iVar12 = (a - _DAT_00120708) - _DAT_001210f8;
    iVar1 = (int)((double)DAT_00120734 * 0.25 * (9.0 - (double)DAT_00120730) + 1.0);
    if (9 < iVar1) {
      iVar1 = 9;
    }
    do {
      dVar13 = (double)Rand();
      iVar8 = (int)((double)iVar1 * (1.0 - dVar13 * dVar13));
      if (iVar12 < iVar8) {
        iVar8 = iVar12;
      }
      iVar12 = iVar12 - iVar8;
      do {
        iran8(&local_48,&local_44);
        iVar11 = iVar8 * 100 + *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4);
      } while (999 < iVar11);
      *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4) = iVar11;
    } while (0 < iVar12);
    lVar3 = 1;
    if (0 < _DAT_00120708) {
LAB_00108ae3:
      do {
        do {
          iran8(&local_48,&local_44);
          if (*(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4) < 99) {
            dVar13 = (double)Rand();
            if (dVar13 < 0.75) goto LAB_00108ae3;
          }
          iVar1 = *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4);
        } while (899 < iVar1);
        iVar12 = (int)lVar3;
        if (1 < iVar12) {
          lVar4 = 1;
          do {
            if ((local_48 == *(int *)(&DAT_00120f24 + lVar4 * 4)) &&
               (local_44 == *(int *)(&DAT_00120f50 + lVar4 * 4))) {
              if ((int)lVar4 < iVar12) goto LAB_00108ae3;
              break;
            }
            lVar4 = lVar4 + 1;
          } while (lVar4 != (ulong)(iVar12 - 2) + 2);
        }
        *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4) = iVar1 + 100;
        *(int *)(&DAT_00120f24 + lVar3 * 4) = local_48;
        *(int *)(&DAT_00120f50 + lVar3 * 4) = local_44;
        lVar3 = lVar3 + 1;
      } while ((int)lVar3 <= _DAT_00120708);
    }
    if (0 < DAT_0012078c) {
      piVar10 = &DAT_00121120;
      iVar1 = 1;
      do {
        do {
          iran8(&local_48,&local_44);
        } while (0 < (int)(&DAT_00120dcc)[(long)local_44 + 0x78 + (long)local_48 * 9]);
        (&DAT_00120dcc)[(long)local_44 + 0x78 + (long)local_48 * 9] = 1;
        *piVar10 = local_48;
        piVar10[1] = local_44;
        dVar13 = (double)Rand();
        piVar10[2] = (int)(dVar13 * 3.0 + 1.0);
        dVar13 = (double)Rand();
        piVar10[3] = (int)(dVar13 * 1.5);
        piVar10[4] = 0;
        iVar1 = iVar1 + 1;
        piVar10 = piVar10 + 5;
      } while (iVar1 <= DAT_0012078c);
    }
    if (0 < DAT_00121100) {
      iVar1 = 1;
      do {
        iran8(&local_48,&local_44);
        (&DAT_00120dcc)[(long)local_44 + 0x78 + (long)local_48 * 9] =
             (&DAT_00120dcc)[(long)local_44 + 0x78 + (long)local_48 * 9] + 10;
        iVar1 = iVar1 + 1;
      } while (iVar1 <= DAT_00121100);
    }
    if (0 < _DAT_001210f8) {
      do {
        iran8(&local_48,&local_44);
        iVar1 = *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4);
      } while (899 < iVar1);
      DAT_001210f0 = local_48;
      DAT_001210f4 = local_44;
      *(int *)((long)&d + ((long)local_44 + 8 + (long)local_48 * 9) * 4) = iVar1 + 100;
    }
    dVar13 = (double)Rand();
    if ((0.1 <= dVar13) || (_DAT_0012076c == -1)) {
      _DAT_00120770 = 0;
      _DAT_0012076c = 0;
    }
    else {
      iran8(&DAT_0012076c);
    }
    skip(3);
    d._0_4_ = 0;
    if (DAT_00120734 == 1) {
      __printf_chk(1,"It is stardate %d. The Federation is being attacked by\n",(int)DAT_001211f0);
      __printf_chk(1,
                   "a deadly Klingon invasion force. As captain of the United\nStarship U.S.S. Enterprise, it is your mission to seek out\nand destroy this invasion force of %d battle cruisers.\n"
                   ,a);
      __printf_chk(1,
                   "You have an initial allotment of %d stardates to complete\nyour mission.  As you proceed you may be given more time.\n\nYou will have %d supporting starbases.\nStarbase locations-  "
                   ,(int)DAT_00120810,DAT_00120704);
    }
    else {
      __printf_chk(1,"Stardate %d.\n\n%d Klingons,\nan unknown number of Romulans\n",
                   (int)DAT_001211f0,a);
      uVar7 = extraout_var;
      if (_DAT_001210f8 != 0) {
        puts("and one (GULP) Super-Commander.");
        uVar7 = extraout_var_00;
      }
      __printf_chk(1,"%d stardates\n%d starbases in  ",CONCAT44(uVar7,(int)DAT_00120810),
                   DAT_00120704);
    }
    lVar3 = 1;
    if (0 < DAT_00120704) {
      do {
        cramlc(0,(&DAT_00120f7c)[lVar3],(&DAT_00120f94)[lVar3]);
        if ((int)lVar3 < DAT_00120704) {
          proutn("  ");
        }
        lVar3 = lVar3 + 1;
      } while ((int)lVar3 <= DAT_00120704);
    }
    skip(2);
    proutn("The Enterprise is currently in");
    cramlc(1,DAT_00120720,DAT_00120724);
    proutn(" ");
    cramlc(2,DAT_00120728,DAT_0012072c);
    skip(2);
    prout("Good Luck!");
    if (_DAT_001210f8 != 0) {
      proutn("  YOU\'LL NEED IT.");
    }
    skip(1);
    newqad(0);
    if (DAT_00120790 != 0) {
      DAT_00120848 = 0x3ff0000000000000;
    }
    if (DAT_00120798 != 0) {
      attack(0);
    }
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
}



void randomize(void)

{
  time_t tVar1;
  
  tVar1 = time((time_t *)0x0);
  srand((uint)tVar1);
  return;
}



int max(int param_1,int param_2)

{
  if (param_2 <= param_1) {
    param_2 = param_1;
  }
  return param_2;
}



int min(int param_1,int param_2)

{
  if (param_1 <= param_2) {
    param_2 = param_1;
  }
  return param_2;
}



int getch(void)

{
  long in_FS_OFFSET;
  undefined local_98 [50];
  cc_t cStack_66;
  cc_t cStack_65;
  cc_t cStack_64;
  cc_t cStack_63;
  cc_t cStack_62;
  cc_t cStack_61;
  speed_t local_60;
  undefined local_58 [49];
  undefined uStack_27;
  undefined uStack_26;
  undefined uStack_25;
  undefined4 uStack_24;
  speed_t local_20;
  char local_11;
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  fflush(stdout);
  tcgetattr(0,(termios *)local_98);
  local_58._0_4_ = local_98._0_4_;
  local_58._4_4_ = local_98._4_4_;
  local_58._8_4_ = local_98._8_4_;
  local_58[16] = local_98[16];
  local_58[17] = local_98[17];
  local_58[18] = local_98[18];
  local_58[19] = local_98[19];
  local_58[20] = local_98[20];
  local_58[21] = local_98[21];
  local_58[22] = local_98[22];
  local_58[23] = local_98[23];
  local_58[24] = local_98[24];
  local_58[25] = local_98[25];
  local_58[26] = local_98[26];
  local_58[27] = local_98[27];
  local_58[28] = local_98[28];
  local_58[29] = local_98[29];
  local_58[30] = local_98[30];
  local_58[31] = local_98[31];
  local_58[32] = local_98[32];
  local_58[33] = local_98[33];
  local_58[34] = local_98[34];
  local_58[35] = local_98[35];
  local_58[36] = local_98[36];
  local_58[37] = local_98[37];
  local_58[38] = local_98[38];
  local_58[39] = local_98[39];
  local_58[40] = local_98[40];
  local_58[41] = local_98[41];
  local_58[42] = local_98[42];
  local_58[43] = local_98[43];
  local_58[44] = local_98[44];
  local_58[45] = local_98[45];
  local_58[46] = local_98[46];
  local_58[47] = local_98[47];
  local_58[48] = local_98[48];
  uStack_27 = local_98[49];
  uStack_26 = cStack_66;
  uStack_25 = cStack_65;
  uStack_24._0_1_ = cStack_64;
  uStack_24._1_1_ = cStack_63;
  uStack_24._2_1_ = cStack_62;
  uStack_24._3_1_ = cStack_61;
  local_20 = local_60;
  local_58._12_4_ = local_98._12_4_ & 0xfffffff5;
  tcsetattr(0,0,(termios *)local_58);
  read(0,&local_11,1);
  tcsetattr(0,0,(termios *)local_98);
  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {
    return (int)local_11;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void getcd(int param_1,int param_2)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  double dVar5;
  double dVar6;
  double dVar7;
  int local_48;
  int local_44;
  
  local_48 = DAT_00120720;
  local_44 = DAT_00120724;
  DAT_00120870 = -1.0;
  if ((DAT_00120780 == 1) && (param_1 == 0)) {
    prout("Dummy! You can\'t leave standard orbit until you");
    proutn("are back aboard the ");
    crmshp();
    prout(".");
    chew();
  }
  else {
    bVar2 = false;
    if (DAT_00120238 == 0.0) {
LAB_00108f18:
      if ((param_1 == 0) || (param_2 == -1)) {
        iVar3 = scan();
      }
      else {
        iVar3 = param_2;
        param_2 = -1;
      }
      if (iVar3 == 0) goto code_r0x00108eee;
      if (iVar3 == 1) {
        iVar3 = isit("manual");
        if (iVar3 != 0) {
          iVar3 = scan();
          goto joined_r0x00108f61;
        }
        iVar3 = isit("automatic");
        if (iVar3 == 0) {
          huh();
          chew();
          return;
        }
        iVar3 = scan();
        if (iVar3 == 0) {
          do {
            if (param_1 == 0) {
              proutn("Destination sector or quadrant&sector- ");
            }
            else {
              proutn("Target quadrant or quadrant&sector- ");
            }
            chew();
            iVar3 = scan();
          } while (iVar3 == 0);
          bVar2 = true;
        }
        dVar7 = aaitem;
        if (iVar3 != 2) {
          huh();
          return;
        }
        iVar3 = scan();
        dVar5 = aaitem;
        if (iVar3 != 2) {
          huh();
          return;
        }
        iVar3 = scan();
        dVar6 = aaitem;
        if (iVar3 == 2) {
          iVar3 = scan();
          if (iVar3 != 2) {
            huh();
            return;
          }
          local_48 = (int)(dVar7 + 0.5);
          local_44 = (int)(dVar5 + 0.5);
          iVar4 = (int)(dVar6 + 0.5);
          iVar3 = (int)(aaitem + 0.5);
          bVar1 = false;
        }
        else {
          bVar1 = true;
          if (param_1 == 0) {
            iVar4 = (int)(dVar7 + 0.5);
            iVar3 = (int)(dVar5 + 0.5);
          }
          else {
            local_48 = (int)(dVar7 + 0.5);
            local_44 = (int)(dVar5 + 0.5);
            iVar3 = 5;
            iVar4 = 5;
          }
        }
        if ((((7 < local_48 - 1U) || (7 < local_44 - 1U)) || (9 < iVar4 - 1U)) || (9 < iVar3 - 1U))
        {
          huh();
          return;
        }
        skip(1);
        if (param_1 == 0) {
          if (bVar1) {
            if (bVar2) {
              proutn("Helmsman Sulu- \"Course locked in for");
              cramlc(2,iVar4,iVar3);
              prout(&DAT_0011ba37);
            }
          }
          else {
            prout("Ensign Chekov- \"Course laid in, Captain.\"");
          }
        }
        dVar7 = (double)(iVar3 - DAT_0012072c) * 0.1 + (double)(local_44 - DAT_00120724);
        dVar5 = (double)(DAT_00120728 - iVar4) * 0.1 + (double)(DAT_00120720 - local_48);
        if ((dVar5 != 0.0) || (dVar7 != 0.0)) goto LAB_001092ae;
        goto LAB_001091df;
      }
      if (param_1 == 0) {
        prout("(Manual movement assumed.)");
      }
      else {
        prout("(Manual navigation assumed.)");
      }
      goto LAB_00108e88;
    }
LAB_00108e53:
    if (param_1 == 0) {
      prout("Computer damaged; manual movement only");
    }
    else {
      prout("Computer damaged; manual navigation only");
    }
    chew();
    do {
      proutn("X and Y displacements- ");
      chew();
      iVar3 = scan();
joined_r0x00108f61:
    } while (iVar3 == 0);
LAB_00108e88:
    dVar7 = aaitem;
    if (iVar3 == 2) {
      iVar3 = scan();
      if (iVar3 == 0) {
        dVar6 = 0.0;
      }
      else {
        dVar6 = aaitem;
        if (iVar3 != 2) {
          huh();
          return;
        }
      }
      dVar5 = dVar6;
      if (coordfixed != 0) {
        dVar5 = (double)((ulong)dVar7 ^ 0x8000000000000000);
        dVar7 = dVar6;
      }
      if ((dVar7 == 0.0) && (dVar5 == 0.0)) {
LAB_001091df:
        chew();
      }
      else {
        if (param_1 == 0) {
          skip(1);
          prout("Helmsman Sulu- \"Aye, Sir.\"");
        }
LAB_001092ae:
        dVar6 = dVar7 * dVar7 + dVar5 * dVar5;
        if (dVar6 < 0.0) {
          DAT_00120868 = sqrt(dVar6);
        }
        else {
          DAT_00120868 = SQRT(dVar6);
        }
        dVar7 = atan2(dVar7,dVar5);
        DAT_00120870 = dVar7 * 1.90985932;
        if (DAT_00120870 < 0.0) {
          DAT_00120870 = DAT_00120870 + 12.0;
        }
        chew();
      }
    }
    else {
      huh();
    }
  }
  return;
code_r0x00108eee:
  proutn("Manual or automatic- ");
  chew();
  bVar2 = true;
  if (DAT_00120238 != 0.0) goto LAB_00108e53;
  goto LAB_00108f18;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void lmove(void)

{
  uint uVar1;
  char cVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  ulong uVar9;
  int unaff_EBP;
  int iVar10;
  int iVar11;
  int unaff_R12D;
  double dVar12;
  double dVar13;
  double dVar14;
  double dVar15;
  double local_70;
  double local_68;
  double local_48;
  double local_40 [2];
  
  if (DAT_0012077c != 0) {
    prout("SULU- \"Leaving standard orbit.\"");
    DAT_0012077c = 0;
  }
  sincos((15.0 - DAT_00120870) * 0.5235988,local_40,&local_48);
  dVar14 = (double)((ulong)local_40[0] & 0x7fffffffffffffff);
  if ((double)((ulong)local_40[0] & 0x7fffffffffffffff) <=
      (double)((ulong)local_48 & 0x7fffffffffffffff)) {
    dVar14 = (double)((ulong)local_48 & 0x7fffffffffffffff);
  }
  if ((DAT_001207b4 != 0) && (dVar12 = DAT_001211f0 + DAT_00120878, (double)future._16_8_ <= dVar12)
     ) {
    dVar15 = (double)expran((DAT_00120810 * 1.5) / (double)DAT_00120dc8);
    future._16_8_ = dVar15 + dVar12;
  }
  iVar10 = DAT_0012072c;
  iVar8 = DAT_00120728;
  bVar5 = (double)future._16_8_ <= DAT_001211f0 + DAT_00120878;
  if (bVar5) {
    DAT_00120714 = 0x52;
    DAT_00120868 = (((double)future._16_8_ - DAT_001211f0) * DAT_00120868) / DAT_00120878 + 0.1;
    DAT_00120878 = ((double)future._16_8_ - DAT_001211f0) + 1e-05;
  }
  quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = 0x2e;
  dVar15 = DAT_00120878;
  dVar12 = DAT_00120868;
  iVar11 = (int)(DAT_00120868 * 10.0 * dVar14 + 0.5);
  if (0 < iVar11) {
    local_48 = local_48 / dVar14;
    dVar13 = (double)((ulong)local_40[0] ^ 0x8000000000000000) / dVar14;
    local_70 = (double)iVar8;
    local_68 = (double)iVar10;
    iVar7 = 1;
    do {
      local_70 = local_70 + dVar13;
      unaff_EBP = (int)(local_70 + 0.5);
      local_68 = local_68 + local_48;
      unaff_R12D = (int)(local_68 + 0.5);
      if ((9 < unaff_EBP - 1U) || (9 < unaff_R12D - 1U)) {
        if ((DAT_00120790 != 0) && ((_DAT_001207c8 != 2 && (DAT_001207b4 == 0)))) {
          newcnd();
          if (0 < DAT_00120790) {
            uVar1 = DAT_00120790 + 1;
            uVar9 = 1;
            do {
              dVar12 = (double)(unaff_EBP - *(int *)(kx + uVar9 * 4)) *
                       (double)(unaff_EBP - *(int *)(kx + uVar9 * 4)) +
                       (double)(unaff_R12D - *(int *)(ky + uVar9 * 4)) *
                       (double)(unaff_R12D - *(int *)(ky + uVar9 * 4));
              if (dVar12 < 0.0) {
                dVar12 = sqrt(dVar12);
              }
              else {
                dVar12 = SQRT(dVar12);
              }
              *(double *)(kavgd + uVar9 * 8) = (dVar12 + *(double *)(kdist + uVar9 * 8)) * 0.5;
              uVar9 = uVar9 + 1;
            } while (uVar1 != uVar9);
          }
          if (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) != 1000) {
            attack(0);
          }
          if (DAT_00120764 != 0) {
            return;
          }
        }
        dVar14 = DAT_00120868 * 10.0 * dVar14;
        iVar8 = (int)((double)(DAT_00120728 + (DAT_00120720 * 5 + -5) * 2) + dVar13 * dVar14 + 0.5);
        iVar10 = (int)(dVar14 * local_48 + (double)(DAT_0012072c + (DAT_00120724 * 5 + -5) * 2) +
                      0.5);
        bVar6 = false;
        do {
          bVar3 = iVar8 < 1;
          if (bVar3) {
            iVar8 = 1 - iVar8;
          }
          bVar4 = iVar10 < 1;
          if (bVar4) {
            iVar10 = 1 - iVar10;
          }
          if (iVar8 < 0x51) {
            if (0x50 < iVar10) goto LAB_00109927;
            if (!bVar4 && !bVar3) {
              if (bVar6) {
                DAT_00120750 = DAT_00120750 + 1;
                if (DAT_00120750 == 3) {
                  finish(5);
                  return;
                }
                prout(
                     "\nYOU HAVE ATTEMPTED TO CROSS THE NEGATIVE ENERGY BARRIER\nAT THE EDGE OF THE GALAXY.  THE THIRD TIME YOU TRY THIS,\nYOU WILL BE DESTROYED.\n"
                     );
              }
              if (bVar5) {
                return;
              }
              iVar11 = (iVar8 + 9) / 10;
              iVar7 = (iVar10 + 9) / 10;
              DAT_00120728 = (iVar11 + -1) * -10 + iVar8;
              DAT_0012072c = (iVar7 + -1) * -10 + iVar10;
              if ((iVar11 == DAT_00120720) && (iVar7 == DAT_00120724)) {
                DAT_00120720 = iVar11;
                DAT_00120724 = iVar7;
                prout("(Negative energy barrier disturbs quadrant.)");
              }
              else {
                DAT_00120720 = iVar11;
                DAT_00120724 = iVar7;
                proutn("\nEntering");
                cramlc(1,DAT_00120720,DAT_00120724);
              }
              skip(1);
              quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = (char)DAT_0012071c;
              newqad(0);
              return;
            }
          }
          else {
            iVar8 = 0xa1 - iVar8;
            if (0x50 < iVar10) {
LAB_00109927:
              iVar10 = 0xa1 - iVar10;
            }
          }
          bVar6 = true;
        } while( true );
      }
      cVar2 = quad[(long)unaff_R12D + (long)unaff_EBP * 0xb];
      if (cVar2 != '.') {
        dVar14 = (double)(iVar8 - unaff_EBP) * (double)(iVar8 - unaff_EBP) +
                 (double)(iVar10 - unaff_R12D) * (double)(iVar10 - unaff_R12D);
        if (dVar14 < 0.0) {
          dVar14 = sqrt(dVar14);
        }
        else {
          dVar14 = SQRT(dVar14);
        }
        DAT_00120868 = dVar14 * 0.1;
        if (cVar2 == 'C') {
LAB_00109b57:
          DAT_00120728 = unaff_EBP;
          DAT_0012072c = unaff_R12D;
          ram(0,(int)cVar2,unaff_EBP,unaff_R12D);
        }
        else {
          if (cVar2 < 'D') {
            if (cVar2 == ' ') {
              skip(1);
              prouts("***RED ALERT!  RED ALERT!");
              skip(1);
              proutn("***");
              crmshp();
              proutn(" pulled into black hole at");
              cramlc(2,unaff_EBP,unaff_R12D);
              skip(1);
              finish(0x14);
              return;
            }
          }
          else if ((cVar2 == 'K') || ((byte)(cVar2 + 0xaeU) < 3)) goto LAB_00109b57;
          skip(1);
          crmshp();
          if (cVar2 == 0x23) {
            proutn(" encounters Tholian web at");
          }
          else {
            proutn(" blocked by object at");
          }
          dVar15 = (dVar12 * 50.0) / dVar15;
          cramlc(2,unaff_EBP,unaff_R12D);
          prout(";");
          proutn("Emergency stop required ");
          cramf(dVar15,0,2);
          prout(" units of energy.");
          DAT_00120838 = DAT_00120838 - dVar15;
          DAT_00120728 = (int)((local_70 - dVar13) + 0.5);
          DAT_0012072c = (int)((local_68 - local_48) + 0.5);
          if (DAT_00120838 <= 0.0) {
            finish(3);
            return;
          }
        }
        goto LAB_001095dc;
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 <= iVar11);
    dVar14 = (double)(iVar8 - unaff_EBP) * (double)(iVar8 - unaff_EBP) +
             (double)(iVar10 - unaff_R12D) * (double)(iVar10 - unaff_R12D);
    if (dVar14 < 0.0) {
      dVar14 = sqrt(dVar14);
    }
    else {
      dVar14 = SQRT(dVar14);
    }
    DAT_00120868 = dVar14 * 0.1;
    DAT_00120728 = unaff_EBP;
    DAT_0012072c = unaff_R12D;
  }
LAB_001095dc:
  quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = (char)DAT_0012071c;
  if (DAT_00120790 != 0) {
    if (0 < DAT_00120790) {
      uVar1 = DAT_00120790 + 1;
      uVar9 = 1;
      do {
        dVar14 = (double)(unaff_EBP - *(int *)(kx + uVar9 * 4)) *
                 (double)(unaff_EBP - *(int *)(kx + uVar9 * 4)) +
                 (double)(unaff_R12D - *(int *)(ky + uVar9 * 4)) *
                 (double)(unaff_R12D - *(int *)(ky + uVar9 * 4));
        if (dVar14 < 0.0) {
          dVar14 = sqrt(dVar14);
        }
        else {
          dVar14 = SQRT(dVar14);
        }
        *(double *)(kavgd + uVar9 * 8) = (dVar14 + *(double *)(kdist + uVar9 * 8)) * 0.5;
        *(double *)(kdist + uVar9 * 8) = dVar14;
        uVar9 = uVar9 + 1;
      } while (uVar9 != uVar1);
    }
    sortkl();
    if ((*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) != 1000) &&
       (_DAT_001207c8 == 0)) {
      attack(0);
    }
    if (0 < DAT_00120790) {
      uVar1 = DAT_00120790 + 1;
      uVar9 = 1;
      do {
        *(undefined8 *)(kavgd + uVar9 * 8) = *(undefined8 *)(kdist + uVar9 * 8);
        uVar9 = uVar9 + 1;
      } while (uVar9 != uVar1);
    }
  }
  newcnd();
  _DAT_001207c8 = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void dock(void)

{
  int iVar1;
  
  chew();
  if (DAT_00120714 == 0x44) {
    prout("Already docked.");
  }
  else if (DAT_0012077c == 0) {
    if (DAT_00120738 != 0) {
      iVar1 = DAT_00120728 - DAT_00120738;
      if (iVar1 < 1) {
        iVar1 = -iVar1;
      }
      if (iVar1 < 2) {
        iVar1 = DAT_0012072c - DAT_0012073c;
        if (iVar1 < 1) {
          iVar1 = -iVar1;
        }
        if (iVar1 < 2) {
          if (DAT_001207b4 != 0) {
            prout("You cannot dock while cloaked.");
            return;
          }
          DAT_00120714 = 0x44;
          prout("Docked.");
          if (DAT_00120838 < DAT_00120818) {
            DAT_00120838 = DAT_00120818;
          }
          DAT_00120840 = DAT_00120820;
          DAT_00120718 = DAT_00120710;
          DAT_00120860 = DAT_00120828;
          if (0 < DAT_001207c4 - DAT_001211ec) {
            __printf_chk(1,"%d captured Klingons transferred to base.\n");
            DAT_001211e8 = DAT_001211e8 + (DAT_001207c4 - DAT_001211ec);
            DAT_001211ec = DAT_001207c4;
          }
          if (DAT_00120898 == 1e+30) {
            return;
          }
          if ((1e+30 <= (double)future._40_8_) && (DAT_001207ac != 1)) {
            return;
          }
          if (_DAT_001207ec != 0) {
            return;
          }
          prout("Lt. Uhura- \"Captain, an important message from the starbase:\"");
          attakreport();
          _DAT_001207ec = 1;
          return;
        }
      }
    }
    crmshp();
    prout(" not adjacent to base.");
  }
  else {
    prout("You must first leave standard orbit.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void impuls(void)

{
  int iVar1;
  double dVar2;
  
  DAT_00120754 = 0;
  if (_DAT_00120218 == 0.0) {
    if (30.0 < DAT_00120838) {
      getcd(0,0);
      if (DAT_00120870 == -1.0) {
        return;
      }
      dVar2 = DAT_00120868 * 100.0 + 20.0;
    }
    else {
      dVar2 = 30.0;
    }
    if (DAT_00120838 <= dVar2) {
      skip(1);
      prout("First Officer Spock- \"Captain, the impulse engines");
      prout("require 20.0 units to engage, plus 100.0 units per");
      if (DAT_00120838 <= 30.0) {
        prout("quadrant.  They are, therefore, useless.\"");
      }
      else {
        proutn("quadrant.  We can go, therefore, a maximum of ");
        cramf((DAT_00120838 - 20.0) * 0.01 - 0.05,0,1);
        prout(" quadrants.\"");
      }
      chew();
    }
    else {
      DAT_00120878 = DAT_00120868 / 0.095;
      if (DAT_00121200 <= DAT_00120878) {
        prout("First Officer Spock- \"Captain, our speed under impulse");
        prout("power is only 0.95 sectors per stardate. Are you sure");
        prout("we dare spend the time?\"");
        iVar1 = ja();
        if (iVar1 == 0) {
          DAT_00120878 = 0.0;
          return;
        }
      }
      lmove();
      DAT_00120754 = 1;
      if ((DAT_00120764 == 0) &&
         (DAT_00120838 = DAT_00120838 - (DAT_00120868 * 100.0 + 20.0), DAT_00120838 <= 0.0)) {
        finish(3);
      }
    }
  }
  else {
    chew();
    skip(1);
    prout("Engineer Scott- \"The impulse engines are damaged, Sir.\"");
  }
  return;
}



void setwrp(void)

{
  double dVar1;
  int iVar2;
  
  while (iVar2 = scan(), iVar2 == 0) {
    chew();
    proutn("Warp factor-");
  }
  chew();
  dVar1 = DAT_00120850;
  if (iVar2 == 2) {
    if (10.0 < DAT_00120210) {
      prout("Warp engines inoperative.");
    }
    else if ((DAT_00120210 <= 0.0) || (aaitem <= 4.0)) {
      if (10.0 < aaitem) {
        prout("Helmsman Sulu- \"Our top speed is warp 10, Captain.\"");
      }
      else if (aaitem < 1.0) {
        prout("Helmsman Sulu- \"We can\'t go below warp 1, Captain.\"");
      }
      else {
        DAT_00120850 = aaitem;
        DAT_00120858 = aaitem * aaitem;
        if ((aaitem <= dVar1) || (aaitem <= 6.0)) {
          proutn("Helmsman Sulu- \"Warp factor ");
          cramf(DAT_00120850,0,1);
          prout(", Captain.\"");
        }
        else if (aaitem < 8.0) {
          prout("Engineer Scott- \"Aye, but our maximum safe speed is warp 6.\"");
        }
        else if (aaitem == 10.0) {
          prout("Engineer Scott- \"Aye, Captain, we\'ll try it.\"");
        }
        else {
          prout("Engineer Scott- \"Aye, Captain, but our engines may not take it.\"");
        }
      }
    }
    else {
      prout(
           "Engineer Scott- \"I\'m doing my best, Captain,\n  but right now we can only go warp 4.\""
           );
    }
  }
  else {
    huh();
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void timwrp(void)

{
  long lVar1;
  undefined *puVar2;
  int iVar3;
  int *piVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  undefined *puVar7;
  uint uVar8;
  byte bVar9;
  double dVar10;
  double dVar11;
  double dVar12;
  
  bVar9 = 0;
  prout("***TIME WARP ENTERED.");
  if (((int)d == 0) || (dVar10 = (double)Rand(), 0.5 <= dVar10)) {
    dVar10 = DAT_00120810 * -0.5;
    dVar11 = (double)Rand();
    dVar11 = log(dVar11);
    DAT_00120878 = dVar11 * dVar10;
    proutn("You are traveling forward in time ");
    cramf(DAT_00120878,1,2);
    prout(" stardates.");
    future._16_8_ = DAT_00120878 + (double)future._16_8_;
    DAT_00120228 = DAT_00120878 + DAT_00120228;
  }
  else {
    proutn("You are traveling backwards in time ");
    cramf(DAT_001211f0 - _DAT_00120d90,0,2);
    prout(" stardates.");
    puVar5 = &snapsht;
    puVar6 = &d;
    for (lVar1 = 0x89; dVar10 = DAT_001211f0, lVar1 != 0; lVar1 = lVar1 + -1) {
      *puVar6 = *puVar5;
      puVar5 = puVar5 + (ulong)bVar9 * -2 + 1;
      puVar6 = puVar6 + (ulong)bVar9 * -2 + 1;
    }
    d._0_4_ = 0;
    if (DAT_00120dc8 != 0) {
      dVar12 = (double)expran(DAT_00120810 / (double)DAT_00120dc8);
      dVar11 = DAT_001211f0;
      future._16_8_ = dVar10 + dVar12;
      dVar10 = (double)expran(DAT_00120810 * 0.3);
      future._32_8_ = dVar11 + dVar10;
    }
    dVar10 = DAT_001211f0;
    dVar12 = (double)expran(DAT_00120810 * 0.5);
    dVar11 = DAT_001211f0;
    future._8_8_ = dVar10 + dVar12;
    dVar10 = (double)expran(DAT_00121200 * 0.25);
    future._24_8_ = dVar11 + dVar10;
    if (_DAT_001210f8 != 0) {
      future._48_8_ = 0x3fd1c5d63886594b;
    }
    DAT_001207ac = 0;
    future._56_8_ = 0x46293e5939a08cea;
    future._40_8_ = 0x46293e5939a08cea;
    DAT_001207dc = 0;
    DAT_001207d8 = 0;
    if (DAT_0012078c < 1) {
      uVar8 = 0;
    }
    else {
      piVar4 = &DAT_00121130;
      uVar8 = 0;
      iVar3 = 1;
      do {
        if (*piVar4 == 2) {
          if (DAT_001207a8 == 1) {
            uVar8 = 1;
            if (DAT_0012071c == 0x45) {
              prout("Checkov-  \"Security reports the Galileo has disappeared, Sir!");
              DAT_001207a8 = 0;
            }
          }
          else {
            uVar8 = 1;
          }
        }
        iVar3 = iVar3 + 1;
        piVar4 = piVar4 + 5;
      } while (iVar3 <= DAT_0012078c);
    }
    if (((uVar8 | DAT_001207a8) == 0) && (0.0 <= DAT_00120230)) {
      prout("Checkov-  \"Security reports the Galileo has reappeared in the dock!\"");
      DAT_001207a8 = 1;
    }
    dVar10 = DAT_00120228;
    if ((DAT_00120228 == 0.0) || (DAT_001211f0 < DAT_00120898)) {
      puVar2 = (undefined *)0x120504;
      puVar7 = &DAT_00120de4;
      do {
        lVar1 = 0;
        do {
          if (1 < *(int *)(puVar2 + lVar1 + 4)) {
            iVar3 = 1;
            if (0.0 < dVar10) {
              iVar3 = *(int *)(puVar7 + lVar1 + 0x24) + 1000;
            }
            *(int *)(puVar2 + lVar1 + 4) = iVar3;
          }
          lVar1 = lVar1 + 4;
        } while (lVar1 != 0x20);
        puVar2 = puVar2 + 0x24;
        puVar7 = puVar7 + 0x24;
      } while (puVar2 != &DAT_00120624);
      prout("Spock has reconstructed a correct star chart from memory");
      if (0.0 < DAT_00120228) {
        DAT_00120898 = DAT_001211f0;
      }
    }
  }
  newqad(0);
  return;
}



void warp(int param_1)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  double dVar5;
  double dVar6;
  double dVar7;
  double local_28;
  double local_20 [2];
  
  if (param_1 != 2) {
    DAT_00120754 = 0;
    if (DAT_001207b4 != 0) {
      chew();
      skip(1);
      prout("Engineer Scott- \"The warp engines can better not be used while cloaked, Sir.\"");
      return;
    }
    if (10.0 < DAT_00120210) {
      chew();
      skip(1);
      prout("Engineer Scott- \"The warp engines are damaged, Sir.\"");
      return;
    }
    if ((0.0 < DAT_00120210) && (4.0 < DAT_00120850)) {
      chew();
      skip(1);
      prout("Engineer Scott- \"Sorry, Captain. Until this damage");
      prout("  is repaired, I can only give you warp 4.\"");
      return;
    }
    getcd(0,0);
    if (DAT_00120870 == -1.0) {
      return;
    }
    dVar5 = (DAT_00120868 + 0.05) * DAT_00120850 * DAT_00120850 * DAT_00120850 *
            (DAT_00120848 + 1.0);
    if (DAT_00120838 <= dVar5) {
      DAT_00120754 = 0;
      skip(1);
      prout("Engineering to bridge--");
      if ((DAT_00120848 != 0.0) && (dVar5 * 0.5 <= DAT_00120838)) {
        prout("We haven\'t the energy to go that far with the shields up.");
        return;
      }
      dVar5 = pow(DAT_00120838 / (DAT_00120868 + 0.05),0.333333333);
      if ((int)dVar5 < 1) {
        prout("We can\'t do it, Captain. We haven\'t the energy.");
        return;
      }
      proutn("We haven\'t the energy, but we could do it at warp ");
      crami((int)dVar5,1);
      if (DAT_00120848 == 0.0) {
        prout(".");
        return;
      }
      prout(",\nif you\'ll lower the shields.");
      return;
    }
    DAT_00120878 = (DAT_00120868 * 10.0) / DAT_00120858;
    if (DAT_00121200 * 0.8 <= DAT_00120878) {
      skip(1);
      prout("First Officer Spock- \"Captain, I compute that such");
      proutn("  a trip would require approximately ");
      cramf((DAT_00120878 * 100.0) / DAT_00121200,0,2);
      prout(" percent of our");
      prout("  remaining time.  Are you sure this is wise?\"");
      iVar4 = ja();
      if (iVar4 == 0) {
        DAT_00120878 = 0.0;
        return;
      }
    }
  }
  bVar1 = false;
  bVar2 = false;
  if (6.0 < DAT_00120850) {
    dVar7 = 6.0 - DAT_00120850;
    dVar5 = dVar7 * DAT_00120868;
    dVar6 = (double)Rand();
    if (dVar6 < (dVar5 * dVar7) / 66.666666666) {
      dVar5 = (double)Rand();
      dVar5 = dVar5 * DAT_00120868;
      DAT_00120868 = dVar5;
      dVar6 = pow(7.0,DAT_00120850 - 10.0);
      dVar7 = (double)Rand();
      bVar1 = dVar7 < dVar5 * 0.5 * dVar6;
      bVar2 = true;
    }
    else {
      dVar5 = DAT_00120868 * 0.5;
      dVar6 = pow(7.0,DAT_00120850 - 10.0);
      dVar7 = (double)Rand();
      bVar1 = false;
      bVar2 = false;
      if (dVar6 * dVar5 <= dVar7) goto LAB_0010a6da;
      bVar1 = true;
      bVar2 = false;
    }
    sincos((15.0 - DAT_00120870) * 0.5235997999999999,local_20,&local_28);
    dVar5 = (double)((ulong)local_20[0] & 0x7fffffffffffffff);
    if ((double)((ulong)local_20[0] & 0x7fffffffffffffff) <=
        (double)((ulong)local_28 & 0x7fffffffffffffff)) {
      dVar5 = (double)((ulong)local_28 & 0x7fffffffffffffff);
    }
    iVar4 = (int)(dVar5 * DAT_00120868 * 10.0 + 0.5);
    dVar6 = (double)DAT_00120728;
    dVar7 = (double)DAT_0012072c;
    if (0 < iVar4) {
      iVar3 = 1;
      do {
        dVar6 = dVar6 + (double)((ulong)local_20[0] ^ 0x8000000000000000) / dVar5;
        if (9 < (int)(dVar6 + 0.5) - 1U) break;
        dVar7 = dVar7 + local_28 / dVar5;
        if (9 < (int)(dVar7 + 0.5) - 1U) break;
        if (quad[(long)(int)(dVar7 + 0.5) + (long)(int)(dVar6 + 0.5) * 0xb] != '.') {
          bVar1 = false;
          bVar2 = false;
        }
        iVar3 = iVar3 + 1;
      } while (iVar3 <= iVar4);
    }
  }
LAB_0010a6da:
  lmove();
  if (DAT_00120764 == 0) {
    DAT_00120838 = DAT_00120838 -
                   DAT_00120850 * DAT_00120868 * DAT_00120850 * DAT_00120850 * (DAT_00120848 + 1.0);
    if (DAT_00120838 <= 0.0) {
      finish(3);
    }
    DAT_00120878 = (DAT_00120868 * 10.0) / DAT_00120858;
    if (bVar1) {
      timwrp();
    }
    dVar5 = DAT_00120890;
    if (bVar2) {
      dVar6 = (double)Rand();
      DAT_00120210 = (dVar6 * 3.0 + 1.0) * dVar5;
      skip(1);
      prout("Engineering to bridge--");
      prout("  Scott here.  The warp engines are damaged.");
      prout("  We\'ll have to reduce speed to warp 4.");
    }
    DAT_00120754 = 1;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void atover(int param_1)

{
  int iVar1;
  double dVar2;
  
  chew();
  if (DAT_00120780 == 1) {
    if (_DAT_00120240 != 0.0) {
      finish(0xf);
      return;
    }
    prout("Scotty rushes to the transporter controls.");
    if (DAT_00120848 != 0.0) {
      prout("But with the shields up it\'s hopeless.");
      finish(0xf);
    }
    prouts("His desperate attempt to rescue you . . .");
    dVar2 = (double)Rand();
    if (dVar2 <= 0.5) {
      prout("fails.");
      finish(0xf);
      return;
    }
    prout("SUCCEEDS!");
    if (_DAT_00120788 != 0) {
      _DAT_00120788 = 0;
      proutn("The crystals mined were ");
      dVar2 = (double)Rand();
      if (0.25 < dVar2) {
        prout("saved.");
        _DAT_001207cc = 1;
      }
      else {
        prout("lost.");
      }
    }
  }
  if (param_1 == 0) {
    if (_DAT_001207a0 != 0) {
      finish(0x11);
    }
    if (DAT_00120764 == 0) {
      skip(1);
      do {
        if (DAT_00120760 != 0) {
          prouts("***RED ALERT!  RED ALERT!");
          skip(1);
          proutn(&DAT_00115bbf);
          crmshp();
          prout(" has stopped in a quadrant containing");
          prouts("   a supernova.");
          skip(2);
        }
        proutn("***Emergency automatic override attempts to hurl ");
        crmshp();
        skip(1);
        prout("safely out of quadrant.");
        iVar1 = 1;
        if (0.0 < DAT_00120228) {
          iVar1 = *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) + 1000;
        }
        *(int *)(starch + ((long)DAT_00120720 * 9 + (long)DAT_00120724) * 4) = iVar1;
        if (DAT_00120210 != 0.0) {
          skip(1);
          prout("Warp engines damaged.");
          finish(7);
          return;
        }
        dVar2 = (double)Rand();
        DAT_00120850 = dVar2 + dVar2 + 6.0;
        DAT_00120858 = DAT_00120850 * DAT_00120850;
        proutn("Warp factor set to ");
        cramf(DAT_00120850,1,1);
        skip(1);
        DAT_00120868 = (DAT_00120838 * 0.75) /
                       (DAT_00120850 * DAT_00120850 * DAT_00120850 * (DAT_00120848 + 1.0));
        dVar2 = (double)Rand();
        if (dVar2 + 1.4142 < DAT_00120868) {
          DAT_00120868 = dVar2 + 1.4142;
        }
        DAT_00120878 = (DAT_00120868 * 10.0) / DAT_00120858;
        dVar2 = (double)Rand();
        DAT_00120870 = dVar2 * 12.0;
        DAT_00120760 = 0;
        DAT_0012077c = 0;
        warp(2);
        if (DAT_00120760 == 0) {
          if (DAT_00120764 != 0) {
            return;
          }
          skip(1);
          prout("Insufficient energy to leave quadrant.");
          finish(7);
          return;
        }
      } while (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) == 1000);
      if (d._4_4_ == 0) {
        finish(0);
      }
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void probe(void)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  double dVar4;
  double local_18;
  double local_10;
  
  if (DAT_00120800 == 0) {
    chew();
    skip(1);
    if (DAT_0012071c == 0x45) {
      prout("Engineer Scott- \"We have no more deep space probes, Sir.\"");
    }
    else {
      prout("Ye Faerie Queene has no deep space probes.");
    }
  }
  else if (_DAT_00120258 == 0.0) {
    if ((double)future._64_8_ == 1e+30) {
      iVar1 = scan();
      if (iVar1 == 0) {
        crami(DAT_00120800,1);
        pcVar3 = " probe left.";
        if (DAT_00120800 != 1) {
          pcVar3 = " probes left.";
        }
        prout(pcVar3);
        proutn("Are you sure you want to fire a probe? ");
        iVar2 = ja();
        if (iVar2 == 0) {
          return;
        }
        _DAT_001207fc = 0;
        proutn("Arm NOVAMAX warhead?");
        _DAT_001207fc = ja();
      }
      else {
        _DAT_001207fc = 0;
        if ((iVar1 == 1) && (iVar2 = strcmp(&citem,"armed"), iVar2 == 0)) {
          _DAT_001207fc = 1;
          iVar1 = scan();
        }
      }
      getcd(1,iVar1);
      if (DAT_00120870 != -1.0) {
        DAT_00120800 = DAT_00120800 + -1;
        sincos((15.0 - DAT_00120870) * 0.5235988,&local_10,&local_18);
        dVar4 = (double)((ulong)local_10 & 0x7fffffffffffffff);
        if ((double)((ulong)local_10 & 0x7fffffffffffffff) <=
            (double)((ulong)local_18 & 0x7fffffffffffffff)) {
          dVar4 = (double)((ulong)local_18 & 0x7fffffffffffffff);
        }
        _DAT_001208c0 = local_18 / dVar4;
        _DAT_001208b8 = (double)((ulong)local_10 ^ 0x8000000000000000) / dVar4;
        DAT_001207f8 = (int)(dVar4 * DAT_00120868 * 10.0 + 0.5);
        DAT_001208a8 = (double)(DAT_00120728 + -1 + DAT_00120720 * 10);
        DAT_001208b0 = (double)(DAT_0012072c + -1 + DAT_00120724 * 10);
        DAT_001207f0 = DAT_00120720;
        DAT_001207f4 = DAT_00120724;
        future._64_8_ = DAT_001211f0 + 0.01;
        prout("Ensign Chekov-  \"The deep space probe is launched, Captain.\"");
      }
    }
    else {
      chew();
      skip(1);
      if (((DAT_00120714 != 0x44) && (0.0 < DAT_00120228)) || (DAT_001207b4 != 0)) {
        prout("Spock-  \"Records show the previous probe has not yet");
        prout("   reached its destination.\"");
      }
      else {
        prout("Uhura- \"The previous probe is still reporting data, Sir.\"");
      }
    }
  }
  else {
    chew();
    skip(1);
    prout("Engineer Scott- \"The probe launcher is damaged, Sir.\"");
  }
  return;
}



void help(void)

{
  int iVar1;
  ulong uVar2;
  ulong unaff_RBP;
  int iVar3;
  int iVar4;
  double dVar5;
  double dVar6;
  double local_48;
  
  iVar1 = (int)unaff_RBP;
  chew();
  if (DAT_00120714 == 0x44) {
    prout("Lt. Uhura-  \"But Captain, we\'re already docked.\"");
    return;
  }
  if (DAT_00120228 != 0.0) {
    prout("Subspace radio damaged.");
    return;
  }
  if (DAT_00120dcc == 0) {
    prout("Lt. Uhura-  \"Captain, I\'m not getting any response from Starbase.\"");
    return;
  }
  if (DAT_00120780 == 1) {
    proutn("You must be aboard the ");
    crmshp();
    prout(".");
    return;
  }
  DAT_0012074c = DAT_0012074c + 1;
  if (DAT_00120738 == 0) {
    uVar2 = 1;
    local_48 = 1e+30;
    if (0 < DAT_00120dcc) {
      do {
        dVar5 = (double)square((double)((&DAT_00120f7c)[uVar2] - DAT_00120720));
        dVar6 = (double)square((double)((&DAT_00120f94)[uVar2] - DAT_00120724));
        dVar6 = dVar6 + dVar5;
        if (dVar6 < 0.0) {
          dVar6 = sqrt(dVar6);
        }
        else {
          dVar6 = SQRT(dVar6);
        }
        dVar6 = dVar6 * 10.0;
        if (dVar6 < local_48) {
          unaff_RBP = uVar2;
        }
        unaff_RBP = unaff_RBP & 0xffffffff;
        iVar1 = (int)unaff_RBP;
        if (local_48 <= dVar6) {
          dVar6 = local_48;
        }
        uVar2 = uVar2 + 1;
        local_48 = dVar6;
      } while ((int)uVar2 <= DAT_00120dcc);
    }
    DAT_00120720 = (&DAT_00120f7c)[iVar1];
    DAT_00120724 = (&DAT_00120f94)[iVar1];
    newqad(1);
  }
  else {
    local_48 = (double)square((double)(DAT_00120738 - DAT_00120728));
    dVar6 = (double)square((double)(DAT_0012073c - DAT_0012072c));
    local_48 = local_48 + dVar6;
    if (local_48 < 0.0) {
      local_48 = sqrt(local_48);
    }
    else {
      local_48 = SQRT(local_48);
    }
  }
  quad[(long)DAT_0012072c + (long)DAT_00120728 * 0xb] = 0x2e;
  proutn("Starbase in");
  cramlc(1,DAT_00120720,DAT_00120724);
  proutn(" responds--");
  crmshp();
  prout(" dematerializes.");
  dVar6 = pow(0.98,local_48);
  dVar6 = pow(1.0 - dVar6,0.33333333);
  iVar1 = 1;
  do {
    while (iVar1 != 2) {
      if (iVar1 == 3) {
        proutn(&DAT_00119f49);
        goto LAB_0010b502;
      }
      if (iVar1 != 1) goto LAB_0010b502;
      proutn(&DAT_00119f19);
      proutn(" attempt to re-materialize ");
      crmshp();
      prouts(" . . . . . ");
      dVar5 = (double)Rand();
      if (dVar6 < dVar5) {
LAB_0010b665:
        if (iVar1 < 4) {
          iVar1 = 5;
          while( true ) {
            dVar5 = (double)DAT_00120738;
            dVar6 = (double)Rand();
            iVar4 = DAT_0012073c;
            iVar3 = (int)((dVar6 * 3.0 + dVar5) - 1.0);
            dVar6 = (double)Rand();
            if (((iVar3 - 1U < 10) &&
                (iVar4 = (int)((dVar6 * 3.0 + (double)iVar4) - 1.0), iVar4 - 1U < 10)) &&
               (quad[(long)iVar4 + (long)iVar3 * 0xb] == '.')) break;
            iVar1 = iVar1 + -1;
            if (iVar1 == 0) {
              finish(10);
              return;
            }
          }
          prout("succeeds.");
          DAT_00120728 = iVar3;
          DAT_0012072c = iVar4;
          quad[(long)iVar4 + (long)iVar3 * 0xb] = (char)DAT_0012071c;
          dock();
          skip(1);
          prout("Lt. Uhura-  \"Captain, we made it!\"");
          return;
        }
        goto LAB_0010b537;
      }
      prout("fails.");
      iVar1 = 2;
    }
    proutn(&DAT_00119f45);
LAB_0010b502:
    proutn(" attempt to re-materialize ");
    crmshp();
    prouts(" . . . . . ");
    dVar5 = (double)Rand();
    if (dVar6 < dVar5) goto LAB_0010b665;
    prout("fails.");
    iVar1 = iVar1 + 1;
  } while (iVar1 != 4);
LAB_0010b537:
  finish(10);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void fry(double param_1)

{
  long lVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  int iVar5;
  long in_FS_OFFSET;
  double dVar6;
  double dVar7;
  double dVar8;
  int local_48 [6];
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  dVar6 = (double)DAT_00120734;
  dVar7 = (double)Rand();
  if ((dVar7 * 0.5 + 1.0) * (275.0 - dVar6 * 25.0) <= param_1) {
    dVar6 = (double)Rand();
    dVar6 = param_1 / (dVar6 * 100.0 + 500.0) + 1.0;
    proutn("***CRITICAL HIT--");
    lVar4 = 1;
    iVar5 = 1;
    if (1.0 <= dVar6) {
LAB_0010b9b1:
      do {
        do {
          dVar7 = (double)Rand();
          iVar2 = (int)(dVar7 * 16.0 + 1.0);
        } while ((double)(&damage)[iVar2] <= 0.0 && (double)(&damage)[iVar2] != 0.0);
        if (iVar2 == 10) {
          if (DAT_001207a8 != 1) goto LAB_0010b9b1;
        }
        else if (iVar2 == 0x10) {
          if (DAT_0012071c != 0x45) goto LAB_0010b9b1;
        }
        else if (iVar2 == 0xe) goto LAB_0010b9b1;
        local_48[lVar4] = iVar2;
        dVar8 = param_1 * DAT_00120890;
        dVar7 = (double)Rand();
        (&damage)[iVar2] = dVar8 / ((dVar7 * 25.0 + 75.0) * dVar6) + (double)(&damage)[iVar2];
        iVar3 = (int)lVar4;
        lVar1 = 2;
        if (1 < iVar3) {
          do {
            if (local_48[lVar1 + -1] == iVar2) {
              if ((int)lVar1 <= iVar3) goto LAB_0010b92c;
              break;
            }
            lVar1 = lVar1 + 1;
          } while ((int)lVar1 <= iVar3);
          iVar5 = iVar5 + 1;
          if (iVar5 == 3) {
            skip(1);
          }
          proutn(" and ");
        }
        proutn(*(undefined8 *)(device + (long)iVar2 * 8));
LAB_0010b92c:
        lVar4 = lVar4 + 1;
      } while ((double)(iVar3 + 1) <= dVar6);
    }
    prout(" damaged.");
    if ((DAT_00120220 != 0.0) && (DAT_00120848 != 0.0)) {
      prout("***Shields knocked down.");
      DAT_00120848 = 0.0;
    }
    if ((_DAT_00120260 != 0.0) && (DAT_001207b4 != 0)) {
      prout("***Cloaking device rendered inoperative.");
      DAT_001207b4 = 0;
    }
  }
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void overheat(double param_1)

{
  double dVar1;
  double dVar2;
  double dVar3;
  
  if (param_1 <= 1500.0) {
    return;
  }
  dVar1 = (param_1 - 1500.0) * 0.00038;
  dVar2 = (double)Rand();
  if (dVar2 <= dVar1) {
    prout("Weapons officer Sulu-  \"Phasers overheated, sir.\"");
    dVar2 = DAT_00120890;
    dVar3 = (double)Rand();
    DAT_001201f8 = (dVar3 + 1.0) * dVar2 * (dVar1 + 1.0);
  }
  return;
}



undefined8 targetcheck(double param_1,double param_2,double *param_3)

{
  undefined8 uVar1;
  double dVar2;
  double __x;
  
  if ((((param_1 < 1.0) || (10.0 < param_1)) || (param_2 < 1.0)) || (10.0 < param_2)) {
    huh();
    uVar1 = 1;
  }
  else {
    dVar2 = (param_2 - (double)DAT_0012072c) * 0.1;
    __x = ((double)DAT_00120728 - param_1) * 0.1;
    if ((dVar2 == 0.0) && (__x == 0.0)) {
      skip(1);
      prout("Spock-  \"Bridge to sickbay.  Dr. McCoy,");
      prout("  I recommend an immediate review of");
      prout("  the Captain\'s psychological profile.");
      chew();
      uVar1 = 1;
    }
    else {
      dVar2 = atan2(dVar2,__x);
      *param_3 = dVar2 * 1.90985932;
      uVar1 = 0;
    }
  }
  return uVar1;
}



undefined8 checkshctrl(double param_1)

{
  undefined8 uVar1;
  int iVar2;
  double dVar3;
  double dVar4;
  
  skip(1);
  dVar3 = (double)Rand();
  if (dVar3 < 0.998) {
    prout("Shields lowered.");
    uVar1 = 0;
  }
  else {
    prouts("***RED ALERT!  RED ALERT!");
    skip(2);
    dVar3 = (param_1 * DAT_00120840) / DAT_00120820;
    DAT_00120838 = DAT_00120838 - (dVar3 * 0.8 + param_1);
    DAT_00120840 = DAT_00120840 - dVar3 * 0.2;
    if (DAT_00120838 <= 0.0) {
      prouts("Sulu-  \"Captain! Shield malf***********************\"");
      skip(1);
      stars();
      finish(0xb);
      uVar1 = 1;
    }
    else {
      prouts("Sulu-  \"Captain! Shield malfunction! Phaser fire contained!\"");
      skip(2);
      prout("Lt. Uhura-  \"Sir, all decks reporting damage.\"");
      dVar4 = (double)Rand();
      iVar2 = (int)(dVar4 * dVar3 * 0.012);
      skip(1);
      fry(dVar3 * 0.8);
      if (iVar2 != 0) {
        skip(1);
        prout("McCoy to bridge- \"Severe radiation burns, Jim.");
        proutn("  ");
        crami(iVar2,1);
        prout(" casualties so far.\"");
        DAT_00120748 = DAT_00120748 + iVar2;
      }
      skip(1);
      prout("Phaser energy dispersed by shields.");
      prout("Enemy unaffected.");
      overheat(param_1);
      uVar1 = 1;
    }
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void cloak(void)

{
  int iVar1;
  
  if (DAT_0012071c == 0x46) {
    prout("Ye Faerie Queene has no cloaking device.");
    return;
  }
  iVar1 = scan();
  if (iVar1 == 2) {
    return;
  }
  if (iVar1 == 1) {
    iVar1 = isit("on");
    if (iVar1 != 0) {
      if (DAT_001207b4 != 0) {
        prout("The cloaking device has already been switched on.");
        return;
      }
LAB_0010bee1:
      if (_DAT_00120260 != 0.0) {
        prout("Engineer Scott- \"The cloaking device is damaged, Sir.\"");
        return;
      }
      if (DAT_00120714 == 0x44) {
        prout("You cannot cloak while docked.");
        return;
      }
      if ((2311.0 <= DAT_001211f0) && (_DAT_001207c0 == 0)) {
        prout("Spock- \"Captain, using the cloaking device is be a violation");
        prout("  of the Treaty of Algeron. Considering the alternatives,");
        proutn("  are you sure this is wise?");
        iVar1 = ja();
        if (iVar1 == 0) {
          return;
        }
      }
      prout("Engineer Scott- \"The cloaking device has been engaged, Sir.\"");
      DAT_001207b8 = 1;
      if (_DAT_0012079c == 0) {
        DAT_001207b8 = 1;
        return;
      }
      if (DAT_001211f0 < 2311.0) {
        DAT_001207b8 = 1;
        return;
      }
      if (_DAT_001207c0 != 0) {
        DAT_001207b8 = 1;
        return;
      }
      prout("The Romulan ship discovers you are breaking the Treaty of Algeron!");
      DAT_001207bc = DAT_001207bc + 1;
      _DAT_001207c0 = 1;
      return;
    }
    iVar1 = isit(&DAT_0011a041);
    if (iVar1 == 0) {
      huh();
      return;
    }
    if (DAT_001207b4 == 0) {
      prout("The cloaking device has already been switched off.");
      return;
    }
  }
  else {
    if (DAT_001207b4 == 0) {
      proutn("Switch cloaking device on?");
      iVar1 = ja();
      if (iVar1 == 0) {
        return;
      }
      if (DAT_001207b4 == 0) goto LAB_0010bee1;
    }
    proutn("Switch cloaking device off?");
    iVar1 = ja();
    if (iVar1 == 0) {
      return;
    }
  }
  if (((_DAT_0012079c != 0) && (2311.0 <= DAT_001211f0)) && (_DAT_001207c0 == 0)) {
    prout("Spock- \"Captain, the Treaty of Algeron is in effect.\n   Are you sure this is wise?\"");
    iVar1 = ja();
    if (iVar1 == 0) {
      return;
    }
  }
  prout("Engineer Scott- \"Aye, Sir.\"");
  DAT_001207b4 = 0;
  if (((_DAT_0012079c != 0) && (2311.0 <= DAT_001211f0)) && (_DAT_001207c0 == 0)) {
    prout("The Romulan ship discovers you are breaking the Treaty of Algeron!");
    DAT_001207bc = DAT_001207bc + 1;
    _DAT_001207c0 = 1;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void sheild(int param_1)

{
  int iVar1;
  
  DAT_00120754 = 0;
  if (param_1 != 2) {
    iVar1 = scan();
    if (iVar1 == 1) {
      iVar1 = isit("transfer");
      if (iVar1 != 0) goto LAB_0010c242;
      chew();
      if (DAT_00120220 != 0.0) {
        prout("Shields damaged and down.");
        return;
      }
      iVar1 = isit(&DAT_0011a0d8);
      if (iVar1 != 0) goto LAB_0010c017;
      iVar1 = isit(&DAT_0011a0db);
      if (iVar1 != 0) goto LAB_0010c1a4;
    }
    proutn("Do you wish to change shield energy? ");
    iVar1 = ja();
    if (iVar1 != 0) {
      proutn("Energy to transfer to shields- ");
LAB_0010c242:
      while (iVar1 = scan(), iVar1 != 2) {
        chew();
        proutn("Energy to transfer to shields- ");
      }
      chew();
      if (aaitem == 0.0) {
        return;
      }
      if (DAT_00120838 < aaitem) {
        prout("Insufficient ship energy.");
        return;
      }
      DAT_00120754 = 1;
      if (aaitem + DAT_00120840 < DAT_00120820) {
        if ((aaitem < 0.0) && (DAT_00120818 < DAT_00120838 - aaitem)) {
          skip(1);
          prout("Engineering to bridge--");
          prout("  Scott here. Power circuit problem, Captain.");
          prout("  I can\'t drain the shields.");
          DAT_00120754 = 0;
          return;
        }
        if (0.0 <= aaitem + DAT_00120840) {
          proutn("Scotty- \"");
          if (aaitem <= 0.0) {
            prout("Draining energy from shields.\"");
          }
          else {
            prout("Transferring energy to shields.\"");
          }
          DAT_00120838 = DAT_00120838 - aaitem;
          DAT_00120840 = aaitem + DAT_00120840;
          return;
        }
        prout("All shield energy transferred to ship.");
        DAT_00120838 = DAT_00120838 + DAT_00120840;
        DAT_00120840 = 0.0;
        return;
      }
      prout("Shield energy maximized.");
      if (DAT_00120820 < DAT_00120840 + aaitem) {
        prout("Excess energy requested returned to ship energy");
      }
      DAT_00120838 = DAT_00120838 - (DAT_00120820 - DAT_00120840);
      DAT_00120840 = DAT_00120820;
      return;
    }
    if (DAT_00120220 != 0.0) {
      prout("Shields damaged and down.");
      return;
    }
    if (DAT_00120848 != 0.0) {
      proutn("Shields are up. Do you want them down? ");
      iVar1 = ja();
      if (iVar1 == 0) {
        chew();
        return;
      }
LAB_0010c1a4:
      if (DAT_00120848 == 0.0) {
        prout("Shields already down.");
        return;
      }
      DAT_00120848 = 0.0;
      _DAT_00120768 = 1;
      prout("Shields lowered.");
      DAT_00120754 = 1;
      return;
    }
    proutn("Shields are down. Do you want them up? ");
    iVar1 = ja();
    if (iVar1 == 0) {
      chew();
      return;
    }
  }
LAB_0010c017:
  if (DAT_00120848 == 0.0) {
    DAT_00120848 = 1.0;
    _DAT_00120768 = 1;
    if (DAT_00120714 != 0x44) {
      DAT_00120838 = DAT_00120838 - 50.0;
    }
    prout("Shields raised.");
    if (DAT_00120838 <= 0.0) {
      skip(1);
      prout("Shields raising uses up last of energy.");
      finish(3);
    }
    else {
      DAT_00120754 = 1;
    }
  }
  else {
    prout("Shields already up.");
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x0010c641)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void deadkl(int param_1,int param_2,int param_3)

{
  undefined8 uVar1;
  int iVar2;
  double dVar3;
  long lVar4;
  int *piVar5;
  long lVar6;
  int iVar7;
  int iVar8;
  double dVar9;
  
  crmena(1,param_3,2);
  iVar8 = DAT_00120724;
  iVar2 = DAT_00120720;
  if (param_3 == 0x52) {
    (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] =
         (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] + -10;
    _DAT_0012079c = _DAT_0012079c + -1;
    DAT_001210fc = DAT_001210fc + 1;
    DAT_00121100 = DAT_00121100 + -1;
  }
  else {
    if (param_3 == 0x54) {
      _DAT_001207e0 = 0;
      prout(" destroyed.");
      quad[(long)param_2 + (long)param_1 * 0xb] = 0x2e;
      if (d._4_4_ == 0) {
        return;
      }
      DAT_00121200 = DAT_001211f8 / (double)(d._4_4_ + DAT_00120dc8 * 4);
      return;
    }
    piVar5 = (int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
    *piVar5 = *piVar5 + -100;
    DAT_00120740 = DAT_00120740 + -1;
    d._4_4_ = d._4_4_ + -1;
    if (param_3 == 0x4b) {
      DAT_00120dd8 = DAT_00120dd8 + 1;
    }
    else if (param_3 == 0x53) {
      _DAT_001207b0 = 0;
      DAT_001207ac = 0;
      DAT_001210f4 = 0;
      DAT_001210f0 = 0;
      DAT_00120794 = 0;
      _DAT_001210f8 = 0;
      DAT_00121104 = 1;
      future._56_8_ = 0x46293e5939a08cea;
      future._48_8_ = 0x46293e5939a08cea;
    }
    else {
      if (param_3 != 0x43) {
        prout(" destroyed.");
        quad[(long)param_2 + (long)param_1 * 0xb] = 0x2e;
        if (d._4_4_ == 0) {
          return;
        }
        DAT_00121200 = DAT_001211f8 / (double)(d._4_4_ + DAT_00120dc8 * 4);
        goto LAB_0010c5ac;
      }
      DAT_00120744 = 0;
      if (DAT_00120dc8 < 1) {
        iVar7 = 1;
      }
      else {
        piVar5 = &DAT_00120f28;
        iVar7 = 1;
        do {
          if ((iVar2 == *piVar5) && (iVar8 == piVar5[0xb])) break;
          iVar7 = iVar7 + 1;
          piVar5 = piVar5 + 1;
        } while (iVar7 <= DAT_00120dc8);
      }
      lVar4 = (long)DAT_00120dc8 + 0x58;
      *(undefined4 *)(&DAT_00120f24 + (long)iVar7 * 4) = *(undefined4 *)((long)&d + lVar4 * 4 + 4);
      lVar6 = (long)DAT_00120dc8 + 100;
      *(undefined4 *)(&DAT_00120f50 + (long)iVar7 * 4) = *(undefined4 *)((long)&d + lVar6 * 4);
      *(undefined4 *)((long)&d + lVar4 * 4 + 4) = 0;
      *(undefined4 *)((long)&d + lVar6 * 4) = 0;
      dVar3 = DAT_001211f0;
      DAT_00120dc8 = DAT_00120dc8 + -1;
      future._16_8_ = 0x46293e5939a08cea;
      if (DAT_00120dc8 != 0) {
        dVar9 = (double)expran((double)_DAT_00120708 / (double)DAT_00120dc8);
        future._16_8_ = dVar3 + dVar9;
      }
      DAT_00120ddc = DAT_00120ddc + 1;
    }
  }
  prout(" destroyed.");
  quad[(long)param_2 + (long)param_1 * 0xb] = 0x2e;
  if (d._4_4_ == 0) {
    return;
  }
  DAT_00121200 = DAT_001211f8 / (double)(d._4_4_ + DAT_00120dc8 * 4);
LAB_0010c5ac:
  iVar2 = DAT_00120790;
  if (DAT_00120790 < 1) {
    iVar8 = 1;
  }
  else {
    lVar4 = 1;
    do {
      iVar8 = (int)lVar4;
      if ((*(int *)(kx + lVar4 * 4) == param_1) && (*(int *)(ky + lVar4 * 4) == param_2)) break;
      iVar8 = iVar8 + 1;
      lVar4 = lVar4 + 1;
    } while ((int)lVar4 <= DAT_00120790);
  }
  iVar7 = DAT_00120790 + -1;
  DAT_00120790 = iVar7;
  if (iVar8 <= iVar7) {
    lVar4 = (long)iVar8;
    do {
      *(undefined4 *)(kx + lVar4 * 4) = *(undefined4 *)(kx + lVar4 * 4 + 4);
      *(undefined4 *)(ky + lVar4 * 4) = *(undefined4 *)(ky + lVar4 * 4 + 4);
      *(undefined8 *)(kpower + lVar4 * 8) = *(undefined8 *)(kpower + lVar4 * 8 + 8);
      uVar1 = *(undefined8 *)(kdist + lVar4 * 8 + 8);
      *(undefined8 *)(kdist + lVar4 * 8) = uVar1;
      *(undefined8 *)(kavgd + lVar4 * 8) = uVar1;
      lVar4 = lVar4 + 1;
    } while ((int)lVar4 <= iVar7);
  }
  lVar4 = (long)iVar2;
  *(undefined4 *)(kx + lVar4 * 4) = 0;
  *(undefined4 *)(ky + lVar4 * 4) = 0;
  *(undefined8 *)(kdist + lVar4 * 8) = 0;
  *(undefined8 *)(kavgd + lVar4 * 8) = 0;
  *(undefined8 *)(kpower + lVar4 * 8) = 0;
  return;
}



void ram(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  double *pdVar2;
  double dVar3;
  double dVar4;
  
  prouts("***RED ALERT!  RED ALERT!");
  skip(1);
  prout("***COLLISION IMMINENT.");
  skip(2);
  proutn("***");
  crmshp();
  if (param_2 == 0x53) {
    dVar3 = 2.5;
  }
  else if (param_2 < 0x54) {
    dVar3 = 2.0;
    if (param_2 != 0x43) {
      if (param_2 == 0x52) {
        dVar3 = 1.5;
      }
      else {
        dVar3 = 1.0;
      }
    }
  }
  else {
    dVar3 = 1.0;
    if (param_2 == 0x54) {
      dVar3 = 0.5;
    }
  }
  if (param_1 == 0) {
    proutn(" rams ");
    crmena(0,param_2,2,param_3,param_4);
  }
  else {
    proutn(" rammed by ");
    crmena(0,param_2,2,param_3,param_4);
    proutn(" (original position)");
  }
  skip(1);
  deadkl(param_3,param_4,param_2,DAT_00120728,DAT_0012072c);
  proutn("***");
  crmshp();
  prout(" heavily damaged.");
  dVar4 = (double)Rand();
  iVar1 = (int)(dVar4 * 20.0 + 10.0);
  proutn("***Sickbay reports ");
  crami(iVar1,1);
  prout(" casualties.");
  DAT_00120748 = DAT_00120748 + iVar1;
  pdVar2 = (double *)&DAT_001201e8;
  iVar1 = 2;
  do {
    if (iVar1 != 0xf) {
      if (0.0 < *pdVar2 || *pdVar2 == 0.0) {
        dVar4 = (double)Rand();
        *pdVar2 = (dVar3 * 10.0 * dVar4 + 1.0) * DAT_00120890 + DAT_00120878 + *pdVar2;
      }
      if (0x10 < iVar1) {
        DAT_00120848 = 0;
        if (d._4_4_ == 0) {
          finish(0);
        }
        else {
          pause();
          dreprt();
        }
        return;
      }
    }
    iVar1 = iVar1 + 1;
    pdVar2 = pdVar2 + 1;
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void torpedo(double param_1,double param_2,int param_3,int param_4,ulong *param_5)

{
  int *piVar1;
  ulong uVar2;
  char cVar3;
  undefined8 uVar4;
  int iVar5;
  long lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  long in_FS_OFFSET;
  double dVar12;
  double dVar13;
  double dVar14;
  double dVar15;
  double dVar16;
  double local_a0;
  double local_98;
  double local_58;
  double local_50;
  undefined local_48 [4];
  undefined local_44 [4];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  dVar12 = (15.0 - (param_2 * 0.25 + param_1)) * 0.5235988;
  sincos(dVar12,&local_50,&local_58);
  dVar14 = (15.0 - param_1) * 0.5235988;
  dVar16 = (double)((ulong)local_50 ^ 0x8000000000000000);
  local_a0 = (double)param_3;
  local_98 = (double)param_4;
  dVar13 = (double)((ulong)local_58 & 0x7fffffffffffffff);
  if ((double)((ulong)local_58 & 0x7fffffffffffffff) <=
      (double)((ulong)local_50 & 0x7fffffffffffffff)) {
    dVar13 = (double)((ulong)local_50 & 0x7fffffffffffffff);
  }
  dVar15 = local_58 / dVar13;
  iVar9 = 1;
  do {
    local_a0 = local_a0 + dVar16 / dVar13;
    iVar7 = (int)(local_a0 + 0.5);
    if (9 < iVar7 - 1U) break;
    local_98 = local_98 + dVar15;
    iVar8 = (int)(local_98 + 0.5);
    if (9 < iVar8 - 1U) break;
    if ((iVar9 == 4) || (iVar9 == 9)) {
      skip(1);
    }
    cramf(local_a0,0,1);
    proutn(" - ");
    cramf(local_98,0,1);
    proutn("   ");
    cVar3 = quad[(long)iVar8 + (long)iVar7 * 0xb];
    iVar5 = (int)cVar3;
    if (cVar3 != '.') {
      skip(1);
      switch(cVar3) {
      case ' ':
        skip(1);
        crmena(1,0x20,2,iVar7,iVar8);
        prout(" swallows torpedo.");
        goto LAB_0010ccf3;
      default:
        skip(1);
        proutn("Don\'t know how to handle collision with ");
        crmena(1,iVar5,2,iVar7,iVar8);
        skip(1);
        goto LAB_0010ccf3;
      case '#':
        skip(1);
        prout("***Torpedo absorbed by Tholian web.");
        goto LAB_0010ccf3;
      case '*':
        dVar13 = (double)Rand();
        if (0.1 < dVar13) {
          nova(iVar7,iVar8);
        }
        else {
          crmena(1,0x2a,2,iVar7,iVar8);
          prout(" unaffected by photon blast.");
        }
        goto LAB_0010ccf3;
      case '?':
        skip(1);
        prouts("AAAAIIIIEEEEEEEEAAAAAAAAUUUUUGGGGGHHHHHHHHHHHH!!!");
        skip(1);
        prouts("    HACK!     HACK!    HACK!        *CHOKE!*  ");
        skip(1);
        proutn("Mr. Spock-");
        prouts("  \"Facinating!\"");
        skip(1);
        quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x2e;
        goto LAB_0010ccf3;
      case 'B':
        prout("***STARBASE DESTROYED..");
        iVar5 = DAT_00120724;
        iVar9 = DAT_00120720;
        if (*(int *)(starch + ((long)DAT_00120720 * 9 + (long)DAT_00120724) * 4) < 0) {
          *(undefined4 *)(starch + ((long)DAT_00120720 * 9 + (long)DAT_00120724) * 4) = 0;
        }
        if (DAT_00120dcc < 1) goto LAB_0010d3d5;
        lVar6 = 1;
        goto LAB_0010d39d;
      case 'C':
      case 'S':
        dVar13 = (double)Rand();
        if (dVar13 <= 0.05) {
          crmena(1,iVar5,2,iVar7,iVar8);
          prout(" uses anti-photon device;");
          prout("   torpedo neutralized.");
          goto LAB_0010ccf3;
        }
      case 'K':
      case 'R':
        if (DAT_00120790 < 1) {
          iVar10 = 1;
          goto LAB_0010cf92;
        }
        lVar6 = 1;
        goto LAB_0010cf83;
      case 'E':
      case 'F':
        goto switchD_0010ccbd_caseD_45;
      case 'P':
        crmena(1,0x50,2,iVar7,iVar8);
        prout(" destroyed.");
        DAT_00121108 = DAT_00121108 + 1;
        (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] =
             (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] + -1;
        uVar4 = nulplanet._8_8_;
        lVar6 = (long)DAT_00120784 * 0x14;
        *(undefined8 *)(&DAT_0012110c + lVar6) = nulplanet._0_8_;
        *(undefined8 *)(&DAT_00121114 + lVar6) = uVar4;
        *(undefined4 *)(&DAT_0012111c + lVar6) = nulplanet._16_4_;
        DAT_00120784 = 0;
        DAT_00120778 = 0;
        DAT_00120774 = 0;
        quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x2e;
        if (DAT_00120780 == 1) {
          finish(0xe);
        }
        goto LAB_0010ccf3;
      case 'T':
        skip(1);
        crmena(1,0x54,2,iVar7,iVar8);
        dVar16 = (double)Rand();
        dVar13 = (double)square((double)(iVar7 - param_3));
        dVar15 = (double)square((double)(iVar8 - param_4));
        dVar13 = dVar13 + dVar15;
        if (dVar13 < 0.0) {
          dVar13 = sqrt(dVar13);
        }
        else {
          dVar13 = SQRT(dVar13);
        }
        dVar12 = sin(dVar14 - dVar12);
        if (600.0 <= (double)((ulong)((dVar16 * 100.0 + 700.0) -
                                     dVar13 * 1000.0 * (double)((ulong)dVar12 & 0x7fffffffffffffff))
                             & 0x7fffffffffffffff)) {
          prout(" destroyed.");
          quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x2e;
          _DAT_001207e0 = 0;
          DAT_001207e8 = 0;
          DAT_001207e4 = 0;
        }
        else {
          dVar13 = (double)Rand();
          if (0.05 < dVar13) {
            prout(" survives photon blast.");
          }
          else {
            prout(" disappears.");
            quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x23;
            DAT_001207e8 = 0;
            DAT_001207e4 = 0;
            _DAT_001207e0 = 0;
            dropin(0x20,local_48,local_44);
          }
        }
        goto LAB_0010ccf3;
      }
    }
    iVar9 = iVar9 + 1;
  } while (iVar9 != 0x10);
  skip(1);
  prout("Torpedo missed.");
  goto LAB_0010ccf3;
switchD_0010ccbd_caseD_45:
  skip(1);
  proutn("Torpedo hits ");
  crmshp();
  prout(".");
  dVar16 = (double)Rand();
  dVar13 = (double)square((double)(iVar7 - param_3));
  dVar15 = (double)square((double)(iVar8 - param_4));
  dVar13 = dVar13 + dVar15;
  if (dVar13 < 0.0) {
    dVar13 = sqrt(dVar13);
  }
  else {
    dVar13 = SQRT(dVar13);
  }
  dVar14 = sin(dVar14 - dVar12);
  *param_5 = (ulong)((dVar16 * 100.0 + 700.0) -
                    dVar13 * 1000.0 * (double)((ulong)dVar14 & 0x7fffffffffffffff)) &
             0x7fffffffffffffff;
  newcnd();
  if (DAT_00120780 == 1) goto LAB_0010ccf3;
  dVar13 = (double)Rand();
  sincos((dVar13 - 0.5) * 2.5 + dVar12,&local_50,&local_58);
  dVar13 = (double)((ulong)local_58 & 0x7fffffffffffffff);
  if ((double)((ulong)local_58 & 0x7fffffffffffffff) <=
      (double)((ulong)local_50 & 0x7fffffffffffffff)) {
    dVar13 = (double)((ulong)local_50 & 0x7fffffffffffffff);
  }
  iVar9 = (int)((double)((ulong)local_50 ^ 0x8000000000000000) / dVar13 + (double)iVar7 + 0.5);
  if ((9 < iVar9 - 1U) || (iVar11 = (int)((double)iVar8 + local_58 / dVar13 + 0.5), 9 < iVar11 - 1U)
     ) goto LAB_0010ccf3;
  if (quad[(long)iVar11 + (long)iVar9 * 0xb] == ' ') {
    finish(0x14);
    goto LAB_0010ccf3;
  }
  if (quad[(long)iVar11 + (long)iVar9 * 0xb] != '.') goto LAB_0010ccf3;
  DAT_00120728 = iVar9;
  DAT_0012072c = iVar11;
  crmshp();
  goto LAB_0010d234;
  while( true ) {
    iVar10 = iVar10 + 1;
    lVar6 = lVar6 + 1;
    if (DAT_00120790 < (int)lVar6) break;
LAB_0010cf83:
    iVar10 = (int)lVar6;
    if ((*(int *)(kx + lVar6 * 4) == iVar7) && (*(int *)(ky + lVar6 * 4) == iVar8)) break;
  }
LAB_0010cf92:
  uVar2 = *(ulong *)(kpower + (long)iVar10 * 8);
  dVar16 = (double)Rand();
  dVar13 = (double)square((double)(iVar7 - param_3));
  dVar15 = (double)square((double)(iVar8 - param_4));
  dVar13 = dVar13 + dVar15;
  if (dVar13 < 0.0) {
    dVar13 = sqrt(dVar13);
  }
  else {
    dVar13 = SQRT(dVar13);
  }
  dVar14 = sin(dVar14 - dVar12);
  dVar14 = (double)((ulong)((dVar16 * 100.0 + 700.0) -
                           dVar13 * 1000.0 * (double)((ulong)dVar14 & 0x7fffffffffffffff)) &
                   0x7fffffffffffffff);
  dVar13 = (double)(uVar2 & 0x7fffffffffffffff);
  if (dVar14 <= (double)(uVar2 & 0x7fffffffffffffff)) {
    dVar13 = dVar14;
  }
  if (*(double *)(kpower + (long)iVar10 * 8) < 0.0) {
    dVar13 = (double)((ulong)dVar13 ^ 0x8000000000000000);
  }
  dVar13 = *(double *)(kpower + (long)iVar10 * 8) - dVar13;
  *(double *)(kpower + (long)iVar10 * 8) = dVar13;
  if (dVar13 == 0.0) {
    deadkl(iVar7,iVar8,iVar5,iVar7,iVar8);
  }
  else {
    crmena(1,iVar5,2,iVar7,iVar8);
    dVar13 = (double)Rand();
    sincos((dVar13 - 0.5) * 2.5 + dVar12,&local_50,&local_58);
    dVar13 = (double)((ulong)local_58 & 0x7fffffffffffffff);
    if ((double)((ulong)local_58 & 0x7fffffffffffffff) <=
        (double)((ulong)local_50 & 0x7fffffffffffffff)) {
      dVar13 = (double)((ulong)local_50 & 0x7fffffffffffffff);
    }
    iVar9 = (int)((double)((ulong)local_50 ^ 0x8000000000000000) / dVar13 + (double)iVar7 + 0.5);
    iVar11 = (int)((double)iVar8 + local_58 / dVar13 + 0.5);
    if ((iVar9 - 1U < 10) && (iVar11 - 1U < 10)) {
      if (quad[(long)iVar11 + (long)iVar9 * 0xb] == ' ') {
        prout(" buffeted into black hole.");
        deadkl(iVar7,iVar8,iVar5,iVar9,iVar11);
      }
      else if (quad[(long)iVar11 + (long)iVar9 * 0xb] == '.') {
        prout(" damaged--");
        *(int *)(kx + (long)iVar10 * 4) = iVar9;
        *(int *)(ky + (long)iVar10 * 4) = iVar11;
LAB_0010d234:
        quad[(long)iVar11 + (long)iVar9 * 0xb] = cVar3;
        quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x2e;
        proutn(" displaced by blast to");
        cramlc(2,iVar9,iVar11);
        skip(1);
        lVar6 = 1;
        if (0 < DAT_00120790) {
          do {
            dVar12 = (double)square((double)(DAT_00120728 - *(int *)(kx + lVar6 * 4)));
            dVar13 = (double)square((double)(DAT_0012072c - *(int *)(ky + lVar6 * 4)));
            dVar12 = dVar12 + dVar13;
            if (dVar12 < 0.0) {
              dVar12 = sqrt(dVar12);
            }
            else {
              dVar12 = SQRT(dVar12);
            }
            *(double *)(kavgd + lVar6 * 8) = dVar12;
            *(double *)(kdist + lVar6 * 8) = dVar12;
            lVar6 = lVar6 + 1;
          } while ((int)lVar6 <= DAT_00120790);
        }
        sortkl();
      }
      else {
        prout(" damaged but not destroyed.");
      }
    }
    else {
      prout(" damaged but not destroyed.");
    }
  }
  goto LAB_0010ccf3;
  while (lVar6 = lVar6 + 1, (int)lVar6 <= DAT_00120dcc) {
LAB_0010d39d:
    if ((iVar9 == (&DAT_00120f7c)[lVar6]) && (iVar5 == (&DAT_00120f94)[lVar6])) {
      (&DAT_00120f7c)[(int)lVar6] = (&DAT_00120f7c)[DAT_00120dcc];
      (&DAT_00120f94)[(int)lVar6] = (&DAT_00120f94)[DAT_00120dcc];
      break;
    }
  }
LAB_0010d3d5:
  quad[(long)iVar8 + (long)iVar7 * 0xb] = 0x2e;
  DAT_00120dcc = DAT_00120dcc + -1;
  DAT_0012073c = 0;
  DAT_00120738 = 0;
  piVar1 = (int *)((long)&d + ((long)iVar5 + 8 + (long)iVar9 * 9) * 4);
  *piVar1 = *piVar1 + -10;
  DAT_00120dd4 = DAT_00120dd4 + 1;
  newcnd();
LAB_0010ccf3:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void attack(int param_1)

{
  int iVar1;
  char cVar2;
  bool bVar3;
  ulong uVar4;
  int iVar5;
  long lVar6;
  uint uVar7;
  int iVar8;
  double *pdVar9;
  long in_FS_OFFSET;
  double dVar10;
  double dVar11;
  double dVar12;
  double dVar13;
  double dVar14;
  double local_80;
  double local_78;
  int local_70;
  int local_64;
  double local_58;
  int local_50;
  double local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (((DAT_001207b4 != 0) && (DAT_001207b8 == 0)) || (_DAT_001207c8 = 1, DAT_00120764 != 0))
  goto LAB_0010d956;
  if (_DAT_001207e0 != 0) {
    movetho();
  }
  local_50 = DAT_00120798;
  local_64 = DAT_00120798;
  if (DAT_00120798 != 0) {
    DAT_00120798 = 0;
    goto LAB_0010d956;
  }
  if ((((DAT_00120744 | DAT_00120794) != 0) && (DAT_00120760 == 0)) || (DAT_00120734 == 5)) {
    movcom();
  }
  if (DAT_00120790 == 0) goto LAB_0010d956;
  dVar10 = 1.0 / DAT_00120820;
  local_58 = 1.0;
  if (_DAT_00120768 == 1) {
    dVar11 = (double)Rand();
    local_58 = dVar11 * 0.5 + 0.25;
  }
  skip(1);
  cVar2 = (DAT_00120734 < 3) * '\x02';
  if (DAT_00120790 < 1) {
    if (DAT_00120838 <= 0.0) goto LAB_0010df66;
    if (DAT_00120714 != 0x44) goto LAB_0010d956;
    local_80 = 0.0;
    local_78 = 0.0;
LAB_0010df82:
    prout("***Enemies decide against attacking your ship.");
  }
  else {
    pdVar9 = (double *)(kpower + 8);
    local_70 = local_50;
    lVar6 = 1;
    local_80 = 0.0;
    local_78 = 0.0;
    do {
      if (0.0 < *pdVar9 || *pdVar9 == 0.0) {
        dVar11 = (double)Rand();
        if (DAT_00120714 == 0x44) {
          dVar11 = dVar11 * 0.25;
        }
        if (*pdVar9 <= 500.0 && *pdVar9 != 500.0) {
          dVar11 = dVar11 * 0.25;
        }
        iVar5 = *(int *)(kx + lVar6 * 4);
        iVar1 = *(int *)(ky + lVar6 * 4);
        iVar8 = (int)(char)quad[(long)iVar1 + (long)iVar5 * 0xb];
        if (iVar8 == 0x4b) {
          if ((dVar11 <= 0.0005) && (param_1 != 0)) goto LAB_0010dc7e;
LAB_0010d9bb:
          if (DAT_00120714 == 0x44) goto LAB_0010dbbe;
          dVar12 = (double)Rand();
          dVar11 = *pdVar9;
          local_48 = pow(dVar12 * 0.05 + 0.8,*(double *)(kavgd + lVar6 * 8));
          local_48 = local_48 * dVar11;
          *pdVar9 = dVar11 * 0.75;
          bVar3 = true;
        }
        else {
          if (param_1 == 0) goto LAB_0010d9bb;
          if (iVar8 == 0x43) {
            if (dVar11 <= 0.015) goto LAB_0010dc7e;
            goto LAB_0010d9bb;
          }
          if (iVar8 == 0x52) {
            if (0.3 < dVar11) goto LAB_0010d9bb;
          }
          else if ((iVar8 == 0x53) && (0.07000000000000001 < dVar11)) goto LAB_0010d9bb;
LAB_0010dc7e:
          dVar11 = atan2((double)DAT_0012072c - (double)iVar1,(double)iVar5 - (double)DAT_00120728);
          local_48 = 0.0;
          proutn("***TORPEDO INCOMING");
          if (DAT_001201e8 <= 0.0) {
            proutn(" From ");
            crmena(0,iVar8,cVar2,iVar5,iVar1);
          }
          prout("--");
          dVar12 = (double)Rand();
          dVar13 = (double)Rand();
          dVar12 = (dVar12 + dVar13) * 0.5 - 0.5;
          torpedo(dVar11 * 1.90985,*pdVar9 * 0.002 * dVar12 + dVar12,iVar5,iVar1,&local_48);
          if (d._4_4_ == 0) {
            finish(0);
          }
          if ((*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) == 1000)
             || (DAT_00120764 != 0)) goto LAB_0010d956;
          local_70 = 1;
          bVar3 = false;
          if (local_48 == 0.0) goto LAB_0010dbbe;
        }
        if ((DAT_00120848 != 0.0) || (_DAT_00120768 != 0)) {
          dVar11 = dVar10 * DAT_00120840;
          if (dVar11 < 0.1) {
            dVar11 = local_58 * 0.1 * local_48 + 1.0;
            if (DAT_00120840 < dVar11 * 0.8) {
              DAT_00120840 = DAT_00120840 - DAT_00120840;
              local_48 = local_48 - dVar11;
            }
            else {
              DAT_00120840 = DAT_00120840 - dVar11 * 0.8;
              local_48 = local_48 - dVar11;
            }
          }
          else {
            dVar13 = local_58 * dVar11 * local_48 + 1.0;
            dVar14 = dVar13 * 0.8;
            dVar12 = DAT_00120840;
            if (dVar14 <= DAT_00120840) {
              dVar12 = dVar14;
            }
            DAT_00120840 = DAT_00120840 - dVar12;
            local_48 = local_48 - dVar13;
            if ((0.1 < dVar11) && (local_48 < DAT_00120838 * 0.005)) {
              local_70 = 1;
              local_50 = 1;
              goto LAB_0010dbbe;
            }
          }
        }
        dVar11 = local_48;
        cramf(local_48,0,2);
        proutn(" unit hit");
        if (((0.0 < DAT_001201e8) && (bVar3)) || (DAT_00120734 < 3)) {
          proutn(" on the ");
          crmshp();
        }
        if ((DAT_001201e8 <= 0.0) && (bVar3)) {
          proutn(" from ");
          crmena(0,iVar8,cVar2,iVar5,iVar1);
        }
        skip(1);
        dVar12 = dVar11;
        if (dVar11 <= local_78) {
          dVar12 = local_78;
        }
        local_80 = dVar11 + local_80;
        fry(dVar11);
        __printf_chk(dVar11,DAT_00120838,1,"Hit %g energy %g\n");
        DAT_00120838 = DAT_00120838 - dVar11;
        local_70 = 1;
        local_50 = 1;
        local_64 = 1;
        local_78 = dVar12;
      }
LAB_0010dbbe:
      lVar6 = lVar6 + 1;
      pdVar9 = pdVar9 + 1;
    } while ((int)lVar6 <= DAT_00120790);
    if (DAT_00120838 <= 0.0) {
LAB_0010df66:
      finish(4);
      goto LAB_0010d956;
    }
    if ((local_70 == 0) && (DAT_00120714 == 0x44)) goto LAB_0010df82;
  }
  if (local_50 != 0) {
    dVar10 = dVar10 * 100.0 * DAT_00120840;
    if (local_64 == 0) {
      proutn("Enemy attack reduces shield strength to ");
    }
    else {
      skip(1);
      proutn("Energy left ");
      cramf(DAT_00120838,0,2);
      proutn("    shields ");
      if (DAT_00120848 == 0.0) {
        if (DAT_00120220 == 0.0) {
          proutn("down, ");
        }
        else {
          proutn("damaged, ");
        }
      }
      else {
        proutn(&DAT_0011a378);
      }
    }
    crami((int)(dVar10 + 0.5),1);
    proutn("%   torpedoes left ");
    crami(DAT_00120718,1);
    skip(1);
    if ((200.0 <= local_78) || (500.0 <= local_80)) {
      dVar10 = (double)Rand();
      iVar5 = (int)(dVar10 * local_80 * 0.015);
      if (1 < iVar5) {
        skip(1);
        proutn("Mc Coy-  \"Sickbay to bridge.  We suffered ");
        crami(iVar5,1);
        prout(" casualties");
        prout("   in that last attack.\"");
        DAT_00120748 = DAT_00120748 + iVar5;
      }
    }
    uVar7 = DAT_00120790 + 1;
    uVar4 = 1;
    if (0 < DAT_00120790) {
      do {
        *(undefined8 *)(kavgd + uVar4 * 8) = *(undefined8 *)(kdist + uVar4 * 8);
        uVar4 = uVar4 + 1;
      } while (uVar4 != uVar7);
    }
    sortkl();
  }
LAB_0010d956:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void photon(void)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  ulong uVar7;
  long in_FS_OFFSET;
  double dVar8;
  double dVar9;
  double local_80;
  undefined local_70 [8];
  undefined8 auStack_68 [5];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  DAT_00120754 = 0;
  if (DAT_00120200 == 0.0) {
    if (DAT_00120718 == 0) {
      prout("No torpedoes left.");
      chew();
    }
    else {
      iVar2 = scan();
      while (iVar2 != 1) {
        if (iVar2 != 0) {
          iVar2 = (int)(aaitem + 0.5);
          if (iVar2 < 1) {
            chew();
            goto LAB_0010e1d5;
          }
          if (iVar2 < 4) {
            if (iVar2 <= DAT_00120718) {
              puVar5 = auStack_68 + 1;
              iVar4 = 1;
              puVar6 = puVar5;
              goto LAB_0010e28c;
            }
          }
          else {
            prout("Maximum of 3 torpedoes per burst.");
          }
          chew();
        }
        crami(DAT_00120718,1);
        prout(" torpedoes left.");
        proutn("Number of torpedoes to fire- ");
        iVar2 = scan();
      }
      huh();
    }
  }
  else {
    prout("Photon tubes damaged.");
    chew();
  }
  goto LAB_0010e1d5;
  while( true ) {
    if (iVar3 != 2) {
      huh();
      goto LAB_0010e1d5;
    }
    iVar3 = scan();
    if (iVar3 != 2) {
      huh();
      goto LAB_0010e1d5;
    }
    iVar3 = targetcheck(dVar8,aaitem,puVar6);
    if (iVar3 != 0) goto LAB_0010e1d5;
    iVar4 = iVar4 + 1;
    puVar6 = puVar6 + 1;
    if (iVar2 < iVar4) break;
LAB_0010e28c:
    iVar3 = scan();
    dVar8 = aaitem;
    if ((iVar4 == 1) && (iVar3 == 0)) {
      chew();
      iVar4 = 1;
      goto LAB_0010e56a;
    }
    if ((iVar4 == 2) && (iVar3 == 0)) {
      if (1 < iVar2) {
        auStack_68[2] = auStack_68[1];
        if (iVar2 == 3) {
          auStack_68[3] = auStack_68[1];
        }
        chew();
        goto LAB_0010e5e9;
      }
      break;
    }
  }
  chew();
  goto LAB_0010e5e9;
  while( true ) {
    chew();
    iVar3 = targetcheck(dVar8,dVar9,puVar5);
    if (iVar3 != 0) goto LAB_0010e1d5;
    iVar4 = iVar4 + 1;
    puVar5 = puVar5 + 1;
    if (iVar2 < iVar4) break;
LAB_0010e56a:
    proutn("Target sector for torpedo number");
    crami(iVar4,2);
    proutn("- ");
    iVar3 = scan();
    dVar8 = aaitem;
    if (iVar3 != 2) {
      huh();
      goto LAB_0010e1d5;
    }
    iVar3 = scan();
    dVar9 = aaitem;
    if (iVar3 != 2) {
      huh();
      goto LAB_0010e1d5;
    }
  }
LAB_0010e5e9:
  DAT_00120754 = 1;
  uVar7 = 1;
LAB_0010e4b3:
  iVar4 = (int)uVar7;
  if (DAT_00120714 != 0x44) {
    DAT_00120718 = DAT_00120718 + -1;
  }
  dVar8 = (double)Rand();
  dVar9 = (double)Rand();
  local_80 = (dVar8 + dVar9) * 0.5 - 0.5;
  bVar1 = false;
  if (0.47 <= (double)((ulong)local_80 & 0x7fffffffffffffff)) {
    dVar8 = (double)Rand();
    local_80 = (dVar8 + 1.2) * local_80;
    if (iVar2 < 2) {
      prouts("***TORPEDO MISFIRES.");
    }
    else {
      prouts("***TORPEDO NUMBER");
      crami(uVar7 & 0xffffffff,2);
      prouts(" MISFIRES.");
    }
    skip(1);
    if (iVar4 < iVar2) {
      prout("  Remainder of burst aborted.");
    }
    dVar8 = (double)Rand();
    if (dVar8 <= 0.2) {
      prout("***Photon tubes damaged by misfire.");
      dVar8 = DAT_00120890;
      dVar9 = (double)Rand();
      DAT_00120200 = (dVar9 + dVar9 + 1.0) * dVar8;
LAB_0010e3bf:
      if (d._4_4_ == 0) {
        finish(0);
      }
LAB_0010e1d5:
      if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
        __stack_chk_fail();
      }
      return;
    }
    bVar1 = true;
  }
  if (DAT_001207b4 == 0) {
    if ((DAT_00120848 != 0.0) || (DAT_00120714 == 0x44)) {
      local_80 = (DAT_00120840 * 0.0001 + 1.0) * local_80;
    }
  }
  else {
    local_80 = local_80 * 1.2;
  }
  if (iVar2 == 1) {
    skip(1);
    proutn("Torpedo track- ");
  }
  else {
    skip(1);
    proutn("Track for torpedo number");
    crami(uVar7 & 0xffffffff,2);
    proutn(&DAT_0011a46c);
  }
  torpedo(auStack_68[uVar7],local_80,DAT_00120728,DAT_0012072c,local_70);
  if ((DAT_00120764 != 0) ||
     (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) == 1000))
  goto LAB_0010e1d5;
  uVar7 = uVar7 + 1;
  if ((iVar2 < iVar4 + 1) || (bVar1)) goto LAB_0010e3bf;
  goto LAB_0010e4b3;
}



void hittem(long param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  double dVar4;
  int iVar5;
  long lVar6;
  long lVar7;
  int iVar8;
  double dVar9;
  double dVar10;
  
  iVar5 = DAT_00120790;
  skip(1);
  if (0 < iVar5) {
    lVar7 = 1;
    iVar8 = 1;
    do {
      dVar4 = *(double *)(param_1 + lVar7 * 8);
      if (dVar4 != 0.0) {
        dVar9 = (double)Rand();
        dVar10 = pow(dVar9 * 0.01 + 0.9,*(double *)(kdist + (long)iVar8 * 8));
        dVar10 = dVar10 * dVar4;
        dVar4 = *(double *)(kpower + (long)iVar8 * 8);
        dVar9 = dVar10 + dVar10;
        if ((double)((ulong)dVar4 & 0x7fffffffffffffff) <= dVar10 + dVar10) {
          dVar9 = (double)((ulong)dVar4 & 0x7fffffffffffffff);
        }
        if (dVar4 < 0.0) {
          dVar9 = (double)((ulong)dVar9 ^ 0x8000000000000000);
        }
        dVar9 = dVar4 - dVar9;
        lVar6 = (long)iVar8;
        *(double *)(kpower + lVar6 * 8) = dVar9;
        iVar2 = *(int *)(kx + lVar6 * 4);
        iVar3 = *(int *)(ky + lVar6 * 4);
        if (dVar10 <= 0.005) {
          proutn("Very small hit on ");
        }
        else {
          cramf(0,2);
          proutn(" unit hit on ");
        }
        cVar1 = quad[(long)iVar3 + (long)iVar2 * 0xb];
        crmena(0,(int)cVar1,2,iVar2,iVar3);
        skip(1);
        if (dVar9 == 0.0) {
          deadkl(iVar2,iVar3,(int)cVar1,iVar2,iVar3);
          if (d._4_4_ == 0) {
            finish(0);
          }
          if (DAT_00120764 != 0) {
            return;
          }
          iVar8 = iVar8 + -1;
        }
        else if (((0.0 < dVar9) && (dVar10 = (double)Rand(), 0.9 <= dVar10)) &&
                (dVar10 = (double)Rand(), dVar9 <= (dVar10 * 0.4 + 0.4) * dVar4)) {
          proutn("***Mr. Spock-  \"Captain, the vessel at");
          cramlc(2,iVar2,iVar3);
          skip(1);
          prout("   has just lost its firepower.\"");
          *(ulong *)(kpower + (long)iVar8 * 8) = (ulong)dVar9 ^ 0x8000000000000000;
        }
      }
      iVar8 = iVar8 + 1;
      lVar7 = lVar7 + 1;
    } while ((int)lVar7 <= iVar5);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void phasers(void)

{
  ulong uVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  bool bVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  long lVar10;
  int iVar11;
  undefined4 uVar12;
  long in_FS_OFFSET;
  bool bVar13;
  double dVar14;
  double dVar15;
  double dVar16;
  double dVar17;
  double local_110;
  int local_104;
  double local_100;
  double local_e8 [21];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  skip(1);
  dVar15 = DAT_00120238;
  dVar16 = DAT_001201e8;
  if (DAT_00120714 == 0x44) {
    prout("Phasers can\'t be fired through base shields.");
    chew();
  }
  else if (DAT_001201f8 == 0.0) {
    local_104 = 0;
    if (DAT_00120848 == 0.0) {
LAB_0010e918:
      bVar5 = dVar16 + dVar15 <= 0.0;
      DAT_00120754 = 1;
      bVar6 = false;
LAB_0010eb90:
      do {
        iVar7 = scan();
        if (iVar7 != 1) {
          if (iVar7 == 2) {
            if (DAT_00120790 == 0) {
              prout("Energy will be expended into space.");
            }
            else {
              if (0.0 < dVar16 + dVar15) goto LAB_0010ebb7;
              if (!bVar5) goto LAB_0010eaff;
            }
          }
          else {
            if (DAT_00120790 != 0) {
              if (!bVar5) {
LAB_0010ebb7:
                chew();
                if (DAT_00120238 == 0.0) {
                  skip(1);
                  prouts("---WORKING---");
                  skip(1);
                  prout("Short-range-sensors-damaged");
                  prout("Insufficient-data-for-automatic-phaser-fire");
                  prout("Manual-fire-must-be-used");
                  skip(1);
                  iVar7 = 0;
                }
                else {
                  prout("Battle computer damaged, manual file only.");
                  iVar7 = 0;
                }
                goto LAB_0010ea2b;
              }
              proutn("Manual or automatic? ");
              goto LAB_0010eb90;
            }
            prout("Energy will be expended into space.");
          }
LAB_0010eb61:
          if (iVar7 == 1) {
            iVar8 = isit(&DAT_0011cc51);
            if (iVar8 != 0) {
              iVar7 = scan();
              bVar6 = true;
              goto LAB_0010eb6a;
            }
          }
          else {
LAB_0010eb6a:
            bVar5 = bVar6;
            if (iVar7 == 2) goto LAB_0010eca9;
          }
          bVar5 = bVar6;
          if (DAT_00120790 != 0) {
            proutn("Phasers locked on target. Energy available =");
            dVar16 = DAT_00120838;
            if (local_104 != 0) {
              dVar16 = DAT_00120838 - 200.0;
            }
            cramf(dVar16,1,2);
            skip(1);
          }
          goto LAB_0010eca9;
        }
        iVar7 = isit("manual");
        if (iVar7 != 0) {
          if (DAT_00120790 == 0) {
            prout("There is no enemy present to select.");
            chew();
            iVar7 = 0;
            goto LAB_0010eb61;
          }
          iVar7 = scan();
LAB_0010ea2b:
          if (DAT_00120790 < 1) goto LAB_0010f34c;
          dVar16 = 0.0;
          if (local_104 != 0) {
            dVar16 = 200.0;
          }
          bVar13 = true;
          iVar11 = 1;
          iVar8 = 0;
          local_110 = 0.0;
          goto LAB_0010f1f4;
        }
        iVar7 = isit("automatic");
        if (iVar7 != 0) {
          if (bVar5) {
            if (DAT_00120790 == 0) goto LAB_0010ea95;
          }
          else {
            if (DAT_00120790 != 0) goto LAB_0010ebb7;
LAB_0010ea95:
            prout("Energy will be expended into space.");
          }
          iVar7 = scan();
          goto LAB_0010eb61;
        }
        iVar7 = isit(&DAT_0011cc51);
        if (iVar7 == 0) goto LAB_0010ead1;
        bVar6 = true;
      } while( true );
    }
    if (_DAT_00120248 == 0.0) {
      if (200.0 < DAT_00120838) {
        prout("Weapons Officer Sulu-  \"High-speed shield control enabled, sir.\"");
        local_104 = 1;
        goto LAB_0010e918;
      }
      prout("Insufficient energy to activate high-speed shield control.");
      chew();
    }
    else {
      prout("High speed shield control damaged.");
      chew();
    }
  }
  else {
    prout("Phaser control damaged.");
    chew();
  }
  goto LAB_0010eb1e;
LAB_0010ead1:
  huh();
  DAT_00120754 = 0;
  goto LAB_0010eb1e;
LAB_0010eca9:
  do {
    while (dVar16 = aaitem, iVar7 != 2) {
      chew();
      proutn("Units to fire=");
      iVar7 = scan();
    }
    if (local_104 == 0) {
      dVar15 = DAT_00120838;
      if (DAT_00120838 <= aaitem) {
        proutn("Energy available= ");
        dVar15 = DAT_00120838;
        goto LAB_0010f401;
      }
    }
    else {
      if (DAT_00120838 - 200.0 <= aaitem) {
        proutn("Energy available= ");
        dVar15 = DAT_00120838 - 200.0;
LAB_0010f401:
        cramf(dVar15,1,2);
        skip(1);
        iVar7 = local_104;
        dVar15 = DAT_00120838;
        if (local_104 == 0) goto LAB_0010ecef;
        iVar7 = 0;
      }
      dVar15 = DAT_00120838 - 200.0;
    }
LAB_0010ecef:
  } while (dVar15 <= dVar16);
  local_110 = dVar16;
  if (dVar16 <= 0.0) {
    DAT_00120754 = 0;
    chew();
    goto LAB_0010eb1e;
  }
  iVar7 = scan();
  bVar6 = bVar5;
  if (iVar7 == 1) {
    iVar7 = isit(&DAT_0011cc51);
    bVar6 = true;
    if (iVar7 == 0) {
      bVar6 = bVar5;
    }
  }
  if (local_104 != 0) {
    DAT_00120838 = DAT_00120838 - 200.0;
    iVar7 = checkshctrl(dVar16);
    if (iVar7 != 0) goto LAB_0010eb1e;
  }
  chew();
  DAT_00120838 = DAT_00120838 - dVar16;
  if (DAT_00120790 != 0) {
    if (DAT_00120790 < 1) {
      local_100 = dVar16;
      dVar16 = 0.0;
    }
    else {
      local_100 = dVar16;
      lVar10 = 1;
      dVar16 = 0.0;
      do {
        local_e8[lVar10] = 0.0;
        if (0.0 < local_100) {
          uVar1 = *(ulong *)(kpower + lVar10 * 8);
          dVar15 = pow(0.9,*(double *)(kdist + lVar10 * 8));
          dVar17 = (double)(uVar1 & 0x7fffffffffffffff) / (dVar15 + dVar15);
          local_e8[lVar10] = dVar17;
          dVar15 = (double)Rand();
          dVar15 = (dVar15 * 0.05 + 0.01) * dVar17;
          dVar14 = local_100 - (dVar17 + dVar15);
          if (dVar14 <= 0.0) {
            if (local_100 < dVar17) {
              local_e8[lVar10] = local_100;
            }
            dVar15 = 0.0;
          }
          else if (dVar14 <= 0.0) {
            dVar15 = 0.0;
          }
          dVar16 = dVar16 + dVar15;
          local_100 = dVar14;
        }
        lVar10 = lVar10 + 1;
      } while ((int)lVar10 <= DAT_00120790);
    }
    if (0.0 < local_100) {
      dVar16 = dVar16 + local_100;
    }
    hittem(local_e8);
  }
  if (0.0 < dVar16) {
    if (DAT_00120764 != 0) goto LAB_0010eb1e;
    if (_DAT_001207e0 == 0) {
      cramf(dVar16,0,2);
      prout(" expended on empty space.");
    }
    else {
      proutn("*** Tholian web absorbs ");
      if (0 < DAT_00120790) {
        proutn("excess ");
      }
      prout("phaser energy.");
    }
  }
  goto LAB_0010eaff;
LAB_0010f1f4:
  do {
    iVar3 = *(int *)(kx + (long)iVar11 * 4);
    iVar4 = *(int *)(ky + (long)iVar11 * 4);
    bVar2 = quad[(long)iVar4 + (long)iVar3 * 0xb];
    if (bVar13) {
      proutn("Energy available= ");
      cramf((DAT_00120838 - 0.006) - dVar16,0,2);
      skip(1);
      local_110 = 0.0;
    }
    if (DAT_001201e8 == 0.0) {
LAB_0010f24e:
      if (iVar7 == 0) {
        chew();
        if ((iVar8 < iVar11) && (bVar5)) {
          uVar1 = *(ulong *)(kpower + (long)iVar11 * 8);
          dVar15 = pow(0.9,*(double *)(kdist + (long)iVar11 * 8));
          dVar14 = (double)Rand();
          uVar12 = 0;
          proutn(&DAT_0011a571);
          crami(CONCAT44(uVar12,(int)((dVar14 * 0.05 + 1.01) *
                                      ((double)(uVar1 & 0x7fffffffffffffff) / (dVar15 + dVar15)) +
                                     1.0)),1);
          proutn(&DAT_0011a573);
          iVar8 = iVar11;
        }
        proutn("units to fire at ");
        crmena(0,(int)(char)bVar2,2,iVar3,iVar4);
        proutn(&DAT_0011a589);
        iVar7 = scan();
        if (iVar7 == 1) goto LAB_0010f17b;
        bVar13 = iVar11 == 1;
        if (iVar7 != 0) goto LAB_0010f25f;
      }
      else if (iVar7 == 1) {
LAB_0010f17b:
        iVar7 = isit(&DAT_0011cc51);
        if (iVar7 == 0) {
          huh();
          DAT_00120754 = 0;
          goto LAB_0010eb1e;
        }
        iVar7 = scan();
        bVar13 = false;
        bVar6 = true;
      }
      else {
LAB_0010f25f:
        if (aaitem < 0.0) {
          DAT_00120754 = 0;
          chew();
          goto LAB_0010eb1e;
        }
        local_e8[iVar11] = aaitem;
        local_110 = aaitem + local_110;
        dVar15 = DAT_00120838;
        if (local_104 != 0) {
          dVar15 = DAT_00120838 - 200.0;
        }
        if (dVar15 <= local_110) {
          prout("Available energy exceeded -- try again.");
          chew();
          iVar7 = 0;
          bVar13 = true;
          iVar11 = 1;
        }
        else {
          iVar7 = scan();
          iVar11 = iVar11 + 1;
          bVar13 = false;
        }
      }
    }
    else {
      iVar9 = DAT_00120728 - iVar3;
      if (iVar9 < 1) {
        iVar9 = -iVar9;
      }
      if (iVar9 < 2) {
        iVar9 = DAT_0012072c - iVar4;
        if (iVar9 < 1) {
          iVar9 = -iVar9;
        }
        if (iVar9 < 2) goto LAB_0010f24e;
      }
      if ((bVar2 & 0xef) != 0x43) goto LAB_0010f24e;
      cramen((int)(char)bVar2);
      prout(" can\'t be located without short range scan.");
      chew();
      local_e8[iVar11] = 0.0;
      iVar11 = iVar11 + 1;
      iVar7 = 0;
      bVar13 = false;
    }
  } while (iVar11 <= DAT_00120790);
  if (local_110 == 0.0) {
LAB_0010f34c:
    DAT_00120754 = 0;
    chew();
    goto LAB_0010eb1e;
  }
  bVar5 = bVar6;
  if (iVar7 == 1) {
    iVar7 = isit(&DAT_0011cc51);
    bVar5 = true;
    if (iVar7 == 0) {
      bVar5 = bVar6;
    }
  }
  bVar6 = bVar5;
  DAT_00120838 = DAT_00120838 - local_110;
  chew();
  if (local_104 != 0) {
    DAT_00120838 = DAT_00120838 - 200.0;
    iVar7 = checkshctrl(local_110);
    if (iVar7 != 0) goto LAB_0010eb1e;
  }
  hittem(local_e8);
  DAT_00120754 = 1;
LAB_0010eaff:
  if (DAT_00120764 == 0) {
    if (local_104 != 0) {
      skip(1);
      if (bVar6) {
        DAT_00120848 = 0.0;
      }
      else {
        dVar16 = (double)Rand();
        if (dVar16 < 0.99) {
          prout("Shields raised.");
        }
        else {
          prout("Sulu-  \"Sir, the high-speed shield control has malfunctioned . . .");
          prouts("         CLICK   CLICK   POP  . . .");
          prout(" No  response, sir!");
          DAT_00120848 = 0.0;
        }
      }
    }
    overheat(local_110);
  }
LAB_0010eb1e:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong selectklingon(void)

{
  ulong uVar1;
  ulong uVar2;
  double dVar3;
  
  uVar2 = 1;
  if (1 < DAT_00120790) {
    uVar1 = 1;
    dVar3 = 1000000.0;
    do {
      if ((quad[(long)*(int *)(ky + uVar1 * 4) + (long)*(int *)(kx + uVar1 * 4) * 0xb] != 'R') &&
         (*(double *)(kpower + uVar1 * 8) < dVar3)) {
        uVar2 = uVar1 & 0xffffffff;
        dVar3 = *(double *)(kpower + uVar1 * 8);
      }
      uVar1 = uVar1 + 1;
    } while (uVar1 != DAT_00120790 + 1);
    return uVar2;
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void capture(void)

{
  int iVar1;
  int iVar2;
  double dVar3;
  double dVar4;
  
  DAT_00120754 = 0;
  DAT_00120878 = 0;
  if (DAT_001211ec == 0) {
    puts("Security reports the brig is already full.");
  }
  else if (((DAT_00120714 != 0x44) && (0.0 < DAT_00120228)) || (DAT_001207b4 != 0)) {
    puts("Uhura- \"We have no subspace radio communication, sir.\"");
  }
  else if (_DAT_00120240 == 0.0) {
    if (DAT_00120740 < 1) {
      puts("Uhura- \"Getting no response, sir.\"");
    }
    else {
      iVar1 = selectklingon();
      DAT_00120878 = 0x3fa999999999999a;
      DAT_00120754 = 1;
      dVar3 = DAT_00120838 / ((double)DAT_00120790 * *(double *)(kpower + (long)iVar1 * 8));
      dVar4 = (double)Rand();
      if (dVar4 * 100.0 < (double)(int)(dVar3 * 2.5)) {
        __printf_chk(1,"Klingon captain at %d,%d surrenders\n",*(undefined4 *)(kx + (long)iVar1 * 4)
                     ,*(undefined4 *)(ky + (long)iVar1 * 4));
        dVar3 = (double)Rand();
        iVar2 = (int)(dVar3 * 200.0);
        if (0 < iVar2) {
          __printf_chk(1,"%d Klingons commit suicide rather than be taken captive\n",200 - iVar2);
        }
        if (DAT_001211ec < iVar2) {
          __printf_chk(1,"%d Klingons die because there is no room for them in the brig.\n",
                       iVar2 - DAT_001211ec);
          iVar2 = DAT_001211ec;
        }
        DAT_001211ec = DAT_001211ec - iVar2;
        __printf_chk(1,"%d captives taken\n",iVar2);
        iVar2 = *(int *)(ky + (long)iVar1 * 4);
        iVar1 = *(int *)(kx + (long)iVar1 * 4);
        deadkl(iVar1,iVar2,(int)(char)quad[(long)iVar2 + (long)iVar1 * 0xb],iVar1,iVar2);
        if (d._4_4_ == 0) {
          finish(0);
        }
      }
      else {
        puts("Fat chance, captain");
      }
    }
  }
  else {
    puts("Scotty- \"Transporter damaged, sir.\"");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void snova(int param_1,int param_2)

{
  long lVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  char *pcVar7;
  long lVar8;
  char *pcVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  int *piVar14;
  long lVar15;
  int iVar16;
  undefined *puVar17;
  int iVar18;
  int *piVar19;
  int iVar20;
  int iVar21;
  int iVar22;
  double dVar23;
  double dVar24;
  
  iVar22 = param_1;
  if (param_2 == 0) {
    puVar17 = &DAT_00120de4;
    iVar22 = 0;
    iVar11 = DAT_001207f0;
    iVar12 = DAT_001207f4;
    if (param_1 != 1) {
      do {
        lVar8 = 0;
        do {
          iVar22 = iVar22 + *(int *)(puVar17 + lVar8 * 4 + 0x24) % 10;
          lVar8 = lVar8 + 1;
        } while (lVar8 != 8);
        puVar17 = puVar17 + 0x24;
      } while (puVar17 != &DAT_00120f04);
      if (iVar22 == 0) {
        return;
      }
      dVar23 = (double)Rand();
      iVar22 = (int)((double)iVar22 * dVar23 + 1.0);
      piVar19 = &DAT_00120e0c;
      iVar11 = 1;
      do {
        iVar22 = (iVar22 + (piVar19[-1] / 10) * 10) - piVar19[-1];
        if (iVar22 < 1) {
          iVar12 = 1;
          goto LAB_0010f7dc;
        }
        iVar12 = 2;
        piVar14 = piVar19;
        do {
          iVar22 = (iVar22 + (*piVar14 / 10) * 10) - *piVar14;
          if (iVar22 < 1) goto LAB_0010f7dc;
          iVar12 = iVar12 + 1;
          piVar14 = piVar14 + 1;
        } while (iVar12 != 9);
        iVar11 = iVar11 + 1;
        piVar19 = piVar19 + 9;
      } while (iVar11 != 9);
      iVar12 = 9;
    }
LAB_0010f7dc:
    if (((DAT_00120724 != iVar12) || (DAT_00120724 != iVar11)) || (DAT_00120760 != 0)) {
      if (((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) {
        skip(1);
        proutn("Message from Starfleet Command       Stardate ");
        cramf(DAT_001211f0,0,1);
        skip(1);
        proutn("     Supernova in");
        cramlc(1,iVar11,iVar12);
        prout("; caution advised.");
      }
      goto LAB_0010fded;
    }
    dVar23 = (double)Rand();
    iVar11 = (int)((double)(*(int *)((long)&d + ((long)iVar12 + 8 + (long)iVar11 * 9) * 4) % 10) *
                   dVar23 + 1.0);
    pcVar9 = quad + 0xc;
    iVar22 = 1;
    do {
      param_2 = 1;
      pcVar7 = pcVar9;
      do {
        if ((*pcVar7 == '*') && (iVar11 = iVar11 + -1, iVar11 == 0)) goto LAB_0010fd51;
        param_2 = param_2 + 1;
        pcVar7 = pcVar7 + 1;
      } while (param_2 != 10);
      if (iVar11 == 0) goto LAB_0010fd51;
      iVar22 = iVar22 + 1;
      pcVar9 = pcVar9 + 0xb;
    } while (iVar22 != 10);
    param_2 = 10;
  }
LAB_0010fd51:
  skip(1);
  prouts("***RED ALERT!  RED ALERT!");
  skip(1);
  proutn("***Incipient supernova detected at");
  cramlc(2,iVar22,param_2);
  skip(1);
  iVar12 = DAT_00120724;
  iVar11 = DAT_00120720;
  dVar23 = (double)square((double)(iVar22 - DAT_00120728));
  dVar24 = (double)square((double)(param_2 - DAT_0012072c));
  if (dVar23 + dVar24 <= 2.1) {
    proutn("Emergency override attempts t");
    prouts("***************");
    skip(1);
    stars();
    DAT_00120764 = 1;
  }
LAB_0010fded:
  iVar22 = *(int *)((long)&d + ((long)iVar12 + 8 + (long)iVar11 * 9) * 4);
  iVar10 = iVar22 / 100;
  iVar16 = d._4_4_ - iVar10;
  iVar20 = 0;
  if ((DAT_001210f0 == iVar11) && (DAT_001210f4 == iVar12)) {
    _DAT_001207b0 = 0;
    DAT_001207ac = 0;
    DAT_001210f4 = 0;
    DAT_001210f0 = 0;
    _DAT_001210f8 = 0;
    iVar10 = iVar10 + -1;
    future._56_8_ = 0x46293e5939a08cea;
    future._48_8_ = 0x46293e5939a08cea;
    iVar20 = 1;
  }
  d._4_4_ = iVar16;
  if (DAT_00120dc8 < 1) {
    iVar21 = 0;
  }
  else {
    lVar8 = 1;
    do {
      if ((*(int *)(&DAT_00120f24 + lVar8 * 4) == iVar11) &&
         (*(int *)(&DAT_00120f50 + lVar8 * 4) == iVar12)) {
        lVar1 = (long)DAT_00120dc8 + 0x58;
        *(undefined4 *)(&DAT_00120f24 + (long)(int)lVar8 * 4) =
             *(undefined4 *)((long)&d + lVar1 * 4 + 4);
        lVar15 = (long)DAT_00120dc8 + 100;
        *(undefined4 *)(&DAT_00120f50 + (long)(int)lVar8 * 4) =
             *(undefined4 *)((long)&d + lVar15 * 4);
        *(undefined4 *)((long)&d + lVar15 * 4) = 0;
        *(undefined4 *)((long)&d + lVar1 * 4 + 4) = 0;
        DAT_00120dc8 = DAT_00120dc8 + -1;
        iVar10 = iVar10 + -1;
        iVar21 = 1;
        if (DAT_00120dc8 == 0) {
          future._16_8_ = 0x46293e5939a08cea;
        }
        goto LAB_0010fabf;
      }
      lVar8 = lVar8 + 1;
    } while ((int)lVar8 <= DAT_00120dc8);
    iVar21 = 0;
  }
LAB_0010fabf:
  lVar8 = (long)iVar12 + 0x78 + (long)iVar11 * 9;
  iVar18 = (&DAT_00120dcc)[lVar8];
  (&DAT_00120dcc)[lVar8] = 0;
  iVar2 = iVar18 / 10;
  DAT_00121100 = DAT_00121100 - iVar2;
  iVar18 = iVar18 % 10;
  if ((iVar18 != 0) && (0 < DAT_0012078c)) {
    piVar19 = &DAT_00121120;
    uVar13 = DAT_0012078c - 1;
    do {
      uVar5 = nulplanet._12_4_;
      uVar4 = nulplanet._8_4_;
      uVar3 = nulplanet._4_4_;
      if ((*piVar19 == iVar11) && (piVar19[1] == iVar12)) {
        *piVar19 = nulplanet._0_4_;
        piVar19[1] = uVar3;
        piVar19[2] = uVar4;
        piVar19[3] = uVar5;
        piVar19[4] = nulplanet._16_4_;
      }
      piVar19 = piVar19 + 5;
    } while (piVar19 != &DAT_00121134 + (ulong)uVar13 * 5);
  }
  if (0 < DAT_00120dcc) {
    lVar8 = 1;
    do {
      if (((&DAT_00120f7c)[lVar8] == iVar11) && ((&DAT_00120f94)[lVar8] == iVar12)) {
        lVar1 = (long)DAT_00120dcc + 0x6c;
        (&DAT_00120f7c)[(int)lVar8] = (&DAT_00120dcc)[lVar1];
        lVar15 = (long)DAT_00120dcc + 0x74;
        (&DAT_00120f94)[(int)lVar8] = *(undefined4 *)((long)&d + lVar15 * 4 + 4);
        *(undefined4 *)((long)&d + lVar15 * 4 + 4) = 0;
        (&DAT_00120dcc)[lVar1] = 0;
        DAT_00120dcc = DAT_00120dcc + -1;
        break;
      }
      lVar8 = lVar8 + 1;
    } while ((int)lVar8 <= DAT_00120dcc);
  }
  iVar6 = DAT_00120720;
  if (param_1 != 0) {
    iVar22 = iVar22 % 100;
    DAT_00120dd0 = DAT_00120dd0 + iVar22 % 10;
    DAT_00120dd4 = DAT_00120dd4 + iVar22 / 10;
    DAT_00120dd8 = DAT_00120dd8 + iVar10;
    DAT_00120ddc = DAT_00120ddc + iVar21;
    DAT_001210fc = DAT_001210fc + iVar2;
    DAT_00121108 = DAT_00121108 + iVar18;
    DAT_00121104 = DAT_00121104 + iVar20;
  }
  if (((DAT_00120720 == iVar11) && (DAT_00120724 == iVar12)) ||
     (((DAT_00120714 == 0x44 || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)))) {
    *(undefined4 *)(starch + ((long)iVar11 * 9 + (long)iVar12) * 4) = 1;
  }
  *(undefined4 *)((long)&d + ((long)iVar12 + 8 + (long)iVar11 * 9) * 4) = 1000;
  if ((iVar16 == 0) && ((iVar6 != iVar11 || (DAT_00120724 != iVar12)))) {
    skip(2);
    if (param_1 == 0) {
      prout("Lucky you!");
    }
    proutn("A supernova in");
    cramlc(1,iVar11,iVar12);
    prout(" has just destroyed the last Klingons.");
    finish(0);
  }
  else if (DAT_00120764 != 0) {
    finish(7);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void events(void)

{
  int iVar1;
  int iVar2;
  undefined8 uVar3;
  uint uVar4;
  uint uVar5;
  long lVar6;
  int *piVar7;
  ulong uVar8;
  undefined8 *puVar9;
  undefined *puVar10;
  int *piVar11;
  int iVar12;
  ulong uVar13;
  undefined *puVar14;
  undefined8 *puVar15;
  int unaff_R13D;
  long in_FS_OFFSET;
  byte bVar16;
  double dVar17;
  double dVar18;
  double dVar19;
  double local_60;
  uint local_58;
  uint local_54;
  int local_50;
  int local_4c;
  int local_44;
  long local_40;
  
  bVar16 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_44 = 0;
  local_60 = DAT_001211f0 + DAT_00120878;
  if ((DAT_00120898 == 1e+30) &&
     (((DAT_00120714 != 0x44 && (0.0 < DAT_00120228)) || (DAT_001207b4 != 0)))) {
    DAT_00120898 = DAT_001211f0;
    puVar10 = (undefined *)0x120504;
    puVar14 = &DAT_00120de4;
    do {
      lVar6 = 0;
      do {
        if (*(int *)(puVar10 + lVar6 + 4) == 1) {
          *(int *)(puVar10 + lVar6 + 4) = *(int *)(puVar14 + lVar6 + 0x24) + 1000;
        }
        lVar6 = lVar6 + 4;
      } while (lVar6 != 0x20);
      puVar10 = puVar10 + 0x24;
      puVar14 = puVar14 + 0x24;
    } while (puVar10 != &DAT_00120624);
    unaff_R13D = 9;
  }
  uVar4 = DAT_00120764;
  if (DAT_00120764 != 0) {
LAB_00110092:
    if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
      return;
    }
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  local_58 = DAT_00120764;
  local_54 = DAT_00120764;
LAB_001108f8:
  uVar13 = 0;
  uVar8 = 1;
  dVar17 = local_60;
  do {
    if (*(double *)(future + uVar8 * 8) <= dVar17) {
      uVar13 = uVar8 & 0xffffffff;
      dVar17 = *(double *)(future + uVar8 * 8);
    }
    uVar8 = uVar8 + 1;
  } while (uVar8 != 9);
  dVar19 = dVar17 - DAT_001211f0;
  if ((DAT_001207b8 != 0) && (DAT_00120838 = DAT_00120838 - dVar19 * 500.0, DAT_00120838 <= 0.0)) {
    finish(3);
    goto LAB_00110092;
  }
  dVar18 = (double)(d._4_4_ + DAT_00120dc8 * 4);
  DAT_001211f8 = DAT_001211f8 - dVar19 * dVar18;
  DAT_00121200 = DAT_001211f8 / dVar18;
  DAT_001211f0 = dVar17;
  if (DAT_00121200 <= 0.0) {
    finish(1);
    goto LAB_00110092;
  }
  dVar17 = dVar19;
  iVar12 = DAT_00120714;
  if (DAT_00120208 == 0.0) {
    if (DAT_00120714 == 0x44) {
LAB_00110051:
      dVar17 = dVar19 / DAT_00120880;
      iVar12 = 0x44;
    }
  }
  else {
    if (DAT_00120714 == 0x44) goto LAB_00110051;
    if ((DAT_00120860 < dVar19) && (DAT_00120860 < DAT_00120208)) {
      finish(2);
      goto LAB_00110092;
    }
    DAT_00120860 = DAT_00120860 - dVar19;
    if (DAT_00120208 <= dVar19) {
      DAT_00120860 = DAT_00120828;
    }
  }
  lVar6 = 1;
  do {
    dVar18 = (double)(&damage)[lVar6];
    if ((0.0 < dVar18) && ((int)lVar6 != 0xe)) {
      uVar8 = -(ulong)(0.0 < dVar18 - dVar17);
      (&damage)[lVar6] = dVar18 - (double)((ulong)dVar17 & uVar8 | ~uVar8 & (ulong)dVar18);
    }
    lVar6 = lVar6 + 1;
  } while (lVar6 != 0x11);
  if ((iVar12 != 0x44) || (DAT_00120250 <= 0.0)) {
    if ((DAT_00120898 != 1e+30) && ((iVar12 == 0x44 || (DAT_00120228 <= 0.0)))) goto LAB_0011021a;
  }
  else {
    uVar8 = -(ulong)(0.0 < DAT_00120268 - dVar19);
    DAT_00120250 = DAT_00120250 - (double)(~uVar8 & (ulong)DAT_00120250 | (ulong)dVar19 & uVar8);
    if (DAT_00120898 != 1e+30) {
LAB_0011021a:
      if (DAT_001207b4 == 0) {
        DAT_00120898 = 1e+30;
        prout("Lt. Uhura- \"Captain, the sub-space radio is working and");
        prout("   surveillance reports are coming in.");
        skip(1);
        piVar11 = (int *)(starch + 0x48);
        do {
          piVar7 = piVar11 + -8;
          do {
            if (999 < *piVar7) {
              *piVar7 = 1;
            }
            piVar7 = piVar7 + 1;
          } while (piVar7 != piVar11);
          piVar11 = piVar11 + 9;
        } while (piVar11 != (int *)(ky + 8));
        if (_DAT_001207ec == 0) {
          attakreport();
          _DAT_001207ec = 1;
        }
        skip(1);
        prout("   The star chart is now up to date.\"");
        skip(1);
        unaff_R13D = 9;
      }
    }
  }
  dVar17 = DAT_001211f0;
  DAT_00120878 = DAT_00120878 - dVar19;
  switch(uVar13) {
  case 0:
    if ((((_DAT_001210f8 == 0) || (DAT_001207b4 != 0)) ||
        ((0 < (int)(local_54 + local_58) ||
         (((DAT_00120714 == 0x44 || (DAT_001207ac == 1)) || (_DAT_001207b0 == 1)))))) ||
       ((_DAT_001207a4 == 0 &&
        ((((2000.0 <= DAT_00120838 || (3 < DAT_00120718)) || (1250.0 <= DAT_00120840)) &&
         (((DAT_001201f8 <= 0.0 || ((DAT_00120200 <= 0.0 && (3 < DAT_00120718)))) &&
          ((DAT_00120220 <= 0.0 ||
           (((2500.0 <= DAT_00120838 && (DAT_001201f8 <= 0.0)) ||
            ((4 < DAT_00120718 && (DAT_00120200 <= 0.0)))))))))))))) goto LAB_00110092;
    dVar17 = (double)square((double)(DAT_001210f0 - DAT_00120720));
    dVar19 = (double)square((double)(DAT_001210f4 - DAT_00120724));
    dVar17 = dVar17 + dVar19;
    local_58 = 1;
    uVar5 = local_58;
LAB_0011045b:
    local_58 = uVar5;
    if (dVar17 < 0.0) {
      dVar17 = sqrt(dVar17);
    }
    else {
      dVar17 = SQRT(dVar17);
    }
    if (local_44 == 0) {
      pause();
    }
    local_44 = 1;
    DAT_00120878 = dVar17 * 0.1777777777777778;
    skip(1);
    proutn("***");
    crmshp();
    prout(" caught in long range tractor beam--");
    atover(1);
    if (DAT_00120764 != 0) goto LAB_00110092;
    if (_DAT_001207a0 == 1) {
      finish(0x11);
      goto LAB_00110092;
    }
    if (DAT_001207a8 == 0) {
      skip(1);
      dVar17 = (double)Rand();
      if (dVar17 <= 0.5) {
        prout("Galileo, left on the planet surface, is well hidden.");
      }
      else {
        prout("Galileo, left on the planet surface, is captured");
        prout("by aliens and made into a flying McDonald\'s.");
        DAT_00120230 = 0xc024000000000000;
        DAT_001207a8 = -1;
      }
    }
    if ((int)uVar13 == 0) {
      DAT_00120720 = DAT_001210f0;
      DAT_00120724 = DAT_001210f4;
    }
    else {
      DAT_00120720 = *(int *)(&DAT_00120f24 + (long)unaff_R13D * 4);
      DAT_00120724 = *(int *)(&DAT_00120f50 + (long)unaff_R13D * 4);
    }
    iran10(&DAT_00120728);
    crmshp();
    proutn(" is pulled to");
    cramlc(1,DAT_00120720,DAT_00120724);
    proutn(", ");
    cramlc(2,DAT_00120728,DAT_0012072c);
    skip(1);
    if (DAT_00120888 != 0.0) {
      prout("(Remainder of rest/repair period cancelled.)");
      DAT_00120888 = 0.0;
    }
    if (DAT_00120848 == 0.0) {
      if ((DAT_00120220 != 0.0) || (DAT_00120840 <= 0.0)) {
        prout("(Shields not currently useable.)");
      }
      else {
        sheild(2);
        _DAT_00120768 = 0;
      }
    }
    newqad(0);
    local_60 = DAT_001211f0 + DAT_00120878;
    if (DAT_00120dc8 < 1) {
      future._16_8_ = 0x46293e5939a08cea;
      local_54 = 1;
    }
    else {
      dVar17 = (double)expran((DAT_00120810 * 1.5) / (double)DAT_00120dc8);
      future._16_8_ = dVar17 + local_60;
      local_54 = 1;
    }
    break;
  case 1:
    if (local_44 == 0) {
      pause();
    }
    local_44 = 1;
    snova(0,0);
    dVar17 = DAT_001211f0;
    dVar19 = (double)expran(DAT_00120810 * 0.5);
    future._8_8_ = dVar17 + dVar19;
    iVar12 = *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
joined_r0x001111c3:
    if (iVar12 == 1000) goto LAB_00110092;
    break;
  case 2:
    if (DAT_00120dc8 == 0) {
      future._16_8_ = 0x46293e5939a08cea;
    }
    else {
      dVar17 = (double)Rand();
      unaff_R13D = (int)((double)DAT_00120dc8 * dVar17 + 1.0);
      dVar19 = (double)square((double)(*(int *)(&DAT_00120f24 + (long)unaff_R13D * 4) - DAT_00120720
                                      ));
      dVar17 = (double)square((double)(*(int *)(&DAT_00120f50 + (long)unaff_R13D * 4) - DAT_00120724
                                      ));
      dVar17 = dVar17 + dVar19;
      if (((DAT_00120714 != 0x44) && ((local_58 | DAT_001207b4) == 0)) &&
         (uVar5 = uVar4, dVar17 != 0.0)) goto LAB_0011045b;
      dVar17 = DAT_001211f0 + DAT_00120878;
      dVar19 = (double)expran((DAT_00120810 * 1.5) / (double)DAT_00120dc8);
      future._16_8_ = dVar19 + dVar17;
    }
    break;
  case 3:
    puVar9 = &d;
    puVar15 = &snapsht;
    for (lVar6 = 0x89; dVar17 = DAT_001211f0, lVar6 != 0; lVar6 = lVar6 + -1) {
      *puVar15 = *puVar9;
      puVar9 = puVar9 + (ulong)bVar16 * -2 + 1;
      puVar15 = puVar15 + (ulong)bVar16 * -2 + 1;
    }
    d._0_4_ = 1;
    dVar19 = (double)expran(DAT_00120810 * 0.5);
    future._24_8_ = dVar17 + dVar19;
    break;
  case 4:
    if ((DAT_00120dc8 == 0) || (DAT_00120dcc == 0)) {
      future._40_8_ = 0x46293e5939a08cea;
      future._32_8_ = 0x46293e5939a08cea;
    }
    else {
      unaff_R13D = 0;
      if (DAT_00120dcc < 1) {
        iVar12 = 1;
LAB_001109e0:
        if (iVar12 <= DAT_00120dcc) {
          DAT_001207d8 = (&DAT_00120f7c)[iVar12];
          DAT_001207dc = (&DAT_00120f94)[iVar12];
          dVar17 = DAT_001211f0 + 1.0;
          dVar19 = (double)Rand();
          future._40_8_ = dVar19 * 3.0 + dVar17;
          if (DAT_001207ac != 0) {
            future._40_8_ = ((double)future._56_8_ - DAT_001211f0) + (double)future._40_8_;
          }
          uVar3 = future._40_8_;
          dVar17 = (double)expran(DAT_00120810 * 0.3);
          future._32_8_ = (double)uVar3 + dVar17;
          _DAT_001207ec = 0;
          if (((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) {
            _DAT_001207ec = 1;
            if (local_44 == 0) {
              pause();
            }
            local_44 = 1;
            skip(1);
            proutn("Lt. Uhura-  \"Captain, the starbase in");
            cramlc(1,DAT_001207d8,DAT_001207dc);
            skip(1);
            prout("   reports that it is under atttack and that it can");
            proutn("   hold out only until stardate ");
            cramf(future._40_8_,1,1);
            prout(&DAT_0011ba37);
            if (DAT_00120888 == 0.0) break;
            skip(1);
            proutn("Mr. Spock-  \"Captain, shall we cancel the rest period?\"");
            iVar12 = ja();
            if (iVar12 != 0) {
              DAT_00120888 = 0.0;
              DAT_00120878 = 0.0;
              goto LAB_00110092;
            }
          }
          break;
        }
      }
      else {
        puVar9 = &d;
        iVar12 = 1;
        do {
          if (0 < DAT_00120dc8) {
            iVar2 = *(int *)(puVar9 + 0x38);
            lVar6 = 1;
            do {
              if (((iVar2 == *(int *)(&DAT_00120f24 + lVar6 * 4)) &&
                  (iVar1 = *(int *)(puVar9 + 0x3b), iVar1 == *(int *)(&DAT_00120f50 + lVar6 * 4)))
                 && ((iVar2 != DAT_00120720 || (iVar1 != DAT_00120724)))) {
                if (iVar2 != DAT_001210f0) {
                  unaff_R13D = 1;
                  goto LAB_001109e0;
                }
                if (iVar1 != DAT_001210f4) {
                  unaff_R13D = 1;
                  goto LAB_001109e0;
                }
              }
              lVar6 = lVar6 + 1;
            } while ((int)lVar6 <= DAT_00120dc8);
          }
          iVar12 = iVar12 + 1;
          puVar9 = (undefined8 *)((long)puVar9 + 4);
        } while (iVar12 <= DAT_00120dcc);
      }
      dVar19 = (double)expran(DAT_00120810 * 0.3);
      future._32_8_ = dVar17 + dVar19;
      future._40_8_ = 0x46293e5939a08cea;
    }
    break;
  case 5:
    future._40_8_ = 0x46293e5939a08cea;
    if (DAT_00120dc8 < 1) {
      unaff_R13D = 1;
LAB_00110da0:
      if ((unaff_R13D <= DAT_00120dc8) &&
         ((DAT_00120dcc != 0 &&
          (9 < *(int *)((long)&d + ((long)DAT_001207dc + 8 + (long)DAT_001207d8 * 9) * 4) % 100))))
      goto LAB_00110c6c;
    }
    else {
      piVar11 = &DAT_00120f28;
      unaff_R13D = 1;
      do {
        if ((*piVar11 == DAT_001207d8) && (piVar11[0xb] == DAT_001207dc)) goto LAB_00110da0;
        unaff_R13D = unaff_R13D + 1;
        piVar11 = piVar11 + 1;
      } while (unaff_R13D <= DAT_00120dc8);
    }
    DAT_001207dc = 0;
    DAT_001207d8 = 0;
    break;
  case 6:
    future._48_8_ = DAT_001211f0 + 0.2777;
    if (((local_58 + _DAT_001207a4 == 0) && (DAT_001207ac != 1)) &&
       ((_DAT_001207b0 != 1 || (DAT_00120760 == 1)))) {
      scom(&local_44);
    }
    break;
  case 7:
    future._56_8_ = 0x46293e5939a08cea;
    DAT_001207ac = 2;
    if (9 < *(int *)((long)&d + ((long)DAT_001210f4 + 8 + (long)DAT_001210f0 * 9) * 4) % 100) {
      local_50 = DAT_001207d8;
      local_4c = DAT_001207dc;
      DAT_001207d8 = DAT_001210f0;
      DAT_001207dc = DAT_001210f4;
LAB_00110c6c:
      iVar12 = *(int *)(starch + ((long)DAT_001207d8 * 9 + (long)DAT_001207dc) * 4);
      if (iVar12 == -1) {
        *(undefined4 *)(starch + ((long)DAT_001207d8 * 9 + (long)DAT_001207dc) * 4) = 0;
        if (CONCAT44(DAT_00120724,DAT_00120720) == CONCAT44(DAT_001207dc,DAT_001207d8))
        goto LAB_00110e5d;
LAB_00110cac:
        if ((DAT_00120dcc != 1) &&
           (((DAT_00120714 == 0x44 || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)))) {
          if (local_44 == 0) {
            pause();
          }
          local_44 = 1;
          skip(1);
          prout("Lt. Uhura-  \"Captain, Starfleet Command reports that");
          proutn("   the starbase in");
          cramlc(1,DAT_001207d8,DAT_001207dc);
          prout(" has been destroyed by");
          if (DAT_001207ac == 2) {
            prout("the Klingon Super-Commander");
          }
          else {
            prout("a Klingon Commander");
          }
        }
      }
      else {
        if (CONCAT44(DAT_001207dc,DAT_001207d8) != CONCAT44(DAT_00120724,DAT_00120720))
        goto LAB_00110cac;
        if (999 < iVar12) {
          *(int *)(starch + ((long)DAT_001207d8 * 9 + (long)DAT_001207dc) * 4) = iVar12 + -10;
        }
LAB_00110e5d:
        quad[(long)DAT_0012073c + (long)DAT_00120738 * 0xb] = 0x2e;
        DAT_0012073c = 0;
        DAT_00120738 = 0;
        newcnd();
        skip(1);
        prout("Spock-  \"Captain, I believe the starbase has been destroyed.\"");
      }
      puVar9 = &d;
      piVar11 = (int *)((long)&d + ((long)DAT_001207dc + 8 + (long)DAT_001207d8 * 9) * 4);
      *piVar11 = *piVar11 + -10;
      if (DAT_00120dcc < 1) {
        unaff_R13D = 1;
      }
      else {
        do {
          if ((DAT_001207d8 == *(int *)(puVar9 + 0x38)) && (DAT_001207dc == *(int *)(puVar9 + 0x3b))
             ) {
            *(int *)(puVar9 + 0x38) = (&DAT_00120dcc)[(long)DAT_00120dcc + 0x6c];
            *(undefined4 *)(puVar9 + 0x3b) =
                 *(undefined4 *)((long)&d + ((long)DAT_00120dcc + 0x74) * 4 + 4);
          }
          puVar9 = (undefined8 *)((long)puVar9 + 4);
        } while (puVar9 != (undefined8 *)((ulong)(DAT_00120dcc - 1) * 4 + 0x120dc4));
        unaff_R13D = DAT_00120dcc + 1;
      }
      DAT_00120dcc = DAT_00120dcc + -1;
      if (DAT_001207ac == 2) {
        DAT_001207d8 = local_50;
        DAT_001207dc = local_4c;
        DAT_001207ac = 0;
      }
      else {
        DAT_001207dc = 0;
        DAT_001207d8 = 0;
      }
    }
    break;
  case 8:
    future._64_8_ = DAT_001211f0 + 0.01;
    DAT_001208a8 = DAT_001208a8 + _DAT_001208b8;
    DAT_001208b0 = DAT_001208b0 + _DAT_001208c0;
    unaff_R13D = (int)(DAT_001208a8 / 10.0 + 0.05);
    iVar12 = (int)(DAT_001208b0 / 10.0 + 0.05);
    if ((DAT_001207f0 == unaff_R13D) && (DAT_001207f4 == iVar12)) {
LAB_001110fe:
      if (DAT_00120714 != 0x44) {
LAB_0011110b:
        if (0.0 < DAT_00120228) goto LAB_0011111d;
      }
      if (DAT_001207b4 == 0) {
        iVar12 = 1;
        if (0.0 < DAT_00120228) {
          iVar12 = *(int *)((long)&d + ((long)DAT_001207f4 + 8 + (long)DAT_001207f0 * 9) * 4) + 1000
          ;
        }
        *(int *)(starch + ((long)DAT_001207f0 * 9 + (long)DAT_001207f4) * 4) = iVar12;
      }
    }
    else {
      DAT_001207f0 = unaff_R13D;
      DAT_001207f4 = iVar12;
      if ((7 < unaff_R13D - 1U) ||
         ((7 < iVar12 - 1U ||
          (*(int *)((long)&d + ((long)iVar12 + 8 + (long)unaff_R13D * 9) * 4) == 1000)))) {
        if (((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) {
          if (local_44 == 0) {
            pause();
          }
          local_44 = 1;
          skip(1);
          proutn("Lt. Uhura-  \"The deep space probe ");
          if ((unaff_R13D - 1U < 8) && (iVar12 - 1U < 8)) {
            proutn("is no longer transmitting");
          }
          else {
            proutn("has left the galaxy");
          }
          prout(&DAT_0011ba37);
        }
        future._64_8_ = 0x46293e5939a08cea;
        break;
      }
      if (DAT_00120714 != 0x44) {
        if (DAT_00120228 <= 0.0) {
          if (DAT_001207b4 == 0) goto LAB_001112ef;
          if (DAT_00120714 == 0x44) goto LAB_0011111d;
        }
        goto LAB_0011110b;
      }
      if (DAT_001207b4 == 0) {
LAB_001112ef:
        if (local_44 == 0) {
          pause();
        }
        local_44 = 1;
        skip(1);
        proutn("Lt. Uhura-  \"The deep space probe is now in ");
        cramlc(1,DAT_001207f0,DAT_001207f4);
        prout(&DAT_0011ba37);
        goto LAB_001110fe;
      }
    }
LAB_0011111d:
    DAT_001207f8 = DAT_001207f8 + -1;
    if (((DAT_001207f8 == 0) && (_DAT_001207fc != 0)) &&
       (0 < *(int *)((long)&d + ((long)DAT_001207f4 + 8 + (long)DAT_001207f0 * 9) * 4) % 10)) {
      snova(1,0);
      future._64_8_ = 0x46293e5939a08cea;
      iVar12 = *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
      goto joined_r0x001111c3;
    }
  }
  if (DAT_00120764 != 0) goto LAB_00110092;
  goto LAB_001108f8;
}



void waiting(void)

{
  int iVar1;
  double dVar2;
  double dVar3;
  double dVar4;
  
  DAT_00120754 = 0;
  while (iVar1 = scan(), iVar1 == 0) {
    proutn("How long? ");
  }
  chew();
  dVar4 = aaitem;
  if (iVar1 == 2) {
    if (0.0 < aaitem) {
      if ((DAT_00121200 <= aaitem) || (DAT_00120790 != 0)) {
        prout("Are you sure? ");
        iVar1 = ja();
        if (iVar1 == 0) {
          return;
        }
      }
      DAT_00120888 = 1.0;
      do {
        if (dVar4 <= 0.0) {
          DAT_00120888 = 0.0;
LAB_001113e9:
          cramf(DAT_00121200,0,2);
          prout(" stardates left.");
          return;
        }
        if (DAT_00120888 == 0.0) goto LAB_001113e9;
        dVar2 = dVar4;
        DAT_00120878 = dVar4;
        if (DAT_00120790 == 0) {
LAB_00111504:
          movetho();
        }
        else {
          dVar3 = (double)Rand();
          dVar3 = dVar3 + 1.0;
          DAT_00120878 = dVar4;
          if (dVar3 < dVar4) {
            DAT_00120878 = dVar3;
            attack(0);
            dVar2 = dVar3;
          }
          if (DAT_00120790 == 0) goto LAB_00111504;
        }
        if (DAT_00120764 != 0) {
          return;
        }
        events();
        DAT_00120754 = 1;
        if (DAT_00120764 != 0) {
          DAT_00120754 = 1;
          return;
        }
        dVar4 = dVar4 - dVar2;
      } while (*(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) != 1000);
      DAT_00120888 = 0.0;
      DAT_00120878 = 0.0;
    }
  }
  else {
    huh();
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void nova(int param_1,int param_2)

{
  int *piVar1;
  char cVar2;
  undefined8 uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  long lVar8;
  undefined8 *puVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  long in_FS_OFFSET;
  double dVar14;
  double dVar15;
  double dVar16;
  int local_f0;
  int local_ec;
  int local_e8;
  int local_e0;
  uint local_d8;
  int local_d4;
  int local_d0;
  int aiStack_c4 [4];
  int local_b4;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  dVar14 = (double)Rand();
  if (0.05 <= dVar14) {
    quad[(long)param_2 + (long)param_1 * 0xb] = 0x2e;
    crmena(1,0x2a,2,param_1,param_2);
    prout(" novas.");
    piVar1 = (int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
    *piVar1 = *piVar1 + -1;
    DAT_00120dd0 = DAT_00120dd0 + 1;
    aiStack_c4[3] = param_1;
    local_b4 = param_2;
    local_e0 = 1;
    local_f0 = 1;
    local_d4 = 0;
    local_d8 = 0;
    local_d0 = 0;
    local_ec = 1;
LAB_00111cf3:
    iVar13 = 1;
LAB_00111cda:
    iVar10 = 2;
    do {
      iVar4 = DAT_00120724;
      iVar11 = DAT_00120720;
      if ((iVar10 != 3) || (iVar13 != 2)) {
        iVar6 = aiStack_c4[(long)local_f0 * 3];
        iVar7 = aiStack_c4[(long)local_f0 * 3 + 1];
        if (((iVar6 + iVar13) - 3U < 10) && (iVar5 = iVar10 + -1 + iVar7, iVar5 - 3U < 10)) {
          iVar12 = iVar6 + iVar13 + -2;
          iVar5 = iVar5 + -2;
          cVar2 = quad[(long)iVar5 + (long)iVar12 * 0xb];
          switch(cVar2) {
          case '*':
            dVar14 = (double)Rand();
            if (dVar14 < 0.05) {
              snova(iVar12,iVar5);
              goto LAB_00111601;
            }
            local_ec = local_ec + 1;
            aiStack_c4[(long)local_ec * 3] = iVar12;
            aiStack_c4[(long)local_ec * 3 + 1] = iVar5;
            piVar1 = (int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
            *piVar1 = *piVar1 + -1;
            DAT_00120dd0 = DAT_00120dd0 + 1;
            crmena(1,0x2a,2,iVar12,iVar5);
            prout(" novas.");
            quad[(long)iVar5 + (long)iVar12 * 0xb] = 0x2e;
            break;
          case 'B':
            puVar9 = &d;
            piVar1 = (int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
            *piVar1 = *piVar1 + -10;
            if (DAT_00120dcc < 1) {
              iVar6 = 1;
            }
            else {
              iVar6 = 1;
              do {
                if ((iVar11 == *(int *)(puVar9 + 0x38)) && (iVar4 == *(int *)(puVar9 + 0x3b)))
                break;
                iVar6 = iVar6 + 1;
                puVar9 = (undefined8 *)((long)puVar9 + 4);
              } while (iVar6 <= DAT_00120dcc);
            }
            (&DAT_00120f7c)[iVar6] = (&DAT_00120f7c)[DAT_00120dcc];
            (&DAT_00120f94)[iVar6] = (&DAT_00120f94)[DAT_00120dcc];
            DAT_00120dcc = DAT_00120dcc + -1;
            DAT_0012073c = 0;
            DAT_00120738 = 0;
            DAT_00120dd4 = DAT_00120dd4 + 1;
            newcnd();
            crmena(1,0x42,2,iVar12,iVar5);
            prout(" destroyed.");
            quad[(long)iVar5 + (long)iVar12 * 0xb] = 0x2e;
            break;
          case 'C':
          case 'R':
          case 'S':
            lVar8 = 1;
            if (DAT_00120790 < 1) {
              local_e8 = 1;
            }
            else {
              do {
                local_e8 = (int)lVar8;
                if ((*(int *)(kx + lVar8 * 4) == iVar12) && (*(int *)(ky + lVar8 * 4) == iVar5))
                break;
                local_e8 = local_e8 + 1;
                lVar8 = lVar8 + 1;
              } while ((int)lVar8 <= DAT_00120790);
            }
            iVar11 = (int)cVar2;
            dVar14 = *(double *)(kpower + (long)local_e8 * 8);
            *(double *)(kpower + (long)local_e8 * 8) = dVar14 - 800.0;
            if (dVar14 - 800.0 <= 0.0) {
              deadkl(iVar12,iVar5,iVar11,iVar12,iVar5);
            }
            else {
              iVar6 = iVar12 * 2 - iVar6;
              crmena(1,iVar11,2,iVar12,iVar5);
              proutn(" damaged");
              if ((iVar6 - 1U < 10) && (iVar7 = iVar5 * 2 - iVar7, iVar7 - 1U < 10)) {
                if (quad[(long)iVar7 + (long)iVar6 * 0xb] == ' ') {
                  proutn(", blasted into ");
                  crmena(0,0x20,2,iVar6,iVar7);
                  skip(1);
                  deadkl(iVar12,iVar5,iVar11,iVar6,iVar7);
                }
                else if (quad[(long)iVar7 + (long)iVar6 * 0xb] == '.') {
                  proutn(", buffeted to");
                  cramlc(2,iVar6,iVar7);
                  quad[(long)iVar5 + (long)iVar12 * 0xb] = 0x2e;
                  quad[(long)iVar7 + (long)iVar6 * 0xb] = cVar2;
                  *(int *)(kx + (long)local_e8 * 4) = iVar6;
                  *(int *)(ky + (long)local_e8 * 4) = iVar7;
                  dVar15 = (double)square((double)(DAT_00120728 - iVar6));
                  dVar14 = (double)square((double)(DAT_0012072c - iVar7));
                  dVar15 = dVar15 + dVar14;
                  if (dVar15 < 0.0) {
                    dVar15 = sqrt(dVar15);
                  }
                  else {
                    dVar15 = SQRT(dVar15);
                  }
                  *(double *)(kavgd + (long)local_e8 * 8) = dVar15;
                  *(double *)(kdist + (long)local_e8 * 8) = dVar15;
                  skip(1);
                }
                else {
                  skip(1);
                }
              }
              else {
                skip(1);
              }
            }
            break;
          case 'E':
          case 'F':
            prout("***Starship buffeted by nova.");
            if (DAT_00120848 == 0.0) {
              DAT_00120838 = DAT_00120838 - 2000.0;
            }
            else if (DAT_00120840 < 2000.0) {
              dVar16 = 2000.0 - DAT_00120840;
              DAT_00120838 = DAT_00120838 - dVar16;
              DAT_00120840 = 0.0;
              DAT_00120848 = 0.0;
              prout("***Shields knocked out.");
              dVar14 = DAT_00120890 * 0.005;
              dVar15 = (double)Rand();
              DAT_00120220 = dVar15 * dVar14 * dVar16 + DAT_00120220;
            }
            else {
              DAT_00120840 = DAT_00120840 - 2000.0;
            }
            if (DAT_00120838 <= 0.0) {
              finish(6);
              goto LAB_00111601;
            }
            local_d8 = local_d8 + (DAT_00120728 - iVar6);
            local_d4 = local_d4 + (DAT_0012072c - iVar7);
            local_d0 = local_d0 + 1;
            break;
          case 'K':
            deadkl(iVar12,iVar5,0x4b,iVar12,iVar5);
            break;
          case 'P':
            (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] =
                 (&DAT_00120dcc)[(long)DAT_00120724 + 0x78 + (long)DAT_00120720 * 9] + -1;
            DAT_00121108 = DAT_00121108 + 1;
            crmena(1,0x50,2,iVar12,iVar5);
            prout(" destroyed.");
            uVar3 = nulplanet._8_8_;
            lVar8 = (long)DAT_00120784 * 0x14;
            *(undefined8 *)(&DAT_0012110c + lVar8) = nulplanet._0_8_;
            *(undefined8 *)(&DAT_00121114 + lVar8) = uVar3;
            *(undefined4 *)(&DAT_0012111c + lVar8) = nulplanet._16_4_;
            DAT_00120778 = 0;
            DAT_00120774 = 0;
            DAT_00120784 = 0;
            if (DAT_00120780 == 1) {
              finish(0xf);
              goto LAB_00111601;
            }
            quad[(long)iVar5 + (long)iVar12 * 0xb] = 0x2e;
          }
        }
        if (3 < iVar10) goto LAB_00111cd0;
      }
      iVar10 = iVar10 + 1;
    } while( true );
  }
  snova(param_1,param_2);
  goto LAB_00111601;
LAB_00111cd0:
  iVar13 = iVar13 + 1;
  if (iVar13 == 4) goto LAB_00111ce4;
  goto LAB_00111cda;
LAB_00111ce4:
  local_f0 = local_f0 + 1;
  if (local_e0 < local_f0) {
    if ((local_ec == local_e0) || (local_f0 = local_e0 + 1, local_ec < local_f0)) goto LAB_00111d33;
    local_e0 = local_ec;
  }
  goto LAB_00111cf3;
LAB_00111d33:
  if (local_d0 == 0) goto LAB_00111601;
  if (local_d8 == 0) {
    if (local_d4 != 0) goto LAB_00111d5b;
    DAT_00120870 = 0.0;
LAB_00111e59:
    DAT_00120868 = 0.0;
  }
  else {
    local_d8 = (int)local_d8 >> 0x1f | 1;
    if (local_d4 == 0) {
      DAT_00120870 = *(double *)(course_0 + (long)(int)(local_d8 * 3 + 5) * 8);
    }
    else {
LAB_00111d5b:
      DAT_00120870 = *(double *)
                      (course_0 + (long)(int)((local_d4 >> 0x1f | 1U) + local_d8 * 3 + 5) * 8);
      if (DAT_00120870 == 0.0) goto LAB_00111e59;
    }
    DAT_00120868 = (double)local_d0 * 0.1;
    if (DAT_00120868 != 0.0) {
      DAT_00120878 = DAT_00120868 * 10.0 * 0.0625;
      skip(1);
      prout("Force of nova displaces starship.");
      _DAT_001207c8 = 2;
      lmove();
      DAT_00120878 = DAT_00120868 * 10.0 * 0.0625;
    }
  }
LAB_00111601:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 tryexit(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  long lVar5;
  undefined4 uVar6;
  int iVar7;
  long lVar8;
  
  iVar4 = (param_1 + 9) / 10 + DAT_00120720;
  uVar6 = 0;
  if (iVar4 - 2U < 8) {
    iVar7 = (param_2 + 9) / 10 + DAT_00120724;
    uVar6 = 0;
    if (iVar7 - 2U < 8) {
      iVar4 = iVar4 + -1;
      iVar7 = iVar7 + -1;
      if ((*(int *)((long)&d + ((long)iVar7 + 8 + (long)iVar4 * 9) * 4) < 900) && (param_3 != 0x52))
      {
        if (param_5 == 0) {
          if (param_3 == 0x43) {
            if (0 < DAT_00120dc8) {
              lVar5 = 1;
              do {
                if ((*(int *)(&DAT_00120f24 + lVar5 * 4) == iVar4) &&
                   (*(int *)(&DAT_00120f50 + lVar5 * 4) == iVar7)) {
                  return 0;
                }
                lVar5 = lVar5 + 1;
              } while ((int)lVar5 <= DAT_00120dc8);
            }
            if (_DAT_001207d8 == CONCAT44(DAT_00120724,DAT_00120720)) {
              return 0;
            }
          }
          if (1000.0 < *(double *)(kpower + (long)param_4 * 8)) {
            return 0;
          }
        }
        if (((DAT_001201e8 == 0.0) || (DAT_001201f0 == 0.0)) || (DAT_00120714 == 0x44)) {
          proutn("***");
          cramen(param_3);
          proutn(" escapes to");
          cramlc(1,iVar4,iVar7);
          prout(" (and regains strength).");
        }
        lVar5 = (long)DAT_00120790;
        lVar8 = (long)param_4;
        *(undefined4 *)(kx + lVar8 * 4) = *(undefined4 *)(kx + lVar5 * 4);
        *(undefined4 *)(ky + lVar8 * 4) = *(undefined4 *)(ky + lVar5 * 4);
        *(undefined8 *)(kavgd + lVar8 * 8) = *(undefined8 *)(kavgd + lVar5 * 8);
        *(undefined8 *)(kpower + lVar8 * 8) = *(undefined8 *)(kpower + lVar5 * 8);
        *(undefined8 *)(kdist + lVar8 * 8) = *(undefined8 *)(kdist + lVar5 * 8);
        DAT_00120740 = DAT_00120740 + -1;
        DAT_00120790 = DAT_00120790 + -1;
        if (DAT_00120714 != 0x44) {
          newcnd();
        }
        iVar3 = DAT_00120724;
        iVar2 = DAT_00120720;
        piVar1 = (int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4);
        *piVar1 = *piVar1 + -100;
        piVar1 = (int *)((long)&d + ((long)iVar7 + 8 + (long)iVar4 * 9) * 4);
        *piVar1 = *piVar1 + 100;
        if (param_3 == 0x53) {
          DAT_00120794 = 0;
          _DAT_001207b0 = 0;
          _DAT_001207a4 = 0;
          DAT_001207ac = 0;
          future._48_8_ = DAT_001211f0 + 0.2777;
          future._56_8_ = 0x46293e5939a08cea;
          uVar6 = 1;
          DAT_001210f0 = iVar4;
          DAT_001210f4 = iVar7;
        }
        else {
          lVar5 = 1;
          if (0 < DAT_00120dc8) {
            do {
              if ((iVar2 == *(int *)(&DAT_00120f24 + lVar5 * 4)) &&
                 (iVar3 == *(int *)(&DAT_00120f50 + lVar5 * 4))) {
                *(int *)(&DAT_00120f24 + (long)(int)lVar5 * 4) = iVar4;
                *(int *)(&DAT_00120f50 + (long)(int)lVar5 * 4) = iVar7;
                break;
              }
              lVar5 = lVar5 + 1;
            } while ((int)lVar5 <= DAT_00120dc8);
          }
          DAT_00120744 = 0;
          uVar6 = 1;
        }
      }
      else {
        uVar6 = 0;
      }
    }
  }
  return uVar6;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void movebaddy(int param_1,int param_2,int param_3,uint param_4)

{
  double dVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  bool bVar10;
  double dVar11;
  double dVar12;
  double local_80;
  int local_74;
  int local_70;
  int local_6c;
  int local_68;
  undefined local_60;
  undefined4 local_5c;
  
  if (DAT_00120734 < 4) {
    iVar3 = DAT_00120794 + DAT_00120744;
  }
  else {
    iVar3 = (int)(((double)((DAT_00120794 + DAT_00120744) * 2) + (double)DAT_00120740 * 1.23 +
                  (double)_DAT_0012079c * 1.5) * 0.5);
  }
  dVar1 = *(double *)(kdist + (long)param_3 * 8);
  if (param_4 == 0x53) {
    if (*(double *)(kpower + (long)param_3 * 8) <= 500.0) {
      local_5c = 1;
      local_74 = -10;
      iVar3 = 10;
    }
    else {
      if ((DAT_00120714 != 0x44) || (DAT_00120200 != 0.0)) goto LAB_0011223b;
      local_5c = 1;
      local_74 = -10;
      iVar3 = 10;
    }
  }
  else {
LAB_0011223b:
    local_80 = (double)DAT_00120790 * 100.0 + *(double *)(kpower + (long)param_3 * 8) +
               (double)((iVar3 + -1) * 400);
    if (DAT_00120848 == 0.0) {
      local_80 = local_80 + 1000.0;
    }
    if (DAT_001201f8 == 0.0) {
      local_80 = local_80 - (DAT_00120838 - 2500.0) * 0.2;
      if (DAT_00120200 == 0.0) {
LAB_001123ef:
        local_80 = local_80 - (double)DAT_00120718 * 50.0;
      }
      else {
        local_80 = local_80 + 300.0;
      }
    }
    else {
      if (DAT_00120200 == 0.0) {
        local_80 = local_80 + 300.0;
        goto LAB_001123ef;
      }
      local_80 = local_80 + 1000.0;
    }
    if (1000.0 < local_80) {
      if (1000.0 < local_80) {
LAB_0011247e:
        Rand();
        dVar11 = (double)square();
        local_74 = (int)((1.0 - dVar11) * dVar1 + 1.0);
        if (DAT_00120714 != 0x44) goto LAB_001124bb;
      }
      else {
        if (DAT_00120714 != 0x44) {
          return;
        }
        local_74 = 0;
      }
LAB_00112320:
      dVar12 = (double)DAT_00120734;
      Rand();
      dVar11 = (double)square();
      local_74 = (int)((double)local_74 - (2.0 - dVar11) * dVar12);
    }
    else {
      if (DAT_00120714 == 0x44) {
        if (1000.0 < local_80) goto LAB_0011247e;
        local_74 = 0;
        goto LAB_00112320;
      }
      dVar11 = (double)Rand();
      local_74 = (int)((dVar11 * 200.0 + local_80) / 150.0 - 5.0);
    }
LAB_001124bb:
    if (local_74 == 0) {
      return;
    }
    iVar3 = -local_74;
    if (0 < local_74) {
      iVar3 = local_74;
    }
    if ((DAT_00120734 < iVar3) && (bVar10 = local_74 < 0, local_74 = DAT_00120734, bVar10)) {
      local_74 = -DAT_00120734;
    }
    iVar3 = (int)(dVar1 + 0.5);
    iVar7 = -local_74;
    if ((local_74 < 1) || (iVar7 = local_74, local_74 <= iVar3)) {
      iVar3 = iVar7;
      local_5c = 0;
    }
    else {
      local_5c = 0;
    }
  }
  if (iVar3 < 1) {
    iVar3 = 1;
  }
  if (10 < iVar3) {
    iVar3 = 10;
  }
  iVar9 = DAT_00120728 - param_1;
  uVar4 = DAT_0012072c - param_2;
  iVar7 = -iVar9;
  if (0 < iVar9) {
    iVar7 = iVar9;
  }
  dVar11 = (double)iVar7;
  uVar2 = -uVar4;
  if (0 < (int)uVar4) {
    uVar2 = uVar4;
  }
  dVar12 = (double)uVar2;
  if (dVar11 + dVar11 < dVar12) {
    iVar9 = 0;
    if (dVar12 + dVar12 < dVar11) goto LAB_00112973;
    uVar2 = 0;
  }
  else if (dVar12 + dVar12 < dVar11) {
LAB_00112973:
    if (iVar9 == 0) {
      uVar2 = 0;
      uVar4 = 0;
      goto LAB_001125b2;
    }
    if (iVar9 * local_74 < 0) {
      uVar2 = 0xffffffff;
      uVar4 = 0;
      goto LAB_001125b2;
    }
    uVar4 = 0;
    uVar2 = 1;
  }
  else if (iVar9 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = iVar9 * local_74 >> 0x1f | 1;
  }
  if (uVar4 != 0) {
    uVar4 = (int)(uVar4 * local_74) >> 0x1f | 1;
  }
LAB_001125b2:
  quad[(long)param_2 + (long)param_1 * 0xb] = 0x2e;
  local_68 = 1;
  local_70 = param_1;
  local_6c = param_2;
LAB_0011291d:
  iVar7 = local_70 + uVar2;
  iVar9 = uVar4 + local_6c;
  iVar5 = 0x14;
  uVar6 = ((int)uVar2 >> 0x1f & 2U) - 1;
  uVar8 = ((int)uVar4 >> 0x1f & 2U) - 1;
  do {
    if (iVar7 - 1U < 10) {
      if (iVar9 - 1U < 10) {
        if (quad[(long)iVar9 + (long)iVar7 * 0xb] == '.') break;
        if (((char)quad[(long)iVar9 + (long)iVar7 * 0xb] == DAT_0012071c) &&
           ((param_4 & 0xffffffef) == 0x43)) {
          ram(1,param_4,param_1,param_2);
          return;
        }
        if ((uVar6 == uVar2) || (uVar4 == 0)) {
          if ((uVar4 == uVar8) || (uVar2 == 0)) goto LAB_001127cb;
          iVar9 = local_6c + uVar8;
          uVar8 = -uVar8;
        }
        else {
          iVar7 = local_70 + uVar6;
          uVar6 = -uVar6;
        }
      }
      else {
        if ((local_74 < 0) && (iVar9 = tryexit(iVar7,iVar9,param_4,param_3,local_5c), iVar9 != 0)) {
          return;
        }
        if ((uVar4 == uVar8) || (uVar2 == 0)) goto LAB_001127cb;
        iVar9 = local_6c + uVar8;
        uVar8 = -uVar8;
      }
    }
    else {
      if ((local_74 < 0) && (iVar7 = tryexit(iVar7,iVar9,param_4,param_3,local_5c), iVar7 != 0)) {
        return;
      }
      if ((uVar6 == uVar2) || (uVar4 == 0)) goto LAB_001127cb;
      iVar7 = local_70 + uVar6;
      uVar6 = -uVar6;
    }
    iVar5 = iVar5 + -1;
    if (iVar5 == 0) goto LAB_001127cb;
  } while( true );
  local_68 = local_68 + 1;
  local_6c = iVar9;
  local_70 = iVar7;
  if (iVar3 + 1 == local_68) {
LAB_001127cb:
    local_60 = (undefined)param_4;
    quad[(long)local_6c + (long)local_70 * 0xb] = local_60;
    if ((param_1 == local_70) && (param_2 == local_6c)) {
      return;
    }
    *(int *)(kx + (long)param_3 * 4) = local_70;
    *(int *)(ky + (long)param_3 * 4) = local_6c;
    dVar12 = (double)square((double)(DAT_00120728 - local_70));
    dVar11 = (double)square((double)(DAT_0012072c - local_6c));
    dVar12 = dVar12 + dVar11;
    if (dVar12 < 0.0) {
      dVar12 = sqrt(dVar12);
    }
    else {
      dVar12 = SQRT(dVar12);
    }
    *(double *)(kavgd + (long)param_3 * 8) = dVar12;
    *(double *)(kdist + (long)param_3 * 8) = dVar12;
    if ((DAT_001201e8 != 0.0) && (DAT_00120714 != 0x44)) {
      return;
    }
    proutn("***");
    cramen(param_4);
    if (dVar1 < *(double *)(kdist + (long)param_3 * 8) ||
        dVar1 == *(double *)(kdist + (long)param_3 * 8)) {
      proutn(" retreats to");
    }
    else {
      proutn(" advances to");
    }
    cramlc(2,local_70,local_6c);
    skip(1);
    return;
  }
  goto LAB_0011291d;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 checkdest(int param_1,int param_2,int param_3,int *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  long lVar6;
  int iVar7;
  long lVar8;
  undefined4 uVar9;
  
  if ((((DAT_00120720 != param_1) || (uVar9 = 1, DAT_00120724 != param_2)) &&
      (uVar9 = 1, param_1 - 1U < 8)) &&
     ((param_2 - 1U < 8 && (*(int *)((long)&d + ((long)param_2 + 8 + (long)param_1 * 9) * 4) < 900))
     )) {
    if ((param_3 != 0) && (0 < DAT_00120dcc)) {
      lVar8 = 1;
      do {
        if (((&DAT_00120f7c)[lVar8] == param_1) && ((&DAT_00120f94)[lVar8] == param_2)) {
          return 1;
        }
        lVar8 = lVar8 + 1;
      } while ((int)lVar8 <= DAT_00120dcc);
    }
    piVar4 = (int *)((long)&d + ((long)DAT_001210f4 + 8 + (long)DAT_001210f0 * 9) * 4);
    *piVar4 = *piVar4 + -100;
    piVar4 = (int *)((long)&d + ((long)param_2 + 8 + (long)param_1 * 9) * 4);
    DAT_001210f0 = param_1;
    DAT_001210f4 = param_2;
    *piVar4 = *piVar4 + 100;
    if (_DAT_001207b0 != 0) {
      _DAT_001207b0 = 0;
      DAT_001207ac = 0;
      DAT_00120794 = 0;
      _DAT_001207a4 = 0;
      future._56_8_ = 0x46293e5939a08cea;
      if (DAT_00120790 < 1) {
        iVar5 = 1;
      }
      else {
        lVar8 = 1;
        do {
          iVar5 = (int)lVar8;
          if (quad[(long)*(int *)(ky + lVar8 * 4) + (long)*(int *)(kx + lVar8 * 4) * 0xb] == 'S')
          break;
          iVar5 = iVar5 + 1;
          lVar8 = lVar8 + 1;
        } while ((int)lVar8 <= DAT_00120790);
      }
      lVar6 = (long)iVar5;
      quad[(long)*(int *)(ky + lVar6 * 4) + (long)*(int *)(kx + lVar6 * 4) * 0xb] = 0x2e;
      lVar8 = (long)DAT_00120790;
      *(undefined4 *)(kx + lVar6 * 4) = *(undefined4 *)(kx + lVar8 * 4);
      *(undefined4 *)(ky + lVar6 * 4) = *(undefined4 *)(ky + lVar8 * 4);
      *(undefined8 *)(kdist + lVar6 * 8) = *(undefined8 *)(kdist + lVar8 * 8);
      *(undefined8 *)(kavgd + lVar6 * 8) = *(undefined8 *)(kavgd + lVar8 * 8);
      *(undefined8 *)(kpower + lVar6 * 8) = *(undefined8 *)(kpower + lVar8 * 8);
      DAT_00120740 = DAT_00120740 + -1;
      DAT_00120790 = DAT_00120790 + -1;
      if (DAT_00120714 != 0x44) {
        newcnd();
      }
      sortkl();
    }
    iVar3 = DAT_001210f4;
    iVar5 = DAT_001210f0;
    uVar2 = nulplanet._12_4_;
    uVar1 = nulplanet._8_4_;
    uVar9 = nulplanet._4_4_;
    if (DAT_0012078c < 1) {
      uVar9 = 0;
    }
    else {
      piVar4 = &DAT_00121120;
      iVar7 = 1;
      do {
        if (((*piVar4 == DAT_001210f0) && (piVar4[1] == DAT_001210f4)) && (piVar4[3] == 1)) {
          lVar8 = (long)iVar7 * 0x14;
          *(undefined4 *)(&DAT_0012110c + lVar8) = nulplanet._0_4_;
          *(undefined4 *)(lVar8 + 0x121110) = uVar9;
          *(undefined4 *)(&DAT_00121114 + lVar8) = uVar1;
          *(undefined4 *)(&DAT_00121118 + lVar8) = uVar2;
          *(undefined4 *)(&DAT_0012111c + lVar8) = nulplanet._16_4_;
          (&DAT_00120dcc)[(long)iVar3 + 0x78 + (long)iVar5 * 9] =
               (&DAT_00120dcc)[(long)iVar3 + 0x78 + (long)iVar5 * 9] + -1;
          if ((DAT_00120714 != 0x44) && (0.0 < DAT_00120228)) {
            return 0;
          }
          if (DAT_001207b4 == 0) {
            if (*param_4 == 0) {
              pause();
            }
            *param_4 = 1;
            prout("Lt. Uhura-  \"Captain, Starfleet Intelligence reports");
            proutn("   a planet in");
            cramlc(1,DAT_001210f0,DAT_001210f4);
            prout(" has been destroyed");
            prout("   by the Super-commander.\"");
            return 0;
          }
          return 0;
        }
        iVar7 = iVar7 + 1;
        piVar4 = piVar4 + 5;
      } while (iVar7 <= DAT_0012078c);
      uVar9 = 0;
    }
  }
  return uVar9;
}



void movcom(void)

{
  char cVar1;
  ulong uVar2;
  
  if (DAT_00120744 == 0) {
LAB_00112d60:
    if (DAT_00120794 == 0) {
LAB_00112dd7:
      if ((DAT_00120734 < 4) || (DAT_00120790 < 1)) goto LAB_00112dbd;
    }
    else {
      if (DAT_00120790 < 1) goto LAB_00112dbd;
LAB_00112d73:
      uVar2 = 1;
      do {
        if (quad[(long)*(int *)(ky + uVar2 * 4) + (long)*(int *)(kx + uVar2 * 4) * 0xb] == 'S') {
          movebaddy(*(int *)(kx + uVar2 * 4),*(int *)(ky + uVar2 * 4),uVar2 & 0xffffffff,0x53);
          goto LAB_00112dd7;
        }
        uVar2 = uVar2 + 1;
      } while ((int)uVar2 <= DAT_00120790);
      if (DAT_00120734 < 4) goto LAB_00112dbd;
    }
  }
  else {
    if (DAT_00120790 < 1) {
      if (DAT_00120794 != 0) goto LAB_00112dbd;
      goto LAB_00112dd7;
    }
    uVar2 = 1;
    do {
      if (quad[(long)*(int *)(ky + uVar2 * 4) + (long)*(int *)(kx + uVar2 * 4) * 0xb] == 'C') {
        movebaddy(*(int *)(kx + uVar2 * 4),*(int *)(ky + uVar2 * 4),uVar2 & 0xffffffff,0x43);
        goto LAB_00112d60;
      }
      uVar2 = uVar2 + 1;
    } while ((int)uVar2 <= DAT_00120790);
    if (DAT_00120794 != 0) goto LAB_00112d73;
    if (DAT_00120734 < 4) goto LAB_00112dbd;
  }
  uVar2 = 1;
  do {
    cVar1 = quad[(long)*(int *)(ky + uVar2 * 4) + (long)*(int *)(kx + uVar2 * 4) * 0xb];
    if ((cVar1 == 'K') || (cVar1 == 'R')) {
      movebaddy(*(int *)(kx + uVar2 * 4),*(int *)(ky + uVar2 * 4),uVar2 & 0xffffffff,(int)cVar1);
    }
    uVar2 = uVar2 + 1;
  } while ((int)uVar2 <= DAT_00120790);
LAB_00112dbd:
  sortkl();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void scom(int *param_1)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  double *pdVar5;
  long lVar6;
  int *piVar7;
  int iVar8;
  long lVar9;
  int iVar10;
  int iVar11;
  long in_FS_OFFSET;
  double dVar12;
  double dVar13;
  int local_9c;
  int local_98 [8];
  double local_78 [7];
  long local_40;
  
  iVar8 = DAT_001210f4;
  iVar4 = DAT_001210f0;
  iVar3 = DAT_00120720;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  bVar1 = true;
  if ((double)DAT_00120734 * 0.1 * ((double)DAT_00120734 + 1.0) <=
      (double)(DAT_00120dd8 + DAT_00120ddc) / ((DAT_001211f0 + 0.01) - DAT_00120830)) {
    bVar1 = DAT_001211f0 - DAT_00120830 < 3.0;
  }
  if ((_DAT_001207b0 == 0) && (bVar1 != false)) {
    iVar8 = DAT_001210f0 - DAT_00120720;
    iVar11 = DAT_001210f4 - DAT_00120724;
    dVar12 = (double)iVar8;
    dVar12 = dVar12 * dVar12 + (double)iVar11 * (double)iVar11;
    if (dVar12 < 0.0) {
      dVar12 = sqrt(dVar12);
    }
    else {
      dVar12 = SQRT(dVar12);
    }
    iVar10 = iVar11;
    if (2.0 < dVar12) {
      iVar10 = iVar3 - iVar4;
      iVar8 = iVar11;
    }
  }
  else {
    if (DAT_00120dcc < 1) {
      future._48_8_ = 0x46293e5939a08cea;
      goto LAB_00113087;
    }
    lVar9 = 1;
    do {
      local_98[lVar9] = (int)lVar9;
      iVar3 = (&DAT_00120f94)[lVar9];
      dVar12 = (double)square((double)((&DAT_00120f7c)[lVar9] - iVar4));
      dVar13 = (double)square((double)(iVar3 - iVar8));
      dVar13 = dVar13 + dVar12;
      if (dVar13 < 0.0) {
        dVar13 = sqrt(dVar13);
      }
      else {
        dVar13 = SQRT(dVar13);
      }
      local_78[lVar9] = dVar13;
      lVar9 = lVar9 + 1;
    } while ((int)lVar9 <= DAT_00120dcc);
    if (DAT_00120dcc < 2) {
      if (DAT_00120dcc != 1) goto LAB_00113087;
    }
    else {
      do {
        if (DAT_00120dcc < 3) break;
        piVar7 = local_98;
        bVar2 = false;
        pdVar5 = local_78;
        do {
          dVar12 = pdVar5[1];
          if (pdVar5[2] < dVar12) {
            iVar3 = piVar7[1];
            pdVar5[1] = pdVar5[2];
            pdVar5[2] = dVar12;
            piVar7[1] = piVar7[2];
            piVar7[2] = iVar3;
            bVar2 = true;
          }
          pdVar5 = pdVar5 + 1;
          piVar7 = piVar7 + 1;
        } while (pdVar5 != local_78 + (ulong)(DAT_00120dcc - 3) + 1);
      } while (bVar2);
    }
    lVar9 = 1;
    local_9c = 0;
    bVar2 = false;
    do {
      iVar3 = local_98[lVar9];
      iVar4 = (&DAT_00120f7c)[iVar3];
      iVar8 = (&DAT_00120f94)[iVar3];
      if ((((DAT_00120720 != iVar4) || (DAT_00120724 != iVar8)) &&
          ((DAT_001207d8 != iVar4 || (DAT_001207dc != iVar8)))) &&
         (*(int *)((long)&d + ((long)iVar8 + 8 + (long)iVar4 * 9) * 4) < 900)) {
        if (DAT_00120dc8 < 1) {
          iVar10 = 1;
        }
        else {
          lVar6 = 1;
          while (((iVar10 = (int)lVar6, *(int *)(&DAT_00120f24 + lVar6 * 4) != iVar4 ||
                  (*(int *)(&DAT_00120f50 + lVar6 * 4) != iVar8)) || (bVar2))) {
            lVar6 = lVar6 + 1;
            if (DAT_00120dc8 < (int)lVar6) goto LAB_001131c9;
          }
          bVar2 = true;
          local_9c = iVar3;
        }
        if (DAT_00120dc8 < iVar10) goto LAB_001131c9;
      }
      lVar9 = lVar9 + 1;
    } while ((int)lVar9 <= DAT_00120dcc);
    iVar3 = local_9c;
    if (!bVar2) goto LAB_00113087;
LAB_001131c9:
    iVar8 = (&DAT_00120f7c)[iVar3] - DAT_001210f0;
    iVar10 = (&DAT_00120f94)[iVar3] - DAT_001210f4;
  }
  iVar3 = -1;
  if (-1 < iVar8) {
    iVar3 = iVar8;
  }
  if (0 < iVar3) {
    iVar3 = 1;
  }
  iVar11 = iVar3 + DAT_001210f0;
  iVar3 = iVar3 + DAT_001210f4;
  iVar4 = checkdest(iVar11,iVar3,bVar1,param_1);
  if (iVar4 != 0) {
    if ((iVar8 == 0) || (iVar10 == 0)) {
      if (iVar8 == 0) {
        iVar4 = checkdest(DAT_001210f0 + 1,iVar3,bVar1,param_1);
        if (iVar4 != 0) {
          checkdest(DAT_001210f0 + -1,iVar3,bVar1,param_1);
        }
      }
      else {
        iVar3 = checkdest(iVar11,DAT_001210f4 + 1,bVar1,param_1);
        if (iVar3 != 0) {
          checkdest(iVar11,DAT_001210f4 + -1,bVar1,param_1);
        }
      }
    }
    else {
      iVar3 = checkdest(iVar11,DAT_001210f4,bVar1,param_1);
      if (iVar3 != 0) {
        if (iVar10 < 0) {
          iVar10 = -1;
        }
        if (0 < iVar10) {
          iVar10 = 1;
        }
        checkdest(DAT_001210f0,iVar10 + DAT_001210f4,bVar1,param_1);
      }
    }
  }
  if (DAT_00120dcc == 0) {
    future._48_8_ = 0x46293e5939a08cea;
  }
  else if (0 < DAT_00120dcc) {
    lVar9 = 1;
    do {
      if (((DAT_001210f0 == (&DAT_00120f7c)[lVar9]) && (DAT_001210f4 == (&DAT_00120f94)[lVar9])) &&
         ((DAT_001210f0 != DAT_001207d8 && (DAT_001210f4 != DAT_001207dc)))) {
        if (bVar1 == false) {
          _DAT_001207ec = 0;
          DAT_001207ac = 1;
          dVar12 = DAT_001211f0 + 1.0;
          dVar13 = (double)Rand();
          future._56_8_ = dVar13 + dVar13 + dVar12;
          if (DAT_001207d8 != 0) {
            future._56_8_ = ((double)future._40_8_ - DAT_001211f0) + (double)future._56_8_;
          }
          if (((DAT_00120714 == 0x44) || (DAT_00120228 <= 0.0)) && (DAT_001207b4 == 0)) {
            _DAT_001207ec = 1;
            if (*param_1 == 0) {
              pause();
            }
            *param_1 = 1;
            proutn("Lt. Uhura-  \"Captain, the starbase in");
            cramlc(1,DAT_001210f0,DAT_001210f4);
            skip(1);
            prout("   reports that it is under attack from the Klingon Super-commander.");
            proutn("   It can survive until stardate ");
            cramf(future._56_8_,0,1);
            prout(&DAT_0011ba36);
            if (DAT_00120888 != 0.0) {
              prout("Mr. Spock-  \"Captain, shall we cancel the rest period?\"");
              iVar3 = ja();
              if (iVar3 != 0) {
                DAT_00120888 = 0.0;
                DAT_00120878 = 0;
              }
            }
          }
        }
        goto LAB_00113087;
      }
      lVar9 = lVar9 + 1;
    } while ((int)lVar9 <= DAT_00120dcc);
  }
  dVar12 = (double)Rand();
  if ((((dVar12 <= 0.2) && ((DAT_00120714 == 0x44 || (DAT_00120228 <= 0.0)))) && (DAT_001207b4 == 0)
      ) && (*(int *)(starch + ((long)DAT_001210f0 * 9 + (long)DAT_001210f4) * 4) < 1)) {
    if (*param_1 == 0) {
      pause();
    }
    *param_1 = 1;
    prout("Lt. Uhura-  \"Captain, Starfleet Intelligence reports");
    proutn("   the Super-commander is in");
    cramlc(1,DAT_001210f0,DAT_001210f4);
    prout(&DAT_0011ba37);
  }
LAB_00113087:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void movetho(void)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  long lVar4;
  int iVar5;
  undefined1 *puVar6;
  char *pcVar7;
  bool bVar8;
  int iVar9;
  long in_FS_OFFSET;
  undefined auStack_28 [4];
  undefined local_24 [4];
  long local_20;
  
  iVar5 = DAT_001207e8;
  iVar2 = DAT_001207e4;
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  if ((_DAT_001207e0 == 0) || (DAT_00120760 == 1)) goto LAB_0011360b;
  if (DAT_001207e4 == 1) {
    if (DAT_001207e8 == 1) {
      iVar2 = 10;
LAB_0011385b:
      cVar1 = quad[(long)iVar2 + (long)DAT_001207e8 * 0xb];
      bVar8 = cVar1 != '.' && cVar1 != '#';
      if (cVar1 == '.' || cVar1 == '#') {
        quad[(long)DAT_001207e8 + (long)DAT_001207e4 * 0xb] = 0x23;
        iVar9 = (int)((double)((ulong)((double)iVar2 - (double)iVar5) & 0x7fffffffffffffff) /
                     ((double)iVar2 - (double)iVar5));
        lVar4 = (long)iVar5;
        do {
          puVar6 = quad + (long)(iVar5 + iVar9) + lVar4 * 0xb;
          do {
            if (iVar5 == iVar2) {
              if (bVar8) {
                DAT_001207e8 = iVar5;
              }
              goto LAB_00113736;
            }
            iVar5 = iVar5 + iVar9;
            puVar6 = puVar6 + iVar9;
            bVar8 = true;
          } while (puVar6[-(long)iVar9] != '.');
          quad[(long)iVar5 + lVar4 * 0xb] = 0x23;
          bVar8 = true;
        } while( true );
      }
      goto LAB_0011360b;
    }
    if (DAT_001207e8 == 10) {
LAB_00113650:
      cVar1 = quad[(long)DAT_001207e8 * 0xc];
      bVar8 = cVar1 != '.' && cVar1 != '#';
      if (cVar1 == '.' || cVar1 == '#') {
        quad[(long)DAT_001207e8 + (long)DAT_001207e4 * 0xb] = 0x23;
        iVar9 = (int)((double)((ulong)((double)iVar5 - (double)iVar2) & 0x7fffffffffffffff) /
                     ((double)iVar5 - (double)iVar2));
LAB_001136ec:
        puVar6 = quad + (long)(iVar2 + iVar9) * 0xb + (long)iVar5;
        while (iVar2 != iVar5) {
          iVar2 = iVar2 + iVar9;
          puVar6 = puVar6 + (long)iVar9 * 0xb;
          bVar8 = true;
          if (puVar6[(long)iVar9 * -0xb] == '.') goto code_r0x00113713;
        }
        if (bVar8) {
          DAT_001207e4 = iVar2;
        }
LAB_00113736:
        iVar5 = DAT_001207e8;
        iVar2 = DAT_001207e4;
        quad[(long)DAT_001207e8 + (long)DAT_001207e4 * 0xb] = 0x54;
        pcVar7 = quad + 0xc;
        pcVar3 = quad + 0xc;
        while (((((*pcVar7 == '#' || (*pcVar7 == 'T')) &&
                 ((pcVar7[99] == '#' || (pcVar7[99] == 'T')))) &&
                ((*pcVar3 == '#' || (*pcVar3 == 'T')))) &&
               ((pcVar3[9] == '#' || (pcVar3[9] == 'T'))))) {
          pcVar7 = pcVar7 + 1;
          pcVar3 = pcVar3 + 0xb;
          if (pcVar3 == &DAT_0012095a) {
            quad[(long)iVar5 + (long)iVar2 * 0xb] = 0x23;
            dropin(0x20,auStack_28,local_24);
            crmena(1,0x54,2,DAT_001207e4,DAT_001207e8);
            prout(" completes web.");
            DAT_001207e8 = 0;
            DAT_001207e4 = 0;
            _DAT_001207e0 = 0;
            break;
          }
        }
      }
      goto LAB_0011360b;
    }
  }
  else if (DAT_001207e4 == 10) {
    if (DAT_001207e8 == 10) {
      iVar2 = 1;
      goto LAB_0011385b;
    }
    if (DAT_001207e8 == 1) goto LAB_00113650;
  }
  _DAT_001207e0 = 0;
LAB_0011360b:
  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
code_r0x00113713:
  quad[(long)iVar5 + (long)iVar2 * 0xb] = 0x23;
  bVar8 = true;
  goto LAB_001136ec;
}



bool consumeTime(void)

{
  bool bVar1;
  
  DAT_00120754 = 1;
  events();
  bVar1 = true;
  if ((DAT_00120764 == 0) &&
     (bVar1 = true,
     *(int *)((long)&d + ((long)DAT_00120724 + 8 + (long)DAT_00120720 * 9) * 4) != 1000)) {
    bVar1 = DAT_00120760 != 0;
  }
  return bVar1;
}



void preport(void)

{
  bool bVar1;
  undefined4 *puVar2;
  int iVar3;
  
  skip(1);
  chew();
  prout("Spock-  \"Planet report follows, Captain.\"");
  skip(1);
  if (0 < DAT_0012078c) {
    puVar2 = &DAT_00121120;
    iVar3 = 1;
    bVar1 = false;
    do {
      if (puVar2[4] != 0) {
        cramlc(1,*puVar2,puVar2[1]);
        proutn("   class ");
        proutn((long)&classes + (long)(int)puVar2[2] * 2);
        proutn("   ");
        if (puVar2[3] == 0) {
          proutn(&DAT_0011cb45);
        }
        prout("dilithium crystals present.");
        bVar1 = true;
        if (puVar2[4] == 2) {
          prout("    Shuttle Craft Galileo on surface.");
          bVar1 = true;
        }
      }
      iVar3 = iVar3 + 1;
      puVar2 = puVar2 + 5;
    } while (iVar3 <= DAT_0012078c);
    if (bVar1) {
      return;
    }
  }
  prout("No information available.");
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void orbit(void)

{
  int iVar1;
  double dVar2;
  
  skip(1);
  chew();
  DAT_00120754 = 0;
  if (DAT_0012077c == 0) {
    if ((DAT_00120210 == 0.0) || (_DAT_00120218 == 0.0)) {
      if (DAT_00120774 != 0) {
        iVar1 = DAT_00120728 - DAT_00120774;
        if (iVar1 < 1) {
          iVar1 = -iVar1;
        }
        if (iVar1 < 2) {
          iVar1 = DAT_0012072c - DAT_00120778;
          if (iVar1 < 1) {
            iVar1 = -iVar1;
          }
          if (iVar1 < 2) {
            dVar2 = (double)Rand();
            DAT_00120878 = dVar2 * 0.03 + 0.02;
            prout("Helmsman Sulu-  \"Entering standard orbit, Sir.\"");
            newcnd();
            iVar1 = consumeTime();
            if (iVar1 != 0) {
              return;
            }
            proutn("Sulu-  \"Entered orbit at altitude ");
            dVar2 = (double)Rand();
            height = (int)(dVar2 * 7200.0 + 1400.0);
            cramf((double)height,0,2);
            prout(" kilometers.\"");
            DAT_0012077c = 1;
            return;
          }
        }
      }
      crmshp();
      prout(" not adjacent to planet.\n");
    }
    else {
      prout("Both warp and impulse engines damaged.");
    }
  }
  else {
    prout("Already in standard orbit.");
  }
  return;
}



void sensor(void)

{
  skip(1);
  chew();
  if (DAT_001201e8 == 0.0) {
    if (DAT_00120774 == 0) {
      prout("No planet in this quadrant.");
    }
    else {
      proutn("Spock-  \"Sensor scan for");
      cramlc(1,DAT_00120720,DAT_00120724);
      prout(&DAT_00117e3a);
      skip(1);
      proutn("         Planet at");
      cramlc(2,DAT_00120774,DAT_00120778);
      proutn(" is of class ");
      proutn((long)&classes + (long)*(int *)(&DAT_00121114 + (long)DAT_00120784 * 0x14) * 2);
      prout(".");
      if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 2) {
        prout("         Sensors show Galileo still on surface.");
      }
      proutn("         Readings indicate");
      if (*(int *)(&DAT_00121118 + (long)DAT_00120784 * 0x14) == 0) {
        proutn(&DAT_0011cc50);
      }
      prout(" dilithium crystals present.\"");
      if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 0) {
        *(undefined4 *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) = 1;
      }
    }
  }
  else {
    prout("Short range sensors damaged.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void mine(void)

{
  int iVar1;
  double dVar2;
  
  DAT_00120754 = 0;
  skip(1);
  chew();
  if (DAT_00120780 == 1) {
    if (*(int *)(&DAT_00121118 + (long)DAT_00120784 * 0x14) == 0) {
      prout("No dilithium crystals on this planet.");
    }
    else if (_DAT_00120788 == 1) {
      prout("You\'ve already mined enough crystals for this trip.");
    }
    else if ((_DAT_001207cc == 1) && (DAT_001208a0 == 0.05)) {
      proutn("With all those fresh crystals aboard the ");
      crmshp();
      skip(1);
      prout("there\'s no reason to mine more at this time.");
    }
    else {
      dVar2 = (double)Rand();
      DAT_00120878 = (double)*(int *)(&DAT_00121114 + (long)DAT_00120784 * 0x14) *
                     (dVar2 * 0.2 + 0.1);
      iVar1 = consumeTime();
      if (iVar1 == 0) {
        prout("Mining operation complete.");
        _DAT_00120788 = 1;
      }
    }
  }
  else {
    prout("Mining party not on planet.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void usecrystals(void)

{
  int iVar1;
  double dVar2;
  
  skip(1);
  chew();
  if (_DAT_001207cc == 1) {
    if (1000.0 <= DAT_00120838) {
      prout("Spock-  \"Captain, Starfleet Regulations prohibit such an operation");
      prout("  except when condition Yellow exists.");
    }
    else {
      prout("Spock- \"Captain, I must warn you that loading");
      prout("  raw dilithium crystals into the ship\'s power");
      prout("  system may risk a severe explosion.");
      proutn("  Are you sure this is wise?\" ");
      iVar1 = ja();
      if (iVar1 == 0) {
        chew();
      }
      else {
        skip(1);
        prout("Engineering Officer Scott-  \"(GULP) Aye Sir.");
        prout("  Mr. Spock and I will try it.\"");
        skip(1);
        prout("Spock-  \"Crystals in place, Sir.");
        prout("  Ready to activate circuit.\"");
        skip(1);
        prouts("Scotty-  \"Keep your fingers crossed, Sir!\"");
        skip(1);
        dVar2 = (double)Rand();
        if (dVar2 <= DAT_001208a0) {
          prouts("  \"Activating now! - - No good!  It\'s***");
          skip(2);
          prouts("***RED ALERT!  RED A*L********************************");
          skip(1);
          stars();
          prouts("******************   KA-BOOM!!!!   *******************");
          skip(1);
          kaboom();
        }
        else {
          dVar2 = (double)Rand();
          DAT_00120838 = (dVar2 * 0.9 + 1.0) * 5000.0 + DAT_00120838;
          prouts("  \"Activating now! - - ");
          prout("The instruments");
          prout("   are going crazy, but I think it\'s");
          prout("   going to work!!  Congratulations, Sir!\"");
          DAT_001208a0 = DAT_001208a0 + DAT_001208a0;
        }
      }
    }
  }
  else {
    prout("No dilithium crystals available.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void shuttle(void)

{
  int iVar1;
  
  chew();
  skip(1);
  DAT_00120754 = 0;
  if (DAT_00120230 == 0.0) {
    if (DAT_0012077c == 0) {
      crmshp();
      prout(" not in standard orbit.");
    }
    else {
      if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 2) {
        if (DAT_00120780 == -1) {
          prout("You will have to beam down to retrieve the shuttle craft.");
          return;
        }
      }
      else if (DAT_001207a8 != 1) {
        prout("Shuttle craft not currently available.");
        return;
      }
      if ((DAT_00120848 == 0.0) && (DAT_00120714 != 0x44)) {
        if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 0) {
          prout("Spock-  \"Captain, we have no information on this planet");
          prout("  and Starfleet Regulations clearly state that in this situation");
          prout("  you may not fly down.\"");
        }
        else {
          DAT_00120878 = (double)height * 3e-05;
          if (DAT_00121200 * 0.8 <= DAT_00120878) {
            prout("First Officer Spock-  \"Captain, I compute that such");
            prout("  a maneuver would require approximately ");
            cramf((DAT_00120878 * 100.0) / DAT_00121200,0,4);
            prout("% of our");
            prout("remaining time.");
            prout("Are you sure this is wise?\" ");
            iVar1 = ja();
            if (iVar1 == 0) {
              DAT_00120878 = 0.0;
              return;
            }
          }
          if (DAT_00120780 == 1) {
            if (DAT_001207a8 == 1) {
              if (_DAT_00120240 == 0.0) {
                proutn("Spock-  \"Would you rather use the transporter?\" ");
                iVar1 = ja();
                if (iVar1 != 0) {
                  beam();
                  return;
                }
                proutn("Shuttle crew");
              }
              else {
                proutn("Rescue party");
              }
              prout(" boards Galileo and swoops toward planet surface.");
              DAT_001207a8 = 0;
              skip(1);
              iVar1 = consumeTime();
              if (iVar1 == 0) {
                *(undefined4 *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) = 2;
                prout("Trip complete.");
              }
            }
            else {
              prout("You and your mining party board the");
              prout("shuttle craft for the trip back to the Enterprise.");
              skip(1);
              prout("The short hop begins . . .");
              *(undefined4 *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) = 1;
              _DAT_001207a0 = 1;
              skip(1);
              DAT_00120780 = -1;
              iVar1 = consumeTime();
              if (iVar1 == 0) {
                DAT_001207a8 = 1;
                _DAT_001207a0 = 0;
                if (_DAT_00120788 != 0) {
                  _DAT_001207cc = 1;
                  DAT_001208a0 = 0x3fa999999999999a;
                }
                _DAT_00120788 = 0;
                prout("Trip complete.");
              }
            }
          }
          else {
            prout("Mining party assembles in the hangar deck,");
            prout("ready to board the shuttle craft \"Galileo\".");
            skip(1);
            prouts("The hangar doors open; the trip begins.");
            skip(1);
            _DAT_001207a0 = 1;
            DAT_001207a8 = 0;
            iVar1 = consumeTime();
            if (iVar1 == 0) {
              *(undefined4 *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) = 2;
              DAT_00120780 = 1;
              _DAT_001207a0 = 0;
              prout("Trip complete");
            }
          }
        }
      }
      else {
        prout("Shuttle craft cannot pass through shields.");
      }
    }
  }
  else if (DAT_00120230 == -1.0) {
    if ((DAT_0012077c == 0) || (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) != 2)) {
      prout("Ye Faerie Queene had no shuttle craft.");
    }
    else {
      prout("Ye Faerie Queene has no shuttle craft bay to dock it at.");
    }
  }
  else if (DAT_00120230 <= 0.0) {
    prout("Shuttle craft is now serving Big Mac\'s.");
  }
  else {
    prout("The Galileo is damaged.");
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void beam(void)

{
  int iVar1;
  bool bVar2;
  double dVar3;
  
  chew();
  skip(1);
  if (_DAT_00120240 != 0.0) {
    prout("Transporter damaged.");
    if (DAT_00120230 != 0.0) {
      return;
    }
    if ((*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) != 2) && (DAT_001207a8 != 1)) {
      return;
    }
    skip(1);
    prout("Spock-  \"May I suggest the shuttle craft, Sir?\" ");
    iVar1 = ja();
    if (iVar1 != 0) {
      shuttle();
      return;
    }
    return;
  }
  if (DAT_0012077c == 0) {
    crmshp();
    prout(" not in standard orbit.");
    return;
  }
  if (DAT_00120848 == 0.0) {
    if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 0) {
      prout("Spock-  \"Captain, we have no information on this planet");
      prout("  and Starfleet Regulations clearly state that in this situation");
      prout("  you may not go down.\"");
      return;
    }
    if (DAT_00120780 == 1) {
      if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) == 2) {
        proutn("Spock-  \"Wouldn\'t you rather take the Galileo?\" ");
        iVar1 = ja();
        if (iVar1 != 0) {
          chew();
          return;
        }
        prout("Your crew hides the Galileo to prevent capture by aliens.");
      }
      prout("Landing party assembled, ready to beam up.");
      skip(1);
      prout("Kirk whips out communicator...");
      prouts("BEEP  BEEP  BEEP");
      skip(2);
      prout("\"Kirk to enterprise-  Lock on coordinates...energize.\"");
    }
    else {
      if (*(int *)(&DAT_00121118 + (long)DAT_00120784 * 0x14) == 0) {
        prout("Spock-  \"Captain, I fail to see the logic in");
        prout("  exploring a planet with no dilithium crystals.");
        proutn("  Are you sure this is wise?\" ");
        iVar1 = ja();
        if (iVar1 == 0) {
          chew();
          return;
        }
      }
      prout("Scotty-  \"Transporter room ready, Sir.\"");
      skip(1);
      prout("Kirk, and landing party prepare to beam down to planet surface.");
      skip(1);
      prout("Kirk-  \"Energize.\"");
    }
    skip(1);
    prouts("WWHOOOIIIIIRRRRREEEE.E.E.  .  .  .  .   .    .");
    skip(2);
    dVar3 = (double)Rand();
    if (dVar3 <= 0.98) {
      prouts(".    .   .  .  .  .  .E.E.EEEERRRRRIIIIIOOOHWW");
      skip(2);
      prout("Transport complete.");
      iVar1 = -DAT_00120780;
      bVar2 = DAT_00120780 == -1;
      DAT_00120780 = iVar1;
      if (bVar2) {
        if (*(int *)(&DAT_0012111c + (long)DAT_00120784 * 0x14) != 2) {
          _DAT_00120788 = 0;
          return;
        }
        prout("The shuttle craft Galileo is here!");
      }
      if ((DAT_00120780 != 1) && (_DAT_00120788 == 1)) {
        _DAT_001207cc = 1;
        DAT_001208a0 = 0x3fa999999999999a;
      }
      _DAT_00120788 = 0;
      return;
    }
    prouts("BOOOIIIOOOIIOOOOIIIOIING . . .");
    skip(2);
    prout("Scotty-  \"Oh my God!  I\'ve lost them.\"");
    finish(0xc);
    return;
  }
  prout("Impossible to transport through shields.");
  return;
}



void deathray(void)

{
  int iVar1;
  long lVar2;
  long lVar3;
  double dVar4;
  
  dVar4 = (double)Rand();
  DAT_00120754 = 0;
  skip(1);
  chew();
  if (DAT_0012071c == 0x45) {
    if (DAT_00120790 == 0) {
      prout("Sulu-  \"But Sir, there are no enemies in this quadrant.\"");
    }
    else if (0.0 < DAT_00120250) {
      prout("Death Ray is damaged.");
    }
    else {
      prout("Spock-  \"Captain, the \'Experimental Death Ray\'");
      prout("  is highly unpredictable.  Considering the alternatives,");
      prout("  are you sure this is wise?\" ");
      iVar1 = ja();
      if (iVar1 != 0) {
        prout("Spock-  \"Acknowledged.\"");
        skip(1);
        DAT_00120754 = 1;
        prouts("WHOOEE ... WHOOEE ... WHOOEE ... WHOOEE");
        skip(1);
        prout("Crew scrambles in emergency preparation.");
        prout("Spock and Scotty ready the death ray and");
        prout("prepare to channel all ship\'s power to the device.");
        skip(1);
        prout("Spock-  \"Preparations complete, sir.\"");
        prout("Kirk-  \"Engage!\"");
        skip(1);
        prouts("WHIRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR");
        skip(1);
        if (0.3 < dVar4) {
          prouts("Sulu- \"Captain!  It\'s working!\"");
          skip(2);
          while (0 < DAT_00120790) {
            deadkl(kx._4_4_,ky._4_4_,
                   (int)(char)quad[(long)(int)ky._4_4_ + (long)(int)kx._4_4_ * 0xb],kx._4_4_,
                   ky._4_4_);
          }
          prout("Ensign Chekov-  \"Congratulations, Captain!\"");
          if (d._4_4_ == 0) {
            finish(0);
          }
          prout("Spock-  \"Captain, I believe the `Experimental Death Ray\'");
          dVar4 = (double)Rand();
          if (0.05 < dVar4) {
            prout("   has been rendered dysfunctional.\"");
            DAT_00120250 = 39.95;
          }
          else {
            prout("   is still operational.\"");
          }
        }
        else {
          dVar4 = (double)Rand();
          if (dVar4 <= 0.3) {
            prouts("Sulu- \"Captain!  It\'s working!\"");
            skip(1);
            prouts("***RED ALERT!  RED ALERT!");
            skip(1);
            prout("***MATTER-ANTIMATTER IMPLOSION IMMINENT!");
            skip(1);
            prouts("***RED ALERT!  RED A*L********************************");
            skip(1);
            stars();
            prouts("******************   KA-BOOM!!!!   *******************");
            skip(1);
            kaboom();
          }
          else if (dVar4 <= 0.55) {
            prouts("Sulu- \"Captain!  Yagabandaghangrapl, brachriigringlanbla!\"");
            skip(1);
            prout("Lt. Uhura-  \"Graaeek!  Graaeek!\"");
            skip(1);
            prout("Spock-  \"Fascinating!  . . . All humans aboard");
            prout("  have apparently been transformed into strange mutations.");
            prout("  Vulcans do not seem to be affected.");
            skip(1);
            prout("Kirk-  \"Raauch!  Raauch!\"");
            finish(0x12);
          }
          else if (dVar4 <= 0.75) {
            prouts("Sulu- \"Captain!  It\'s   --WHAT?!?!\"");
            skip(2);
            proutn("Spock-  \"I believe the word is");
            prouts(" *ASTONISHING*");
            prout(" Mr. Sulu.");
            lVar3 = 0x1208f5;
            do {
              lVar2 = lVar3 + -10;
              do {
                if (*(char *)(lVar2 + 1) == '.') {
                  *(undefined *)(lVar2 + 1) = 0x3f;
                }
                lVar2 = lVar2 + 1;
              } while (lVar2 != lVar3);
              lVar3 = lVar3 + 0xb;
            } while (lVar3 != 0x120963);
            prout("  Captain, our quadrant is now infested with");
            prouts(" - - - - - -  *THINGS*.");
            skip(1);
            prout("  I have no logical explanation.\"");
          }
          else {
            prouts("Sulu- \"Captain!  The Death Ray is creating tribbles!\"");
            skip(1);
            prout("Scotty-  \"There are so many tribbles down here");
            prout("  in Engineering, we can\'t move for \'em, Captain.\"");
            finish(0x13);
          }
        }
      }
    }
  }
  else {
    prout("Ye Faerie Queene has no death ray.");
  }
  return;
}



void _fini(void)

{
  return;
}


